[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1111544608",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1111544608",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1111544608,
        "node_id": "IC_kwDOCVq1mM5CQNMg",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-04-27T22:33:20Z",
        "updated_at": "2022-04-27T22:39:18Z",
        "author_association": "MEMBER",
        "body": "The optimized model is tied with the execution providers because different providers might only support a subset of operators. It might encounter issue to use CUDA to optimize a model, then run the model in CPU.\r\n\r\nIf you run the optimized model with same execution providers (For example, optimize model in CUDA ep, and run the optimized model in CUDA ep again), there shall not be problem.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1111544608/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1112802286",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1112802286",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1112802286,
        "node_id": "IC_kwDOCVq1mM5CVAPu",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-04-29T01:32:39Z",
        "updated_at": "2022-04-29T01:32:39Z",
        "author_association": "MEMBER",
        "body": "Prima facie, it is a bug since when the graph optimization level is GraphOptimizationLevel.ORT_ENABLE_BASIC, the dumped graph shouldn't contain any operators that are not part of the ONNX standard and in this case the dumped graph leaks some ORT partitioning information in the form of the MemCpy nodes. The fix is to dump the graph after the basic optimization has finished and before the paritioning and copy node insertion steps. \r\n\r\nBut the impact of this should be low - as a work-around you can use just the CPU EP to dump the optimized graph and that won't leak ORT partitioning details (as you illustrated). The flip side is instantiating an InferenceSession using the CPU EP just for this. \r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1112802286/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1435412645",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1435412645",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1435412645,
        "node_id": "IC_kwDOCVq1mM5Vjqil",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-18T00:10:26Z",
        "updated_at": "2023-02-18T00:57:49Z",
        "author_association": "NONE",
        "body": "Any chance this bug can be addressed? I am now facing this again in exporting another model. The model is fp16 so I have to use `CUDAExecutionprovider` or it inserts lots of cast ops. But using `CUDAExecutionprovider` also inserts these `MemcpyToHost' ops that are problematic if I want to run the same model also on CPU.\r\n\r\nSo basically now I should avoid dumping the optimized model, and use the original exported model. This means I get lots of \"Removing initializer '5050'. It is not used by any node and should be removed from the model\" errors. \r\n\r\nAlso, using `CPUExecutionprovider` to export the optimzied version (depending on onnxruntime vs onnxruntime-gpu) has different resuls, the latter produces invalid graph.  I can send the unoptimzied model to you/anyone over Teams if you ping me\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1435412645/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444500472",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1444500472",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1444500472,
        "node_id": "IC_kwDOCVq1mM5WGVP4",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-24T21:12:38Z",
        "updated_at": "2023-02-24T21:15:33Z",
        "author_association": "MEMBER",
        "body": "CPU does not support fp16, so you see a lot of cast ops. \r\n\r\n@dashesy, Saving the optimized model from ONNX Runtime will not get better performance (since same optimizations will be done when ONNXRuntime loading the original model) except reducing model load time. What's the reason that you need the optimized version?\r\n\r\nIf you want to remove some unused initializers, it is easy to use onnx python API to do that.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444500472/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444508897",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1444508897",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1444508897,
        "node_id": "IC_kwDOCVq1mM5WGXTh",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-24T21:17:28Z",
        "updated_at": "2023-02-24T21:17:28Z",
        "author_association": "NONE",
        "body": "Yes the idea is to get rid of the warnings. The CPU does not support fp16, but adding those \"cast\" ops changes the model. \r\n\r\nThe Python API used to be broken (crashing). \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444508897/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444509537",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1444509537",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1444509537,
        "node_id": "IC_kwDOCVq1mM5WGXdh",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-24T21:17:52Z",
        "updated_at": "2023-02-24T21:17:52Z",
        "author_association": "MEMBER",
        "body": "See https://github.com/onnx/onnx/issues/3477",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444509537/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444512327",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1444512327",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1444512327,
        "node_id": "IC_kwDOCVq1mM5WGYJH",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-24T21:19:29Z",
        "updated_at": "2023-02-24T21:20:21Z",
        "author_association": "NONE",
        "body": "I see, thanks. Yes that could work but requires doing this manually for all of them. There are 100s of unused initializers in a big model.\r\n\r\nPlus, the optimized model is easier to look at in NetRon, and takes less disk space (smaller packages)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1444512327/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1516316519",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11348#issuecomment-1516316519",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11348",
        "id": 1516316519,
        "node_id": "IC_kwDOCVq1mM5aYSdn",
        "user": {
            "login": "jplu",
            "id": 959590,
            "node_id": "MDQ6VXNlcjk1OTU5MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/959590?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jplu",
            "html_url": "https://github.com/jplu",
            "followers_url": "https://api.github.com/users/jplu/followers",
            "following_url": "https://api.github.com/users/jplu/following{/other_user}",
            "gists_url": "https://api.github.com/users/jplu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jplu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jplu/subscriptions",
            "organizations_url": "https://api.github.com/users/jplu/orgs",
            "repos_url": "https://api.github.com/users/jplu/repos",
            "events_url": "https://api.github.com/users/jplu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jplu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-20T13:19:35Z",
        "updated_at": "2023-04-20T13:19:35Z",
        "author_association": "NONE",
        "body": "Any idea when this bug can be addressed? Thanks.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1516316519/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]