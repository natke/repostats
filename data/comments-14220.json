[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1386250977",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14220#issuecomment-1386250977",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14220",
        "id": 1386250977,
        "node_id": "IC_kwDOCVq1mM5SoILh",
        "user": {
            "login": "shalvamist",
            "id": 94086448,
            "node_id": "U_kgDOBZulMA",
            "avatar_url": "https://avatars.githubusercontent.com/u/94086448?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/shalvamist",
            "html_url": "https://github.com/shalvamist",
            "followers_url": "https://api.github.com/users/shalvamist/followers",
            "following_url": "https://api.github.com/users/shalvamist/following{/other_user}",
            "gists_url": "https://api.github.com/users/shalvamist/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/shalvamist/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/shalvamist/subscriptions",
            "organizations_url": "https://api.github.com/users/shalvamist/orgs",
            "repos_url": "https://api.github.com/users/shalvamist/repos",
            "events_url": "https://api.github.com/users/shalvamist/events{/privacy}",
            "received_events_url": "https://api.github.com/users/shalvamist/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-17T23:49:38Z",
        "updated_at": "2023-01-17T23:49:38Z",
        "author_association": "CONTRIBUTOR",
        "body": "Hi halfperim,\r\n\r\nThanks for the detailed report on the issue.\r\nI will look into it and update you with my findings. \r\n\r\none question that comes to mind regarding performance - \r\ndid you leverage multithreading on WASM? if not - all you need to do is update the variable - ort.wasm.numThreads. (i.e. ort.wasm.numThreads = 4;)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1386250977/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1404256826",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14220#issuecomment-1404256826",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14220",
        "id": 1404256826,
        "node_id": "IC_kwDOCVq1mM5Ts0I6",
        "user": {
            "login": "shalvamist",
            "id": 94086448,
            "node_id": "U_kgDOBZulMA",
            "avatar_url": "https://avatars.githubusercontent.com/u/94086448?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/shalvamist",
            "html_url": "https://github.com/shalvamist",
            "followers_url": "https://api.github.com/users/shalvamist/followers",
            "following_url": "https://api.github.com/users/shalvamist/following{/other_user}",
            "gists_url": "https://api.github.com/users/shalvamist/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/shalvamist/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/shalvamist/subscriptions",
            "organizations_url": "https://api.github.com/users/shalvamist/orgs",
            "repos_url": "https://api.github.com/users/shalvamist/repos",
            "events_url": "https://api.github.com/users/shalvamist/events{/privacy}",
            "received_events_url": "https://api.github.com/users/shalvamist/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-25T21:39:11Z",
        "updated_at": "2023-01-25T21:39:11Z",
        "author_association": "CONTRIBUTOR",
        "body": "Hi halfperim,\r\n\r\nQuick update on the issue. I confirmed the performance issue is reproducible on my side.\r\nIt looks like by adding more threads to the inference we can achieve better performance on WASM (right now default is to use only one thread). We are looking into possibly improve Conv operator on WASM or to enable users to run multi-threaded inference from the API.\r\n\r\nI will keep you posted.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1404256826/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1405731580",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14220#issuecomment-1405731580",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14220",
        "id": 1405731580,
        "node_id": "IC_kwDOCVq1mM5TycL8",
        "user": {
            "login": "halfperim",
            "id": 118577303,
            "node_id": "U_kgDOBxFYlw",
            "avatar_url": "https://avatars.githubusercontent.com/u/118577303?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/halfperim",
            "html_url": "https://github.com/halfperim",
            "followers_url": "https://api.github.com/users/halfperim/followers",
            "following_url": "https://api.github.com/users/halfperim/following{/other_user}",
            "gists_url": "https://api.github.com/users/halfperim/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/halfperim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/halfperim/subscriptions",
            "organizations_url": "https://api.github.com/users/halfperim/orgs",
            "repos_url": "https://api.github.com/users/halfperim/repos",
            "events_url": "https://api.github.com/users/halfperim/events{/privacy}",
            "received_events_url": "https://api.github.com/users/halfperim/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-26T22:04:53Z",
        "updated_at": "2023-01-26T22:04:53Z",
        "author_association": "NONE",
        "body": "Hi shalvamist,\r\n\r\nThank you for your investigation! I tried setting the num threads to 4 but didn't get a significant improvement. However everything runs much faster on the onnxruntime-node library that I can leverage for my Electron App.\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1405731580/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1411071297",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14220#issuecomment-1411071297",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14220",
        "id": 1411071297,
        "node_id": "IC_kwDOCVq1mM5UGz1B",
        "user": {
            "login": "guschmue",
            "id": 22941064,
            "node_id": "MDQ6VXNlcjIyOTQxMDY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/22941064?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/guschmue",
            "html_url": "https://github.com/guschmue",
            "followers_url": "https://api.github.com/users/guschmue/followers",
            "following_url": "https://api.github.com/users/guschmue/following{/other_user}",
            "gists_url": "https://api.github.com/users/guschmue/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/guschmue/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/guschmue/subscriptions",
            "organizations_url": "https://api.github.com/users/guschmue/orgs",
            "repos_url": "https://api.github.com/users/guschmue/repos",
            "events_url": "https://api.github.com/users/guschmue/events{/privacy}",
            "received_events_url": "https://api.github.com/users/guschmue/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-31T21:06:52Z",
        "updated_at": "2023-01-31T21:29:10Z",
        "author_association": "MEMBER",
        "body": "onnxruntime-web is using webassembly and for the most we see that it is 2-5 times slower than native x86 depending on the model. By default there is no multithreading in the browser because it requires SharedArrayBuffer which need to be enabled by one of 2 ways (ort.wasm.numThreads = 4 will not do something until SharedArrayBuffers are enabled):\r\n1. start the browser with --enable-features=SharedArrayBuffer (guess only devs would use this)\r\n2. from the server that hosts application and wasm, send cors headers. For example:\r\n     send_header(\"Cross-Origin-Opener-Policy\", \"same-origin\")\r\n     send_header(\"Cross-Origin-Embedder-Policy\", \"require-corp\")\r\n\r\nI see the following perf:\r\n![image](https://user-images.githubusercontent.com/22941064/215887458-6af2bdac-4677-4ef0-9a4a-56e415d93275.png)\r\n\r\nMost of the time is spend in conv.\r\nSome of the perf impact is because of webassembly (ie it supports only simd-128) and there is some room for optimizations in onnxruntime-web. Not a simple task and might take some time.\r\n\r\nIf you can use it, onnxruntime-node should be better choice since it runs native.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1411071297/reactions",
            "total_count": 3,
            "+1": 3,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]