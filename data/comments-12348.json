[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1199975706",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12348#issuecomment-1199975706",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12348",
        "id": 1199975706,
        "node_id": "IC_kwDOCVq1mM5Hhi0a",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-07-29T22:06:49Z",
        "updated_at": "2022-07-29T22:06:49Z",
        "author_association": "MEMBER",
        "body": "@riqiang-dp, could you share your onnx model so that we can take a look?  If you do not want to share weights, you can exclude them from onnx model in python like the following:\r\n```\r\nimport onnx\r\nmodel = onnx.load(\"input.onnx\")\r\nonnx.save_model(model, \"output.onnx\", save_as_external_data=True)\r\n```\r\nThe output.onnx will be very small to share.\r\n\r\nYou can also try our benchmark tool on bert-base-cased model:\r\nhttps://github.com/microsoft/onnxruntime/blob/master/onnxruntime/python/tools/transformers/run_benchmark.sh\r\nThe performance could be related to whether the onnx model is fully optimized or not etc, model size (like number of heads, hidden size), input size (batch size and sequence length) and cpu threads and the hardware itself.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1199975706/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1202915771",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12348#issuecomment-1202915771",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12348",
        "id": 1202915771,
        "node_id": "IC_kwDOCVq1mM5Hswm7",
        "user": {
            "login": "riqiang-dp",
            "id": 58701255,
            "node_id": "MDQ6VXNlcjU4NzAxMjU1",
            "avatar_url": "https://avatars.githubusercontent.com/u/58701255?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/riqiang-dp",
            "html_url": "https://github.com/riqiang-dp",
            "followers_url": "https://api.github.com/users/riqiang-dp/followers",
            "following_url": "https://api.github.com/users/riqiang-dp/following{/other_user}",
            "gists_url": "https://api.github.com/users/riqiang-dp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/riqiang-dp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/riqiang-dp/subscriptions",
            "organizations_url": "https://api.github.com/users/riqiang-dp/orgs",
            "repos_url": "https://api.github.com/users/riqiang-dp/repos",
            "events_url": "https://api.github.com/users/riqiang-dp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/riqiang-dp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-02T16:05:52Z",
        "updated_at": "2022-08-02T16:05:52Z",
        "author_association": "NONE",
        "body": "Thanks for the reply, I'll try exporting the model as well as the benchmark tool.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1202915771/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218385946",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12348#issuecomment-1218385946",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12348",
        "id": 1218385946,
        "node_id": "IC_kwDOCVq1mM5Inxga",
        "user": {
            "login": "riqiang-dp",
            "id": 58701255,
            "node_id": "MDQ6VXNlcjU4NzAxMjU1",
            "avatar_url": "https://avatars.githubusercontent.com/u/58701255?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/riqiang-dp",
            "html_url": "https://github.com/riqiang-dp",
            "followers_url": "https://api.github.com/users/riqiang-dp/followers",
            "following_url": "https://api.github.com/users/riqiang-dp/following{/other_user}",
            "gists_url": "https://api.github.com/users/riqiang-dp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/riqiang-dp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/riqiang-dp/subscriptions",
            "organizations_url": "https://api.github.com/users/riqiang-dp/orgs",
            "repos_url": "https://api.github.com/users/riqiang-dp/repos",
            "events_url": "https://api.github.com/users/riqiang-dp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/riqiang-dp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-17T19:02:48Z",
        "updated_at": "2022-08-17T19:02:48Z",
        "author_association": "NONE",
        "body": "Hi I've exported the encoder model without data: https://drive.google.com/file/d/1ybOsfFF7tx5yORAgj-SAP4c_DV6Cx0dr/view?usp=sharing\r\nAre you able to take a look?\r\n\r\nI'vee also tried the benchmarking tool on our VM:\r\n<img width=\"1294\" alt=\"image\" src=\"https://user-images.githubusercontent.com/58701255/185212382-6535f0a8-c69b-4cb4-b19f-d185d0a0c00c.png\">\r\nIt seems like there should at least be some improvement using onnxruntime with fp32, but for quantized int8 models torchscript and onnxruntime works similarly? However I was comparing onnxruntime to Pytorch ckpt files so there should still be an improvement?\r\n\r\nOtherwise I have tried the optimization script [here](https://github.com/microsoft/OLive/tree/master/cmd-example), and different runs gave different results. The conclusion I eventually just set num_threads to 1, no changes to other things.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218385946/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]