[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1622293635",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16006#issuecomment-1622293635",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16006",
        "id": 1622293635,
        "node_id": "IC_kwDOCVq1mM5gsjyD",
        "user": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-05T18:49:09Z",
        "updated_at": "2023-07-05T18:49:09Z",
        "author_association": "MEMBER",
        "body": "The error persists in 1.15.1: `onnxruntime.capi.onnxruntime_pybind11_state.Fail: [ONNXRuntimeError] : 1 : FAIL : Type Error: Type (seq(tensor(float16))) of output arg (output0) of node () does not match expected type (seq(tensor(float))).`",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1622293635/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1663300344",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16006#issuecomment-1663300344",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16006",
        "id": 1663300344,
        "node_id": "IC_kwDOCVq1mM5jI_L4",
        "user": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-03T05:12:14Z",
        "updated_at": "2023-08-03T05:12:14Z",
        "author_association": "MEMBER",
        "body": "\r\n### Summary\r\n\r\nORT raises `[ONNXRuntimeError] : 1 : FAIL : Type Error: Type (seq(tensor(float16))) of output arg (_val_1) of node (_0x79a4c20_n23) does not match expected type (seq(tensor(float))).` when executing test `ops_test.TestOutputConsistencyFullGraphCPU.test_output_match_opinfo__chunk_cpu_float16` in ONNX Script `TorchLib`.\r\n\r\nTo recreate this report, use\r\n\r\n```bash\r\nCREATE_REPRODUCTION_REPORT=1 python -m pytest onnxscript/tests/function_libs/torch_lib/ops_test.py -k test_output_match_opinfo__chunk_cpu_float16\r\n```\r\n\r\n### To reproduce\r\n\r\n```python\r\nimport onnx\r\nimport onnxruntime as ort\r\nimport numpy as np\r\nfrom numpy import array, float16, float32, float64, int32, int64\r\n\r\nonnx_model_text = \"\"\"\r\n<\r\n   ir_version: 8,\r\n   opset_import: [\"pkg.onnxscript.torch_lib\" : 1, \"\" : 18],\r\n   producer_name: \"pytorch\",\r\n   producer_version: \"2.1.0\"\r\n>\r\ntorch_jit (float16[5,5,5] input_0) => (seq(float16[5,unk__4,5]) _val_1) {\r\n   _val_1 = pkg.onnxscript.torch_lib.aten_chunk <chunks = 5, dim = 1> (input_0)\r\n}\r\n<\r\n  domain: \"pkg.onnxscript.torch_lib\",\r\n  opset_import: [\"\" : 18]\r\n>\r\naten_chunk <chunks>(self) => (return_val)\r\n{\r\n   neg_1 = Constant <value_ints = [-1]> ()\r\n   self_shape = Shape (self)\r\n   dim = Constant <value_int: int = @dim> ()\r\n   dim_size = Gather <axis = 0> (self_shape, dim)\r\n   chunks = Constant <value_int: int = @chunks> ()\r\n   chunks_cast = CastLike (chunks, dim_size)\r\n   num_per_chunk = Div (dim_size, chunks_cast)\r\n   chunks_0 = Constant <value_int: int = @chunks> ()\r\n   chunks_0_cast = CastLike (chunks_0, dim_size)\r\n   tmp = Mod (dim_size, chunks_0_cast)\r\n   int64_0 = Constant <value = int64 int64_0 {0}> ()\r\n   int64_0_cast = CastLike (int64_0, tmp)\r\n   tmp_1 = Greater (tmp, int64_0_cast)\r\n   tmp_2 = Cast <to = 7> (tmp_1)\r\n   num_per_chunk_3 = Add (tmp_2, num_per_chunk)\r\n   num_chunk = Div (dim_size, num_per_chunk_3)\r\n   tmp_4 = Reshape (num_chunk, neg_1)\r\n   list_split = Expand (num_per_chunk_3, tmp_4)\r\n   remainder = Mod (dim_size, num_per_chunk_3)\r\n   int64_0_5 = Constant <value = int64 int64_0_5 {0}> ()\r\n   int64_0_5_cast = CastLike (int64_0_5, remainder)\r\n   cond = Greater (remainder, int64_0_5_cast)\r\n   list_split_9 = If (cond) <then_branch = thenGraph_19 () => ( list_split_7) {\r\n      tmp_6 = Reshape (remainder, neg_1)\r\n      list_split_7 = Concat <axis = 0> (list_split, tmp_6)\r\n   }, else_branch = elseGraph_19 () => ( list_split_8) {\r\n      list_split_8 = Identity (list_split)\r\n   }>\r\n   return_val = SplitToSequence <axis: int = @dim> (self, list_split_9)\r\n}\r\n\"\"\"\r\n\r\nort_inputs = {'input_0': array([[[-2.047  ,  8.09   , -7.1    , -2.293  , -7.355  ],\r\n        [-5.668  , -4.676  ,  0.3516 ,  1.371  , -8.875  ],\r\n        [ 7.137  , -8.44   ,  7.523  ,  7.367  , -4.43   ],\r\n        [ 3.016  ,  1.125  ,  8.81   , -3.312  ,  4.14   ],\r\n        [ 0.545  ,  1.213  ,  4.375  , -3.797  , -5.562  ]],\r\n\r\n       [[ 5.92   , -5.33   , -6.47   , -5.68   ,  6.785  ],\r\n        [ 4.297  , -6.977  , -0.06152, -8.65   ,  0.2373 ],\r\n        [-7.82   , -7.242  ,  7.375  , -2.152  , -0.835  ],\r\n        [ 0.2812 ,  0.413  , -4.586  , -5.43   ,  5.035  ],\r\n        [ 6.39   , -1.934  , -8.14   , -2.996  ,  7.656  ]],\r\n\r\n       [[-2.629  ,  8.664  ,  4.797  , -0.5625 ,  6.484  ],\r\n        [-3.621  ,  8.28   ,  4.05   , -3.357  ,  6.75   ],\r\n        [ 0.03516,  1.907  , -4.586  , -2.268  , -5.51   ],\r\n        [-1.354  , -2.021  , -5.555  , -7.188  ,  0.12305],\r\n        [ 7.53   ,  4.86   , -1.169  ,  4.043  ,  6.062  ]],\r\n\r\n       [[ 5.047  , -1.415  , -2.479  ,  2.11   , -4.05   ],\r\n        [-0.03516, -8.164  ,  7.902  ,  6.44   , -4.746  ],\r\n        [ 3.568  , -6.977  , -2.426  ,  5.75   ,  1.494  ],\r\n        [-4.254  ,  0.3076 , -4.395  ,  1.397  ,  7.367  ],\r\n        [ 6.133  ,  2.127  ,  0.747  ,  6.99   , -3.93   ]],\r\n\r\n       [[-3.016  , -4.113  ,  5.035  ,  8.37   , -0.10547],\r\n        [-3.332  , -2.012  ,  0.2373 ,  5.44   ,  4.88   ],\r\n        [ 2.98   ,  7.004  ,  8.414  ,  2.9    ,  5.617  ],\r\n        [ 4.438  ,  8.914  ,  3.05   ,  4.15   ,  2.021  ],\r\n        [-7.34   ,  1.969  ,  3.375  ,  3.305  ,  2.479  ]]],\r\n      dtype=float16)}\r\n\r\nsession_options = ort.SessionOptions()\r\nsession_options.graph_optimization_level = (\r\n    ort.GraphOptimizationLevel.ORT_DISABLE_ALL\r\n)\r\nonnx_model = onnx.parser.parse_model(onnx_model_text)\r\n\r\nsession = ort.InferenceSession(\r\n    onnx_model.SerializeToString(), session_options, providers=(\"CPUExecutionProvider\",)\r\n)\r\nort_outputs = session.run(None, ort_inputs)\r\n\r\n```\r\n\r\n### Full error stack\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/justinchu/dev/onnx-script/onnxscript/tests/function_libs/torch_lib/ops_test_common.py\", line 533, in _capture_graph_and_evaluate_torch_script_evaluator\r\n    return _safe_ort_session_run(onnx_model.SerializeToString(), ort_inputs)\r\n  File \"/home/justinchu/dev/onnx-script/onnxscript/tests/function_libs/torch_lib/ops_test_common.py\", line 349, in _safe_ort_session_run\r\n    raise return_dict[\"error\"]\r\nonnxruntime.capi.onnxruntime_pybind11_state.Fail: [ONNXRuntimeError] : 1 : FAIL : Type Error: Type (seq(tensor(float16))) of output arg (_val_1) of node (_0x79a4c20_n23) does not match expected type (seq(tensor(float))).\r\n\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1663300344/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]