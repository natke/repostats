[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248418969",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12977#issuecomment-1248418969",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12977",
        "id": 1248418969,
        "node_id": "IC_kwDOCVq1mM5KaVyZ",
        "user": {
            "login": "wangyems",
            "id": 52801275,
            "node_id": "MDQ6VXNlcjUyODAxMjc1",
            "avatar_url": "https://avatars.githubusercontent.com/u/52801275?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wangyems",
            "html_url": "https://github.com/wangyems",
            "followers_url": "https://api.github.com/users/wangyems/followers",
            "following_url": "https://api.github.com/users/wangyems/following{/other_user}",
            "gists_url": "https://api.github.com/users/wangyems/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wangyems/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wangyems/subscriptions",
            "organizations_url": "https://api.github.com/users/wangyems/orgs",
            "repos_url": "https://api.github.com/users/wangyems/repos",
            "events_url": "https://api.github.com/users/wangyems/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wangyems/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T17:50:36Z",
        "updated_at": "2022-09-15T17:50:36Z",
        "author_association": "MEMBER",
        "body": "In ORT some ops like \"shape\" will be placed in CPU even if the model is running with CUDA EP.\r\nSince it's a standard huggingface bert model, you may want to try transformers optimizer benchmark (https://github.com/microsoft/onnxruntime/blob/main/onnxruntime/python/tools/transformers/README.md#benchmark) to get an optimized huggingface bert model where the graph is simplified and there should be no op placed on CPU during runtime.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248418969/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1254264047",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12977#issuecomment-1254264047",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12977",
        "id": 1254264047,
        "node_id": "IC_kwDOCVq1mM5Kwozv",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-21T21:51:12Z",
        "updated_at": "2022-09-21T21:54:43Z",
        "author_association": "MEMBER",
        "body": "The error message is related to `{'enable_cuda_graph': True}`. It is an advanced feature and it cannot be applied to every model due to limitations: https://natke.github.io/onnxruntime/docs/performance/tune-performance.html#using-cuda-graphs-in-the-cuda-ep\r\n\r\nTry remove it or update the line like the following:\r\n`\r\nsession = InferenceSession(path, options, providers=[(\"CUDAExecutionProvider\", 'CPUExecutionProvider'])\r\n`",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1254264047/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1254538364",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12977#issuecomment-1254538364",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12977",
        "id": 1254538364,
        "node_id": "IC_kwDOCVq1mM5Kxrx8",
        "user": {
            "login": "pommedeterresautee",
            "id": 1029874,
            "node_id": "MDQ6VXNlcjEwMjk4NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1029874?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pommedeterresautee",
            "html_url": "https://github.com/pommedeterresautee",
            "followers_url": "https://api.github.com/users/pommedeterresautee/followers",
            "following_url": "https://api.github.com/users/pommedeterresautee/following{/other_user}",
            "gists_url": "https://api.github.com/users/pommedeterresautee/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pommedeterresautee/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pommedeterresautee/subscriptions",
            "organizations_url": "https://api.github.com/users/pommedeterresautee/orgs",
            "repos_url": "https://api.github.com/users/pommedeterresautee/repos",
            "events_url": "https://api.github.com/users/pommedeterresautee/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pommedeterresautee/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-22T05:13:50Z",
        "updated_at": "2022-09-22T05:13:50Z",
        "author_association": "NONE",
        "body": "I understand that it s because of cuda graphs and inference works without enabling it. I wanted to test with cuda graphs, even tried optimized model but got no luck, always have this issue. What I don’t understand is that I forbid the fallback on cpu…",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1254538364/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1258406358",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12977#issuecomment-1258406358",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12977",
        "id": 1258406358,
        "node_id": "IC_kwDOCVq1mM5LAcHW",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-26T17:55:11Z",
        "updated_at": "2022-09-26T17:55:11Z",
        "author_association": "MEMBER",
        "body": "Hi @pommedeterresautee,\r\n\r\nEven though you choose the CUDA EP, the core runtime force place some shape massaging nodes onto CPU becauase it is counter-productive to hardware accelerate these ops and when CUDA EP sees that some nodes have been placed on CPU, it flags it and the load fails. Even if we did force these shape massaging nodes onto CUDA, it is of no use as that will introduce copy nodes to take the shape information from host to device (the shape of a tensor is stored on CPU) and this again means we cannot use CUDA Graphs as the copy operation cannot be stream captured.\r\n\r\nAs you can see, CUDA Graphs only works for very specific kinds of models and at this point, the coverage of models for CUDA Graphs is quite low because of this. \r\n\r\nCC: @feihugis ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1258406358/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1260065933",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12977#issuecomment-1260065933",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12977",
        "id": 1260065933,
        "node_id": "IC_kwDOCVq1mM5LGxSN",
        "user": {
            "login": "pommedeterresautee",
            "id": 1029874,
            "node_id": "MDQ6VXNlcjEwMjk4NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1029874?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pommedeterresautee",
            "html_url": "https://github.com/pommedeterresautee",
            "followers_url": "https://api.github.com/users/pommedeterresautee/followers",
            "following_url": "https://api.github.com/users/pommedeterresautee/following{/other_user}",
            "gists_url": "https://api.github.com/users/pommedeterresautee/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pommedeterresautee/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pommedeterresautee/subscriptions",
            "organizations_url": "https://api.github.com/users/pommedeterresautee/orgs",
            "repos_url": "https://api.github.com/users/pommedeterresautee/repos",
            "events_url": "https://api.github.com/users/pommedeterresautee/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pommedeterresautee/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-27T21:19:31Z",
        "updated_at": "2022-09-27T21:19:31Z",
        "author_association": "NONE",
        "body": "Thank you @hariharans29 for your answer its very clear!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1260065933/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]