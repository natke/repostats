[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1622396372",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1622396372",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1622396372,
        "node_id": "IC_kwDOCVq1mM5gs83U",
        "user": {
            "login": "chilo-ms",
            "id": 54722500,
            "node_id": "MDQ6VXNlcjU0NzIyNTAw",
            "avatar_url": "https://avatars.githubusercontent.com/u/54722500?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chilo-ms",
            "html_url": "https://github.com/chilo-ms",
            "followers_url": "https://api.github.com/users/chilo-ms/followers",
            "following_url": "https://api.github.com/users/chilo-ms/following{/other_user}",
            "gists_url": "https://api.github.com/users/chilo-ms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chilo-ms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chilo-ms/subscriptions",
            "organizations_url": "https://api.github.com/users/chilo-ms/orgs",
            "repos_url": "https://api.github.com/users/chilo-ms/repos",
            "events_url": "https://api.github.com/users/chilo-ms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chilo-ms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-05T19:48:11Z",
        "updated_at": "2023-07-05T19:51:45Z",
        "author_association": "MEMBER",
        "body": "Thanks for raising this issue, will investigate.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1622396372/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1659030499",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1659030499",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1659030499,
        "node_id": "IC_kwDOCVq1mM5i4svj",
        "user": {
            "login": "chilo-ms",
            "id": 54722500,
            "node_id": "MDQ6VXNlcjU0NzIyNTAw",
            "avatar_url": "https://avatars.githubusercontent.com/u/54722500?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chilo-ms",
            "html_url": "https://github.com/chilo-ms",
            "followers_url": "https://api.github.com/users/chilo-ms/followers",
            "following_url": "https://api.github.com/users/chilo-ms/following{/other_user}",
            "gists_url": "https://api.github.com/users/chilo-ms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chilo-ms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chilo-ms/subscriptions",
            "organizations_url": "https://api.github.com/users/chilo-ms/orgs",
            "repos_url": "https://api.github.com/users/chilo-ms/repos",
            "events_url": "https://api.github.com/users/chilo-ms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chilo-ms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-31T19:46:34Z",
        "updated_at": "2023-07-31T19:47:44Z",
        "author_association": "MEMBER",
        "body": "@laggui\r\nFor the last test, the optional input for the main graph is `x1.opt` but the real use for this optional input is in the `add-x1-x2-subgraph` where the \"add\" node consumes `x1` input. The \"OptionalGetElement\" inside this subgraph is not supported by TRT, so the subgraph will be partitioned into TRT/CPU subgraphs, and one of the inputs of this TRT subgraph is `x1`.\r\nSimply replace the `x1.opt` with `x1` for the provider option should work. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1659030499/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660249227",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1660249227",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1660249227,
        "node_id": "IC_kwDOCVq1mM5i9WSL",
        "user": {
            "login": "laggui",
            "id": 7225623,
            "node_id": "MDQ6VXNlcjcyMjU2MjM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7225623?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laggui",
            "html_url": "https://github.com/laggui",
            "followers_url": "https://api.github.com/users/laggui/followers",
            "following_url": "https://api.github.com/users/laggui/following{/other_user}",
            "gists_url": "https://api.github.com/users/laggui/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/laggui/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/laggui/subscriptions",
            "organizations_url": "https://api.github.com/users/laggui/orgs",
            "repos_url": "https://api.github.com/users/laggui/repos",
            "events_url": "https://api.github.com/users/laggui/events{/privacy}",
            "received_events_url": "https://api.github.com/users/laggui/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-01T12:50:28Z",
        "updated_at": "2023-08-01T12:53:14Z",
        "author_association": "NONE",
        "body": "@chilo-ms just to make sure, are you suggesting that I remove the optional input for it to work? I know it works without the optional input, but in the actual model (not this MWE), the input really is optional and separate graphs are executed based on the availability of the input. Also, the model works when no profile is specified.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660249227/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660719659",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1660719659",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1660719659,
        "node_id": "IC_kwDOCVq1mM5i_JIr",
        "user": {
            "login": "chilo-ms",
            "id": 54722500,
            "node_id": "MDQ6VXNlcjU0NzIyNTAw",
            "avatar_url": "https://avatars.githubusercontent.com/u/54722500?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chilo-ms",
            "html_url": "https://github.com/chilo-ms",
            "followers_url": "https://api.github.com/users/chilo-ms/followers",
            "following_url": "https://api.github.com/users/chilo-ms/following{/other_user}",
            "gists_url": "https://api.github.com/users/chilo-ms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chilo-ms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chilo-ms/subscriptions",
            "organizations_url": "https://api.github.com/users/chilo-ms/orgs",
            "repos_url": "https://api.github.com/users/chilo-ms/repos",
            "events_url": "https://api.github.com/users/chilo-ms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chilo-ms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-01T16:44:44Z",
        "updated_at": "2023-08-01T17:07:35Z",
        "author_association": "MEMBER",
        "body": "@laggui\r\nFor the last test case, no need to remove the optional input but just to change provider option as below:\r\n\r\n            \"TensorrtExecutionProvider\",\r\n            {\r\n                \"trt_profile_min_shapes\": \"x1:1x1\",\r\n                \"trt_profile_max_shapes\": \"x1:1x10\",\r\n                \"trt_profile_opt_shapes\": \"x1:1x2\",\r\n            },\r\n            \r\n In your original code, the {input_name} is \"x1.opt\". However, due to \"OptionalGetElement\" and \"OptionalHasElement\" node are not supported by TRT, the main graph will be partitioned into TRT EP subgraphs as well as CPU EP subgraphs. So, The real input for TRT EP subgraph is \"x1\" and that's why we provide those profile shapes for it.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660719659/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660789900",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1660789900",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1660789900,
        "node_id": "IC_kwDOCVq1mM5i_aSM",
        "user": {
            "login": "laggui",
            "id": 7225623,
            "node_id": "MDQ6VXNlcjcyMjU2MjM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7225623?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laggui",
            "html_url": "https://github.com/laggui",
            "followers_url": "https://api.github.com/users/laggui/followers",
            "following_url": "https://api.github.com/users/laggui/following{/other_user}",
            "gists_url": "https://api.github.com/users/laggui/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/laggui/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/laggui/subscriptions",
            "organizations_url": "https://api.github.com/users/laggui/orgs",
            "repos_url": "https://api.github.com/users/laggui/repos",
            "events_url": "https://api.github.com/users/laggui/events{/privacy}",
            "received_events_url": "https://api.github.com/users/laggui/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-01T17:32:09Z",
        "updated_at": "2023-08-01T17:34:52Z",
        "author_association": "NONE",
        "body": "@chilo-ms Ahhh yes ok that makes a lot of sense actually. Because the shapes provided in the profile are usually for the main graph input, I was confused and provided values for the optional.\r\n\r\nBut in reality it's not even executed with the TensorRT graph, and the node is dispatched to CPU. So the shapes provided should be for subgraph's input (i.e., the output of `OptionalGetElement` which is `x1`).\r\n\r\nThat's an user error than, my apologies.  I also just tested with your suggestion and it works as expected.\r\n\r\nFeel free to close!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660789900/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660802709",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16600#issuecomment-1660802709",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16600",
        "id": 1660802709,
        "node_id": "IC_kwDOCVq1mM5i_daV",
        "user": {
            "login": "chilo-ms",
            "id": 54722500,
            "node_id": "MDQ6VXNlcjU0NzIyNTAw",
            "avatar_url": "https://avatars.githubusercontent.com/u/54722500?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chilo-ms",
            "html_url": "https://github.com/chilo-ms",
            "followers_url": "https://api.github.com/users/chilo-ms/followers",
            "following_url": "https://api.github.com/users/chilo-ms/following{/other_user}",
            "gists_url": "https://api.github.com/users/chilo-ms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chilo-ms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chilo-ms/subscriptions",
            "organizations_url": "https://api.github.com/users/chilo-ms/orgs",
            "repos_url": "https://api.github.com/users/chilo-ms/repos",
            "events_url": "https://api.github.com/users/chilo-ms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chilo-ms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-01T17:42:01Z",
        "updated_at": "2023-08-01T17:42:01Z",
        "author_association": "MEMBER",
        "body": "Yes, your understanding is right and thank for confirming.\r\nFor TRT EP, we can still think of a better way to handle the case of partitioning when providing profile shapes, that's our work! ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1660802709/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]