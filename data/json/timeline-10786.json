[
    {
        "id": 6197516221,
        "node_id": "LE_lADOCVq1mM5FLCi1zwAAAAFxZpe9",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/6197516221",
        "actor": {
            "login": "harshithapv",
            "id": 54084812,
            "node_id": "MDQ6VXNlcjU0MDg0ODEy",
            "avatar_url": "https://avatars.githubusercontent.com/u/54084812?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/harshithapv",
            "html_url": "https://github.com/harshithapv",
            "followers_url": "https://api.github.com/users/harshithapv/followers",
            "following_url": "https://api.github.com/users/harshithapv/following{/other_user}",
            "gists_url": "https://api.github.com/users/harshithapv/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/harshithapv/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/harshithapv/subscriptions",
            "organizations_url": "https://api.github.com/users/harshithapv/orgs",
            "repos_url": "https://api.github.com/users/harshithapv/repos",
            "events_url": "https://api.github.com/users/harshithapv/events{/privacy}",
            "received_events_url": "https://api.github.com/users/harshithapv/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-03-07T19:42:46Z",
        "label": {
            "name": "component:coreruntime",
            "color": "303a93"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1064272088",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10786#issuecomment-1064272088",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10786",
        "id": 1064272088,
        "node_id": "IC_kwDOCVq1mM4_b4DY",
        "user": {
            "login": "yufenglee",
            "id": 30486710,
            "node_id": "MDQ6VXNlcjMwNDg2NzEw",
            "avatar_url": "https://avatars.githubusercontent.com/u/30486710?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yufenglee",
            "html_url": "https://github.com/yufenglee",
            "followers_url": "https://api.github.com/users/yufenglee/followers",
            "following_url": "https://api.github.com/users/yufenglee/following{/other_user}",
            "gists_url": "https://api.github.com/users/yufenglee/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/yufenglee/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/yufenglee/subscriptions",
            "organizations_url": "https://api.github.com/users/yufenglee/orgs",
            "repos_url": "https://api.github.com/users/yufenglee/repos",
            "events_url": "https://api.github.com/users/yufenglee/events{/privacy}",
            "received_events_url": "https://api.github.com/users/yufenglee/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-10T16:43:32Z",
        "updated_at": "2022-03-10T16:43:32Z",
        "author_association": "MEMBER",
        "body": "OnnxRuntime InferenceSession creates a threadpool with N/2 threads where N is the # of logic core by default. Python multiprocessing.Pool spawns multiple processes. Multiple processes mean multiple sessions and multiple threadpool. Too many threadpools will comp hurt performance. \r\nIn almost all scenarios you need only one process and multiple threads to parallelize inferences. The Run() function is designed to be run concurrently from multiple threads. So the workflow would look like - create one session and then call Run using this session from multiple threads.\r\n\r\nIf you really want to try tuning throughput with multiple processes, you can limit the number of # of threads with setting of intra_op_num_threads, for example, setting intra_op_num_threads = 1 and start N processes. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1064272088/reactions",
            "total_count": 6,
            "+1": 6,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "yufenglee",
            "id": 30486710,
            "node_id": "MDQ6VXNlcjMwNDg2NzEw",
            "avatar_url": "https://avatars.githubusercontent.com/u/30486710?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yufenglee",
            "html_url": "https://github.com/yufenglee",
            "followers_url": "https://api.github.com/users/yufenglee/followers",
            "following_url": "https://api.github.com/users/yufenglee/following{/other_user}",
            "gists_url": "https://api.github.com/users/yufenglee/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/yufenglee/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/yufenglee/subscriptions",
            "organizations_url": "https://api.github.com/users/yufenglee/orgs",
            "repos_url": "https://api.github.com/users/yufenglee/repos",
            "events_url": "https://api.github.com/users/yufenglee/events{/privacy}",
            "received_events_url": "https://api.github.com/users/yufenglee/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1203718665",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10786#issuecomment-1203718665",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10786",
        "id": 1203718665,
        "node_id": "IC_kwDOCVq1mM5Hv0oJ",
        "user": {
            "login": "Dian-Yi",
            "id": 44020057,
            "node_id": "MDQ6VXNlcjQ0MDIwMDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/44020057?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dian-Yi",
            "html_url": "https://github.com/Dian-Yi",
            "followers_url": "https://api.github.com/users/Dian-Yi/followers",
            "following_url": "https://api.github.com/users/Dian-Yi/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dian-Yi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dian-Yi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dian-Yi/subscriptions",
            "organizations_url": "https://api.github.com/users/Dian-Yi/orgs",
            "repos_url": "https://api.github.com/users/Dian-Yi/repos",
            "events_url": "https://api.github.com/users/Dian-Yi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dian-Yi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-03T09:38:29Z",
        "updated_at": "2022-08-03T09:38:29Z",
        "author_association": "NONE",
        "body": "> OnnxRuntime InferenceSession creates a threadpool with N/2 threads where N is the # of logic core by default. Python multiprocessing.Pool spawns multiple processes. Multiple processes mean multiple sessions and multiple threadpool. Too many threadpools will comp hurt performance. In almost all scenarios you need only one process and multiple threads to parallelize inferences. The Run() function is designed to be run concurrently from multiple threads. So the workflow would look like - create one session and then call Run using this session from multiple threads.\r\n> \r\n> If you really want to try tuning throughput with multiple processes, you can limit the number of # of threads with setting of intra_op_num_threads, for example, setting intra_op_num_threads = 1 and start N processes.\r\n\r\nI set intra_op_num_threads using this code but not working:\r\n```\r\n    sess_options = onnxruntime.SessionOptions()\r\n    sess_options.intra_op_num_threads = 1\r\n```\r\n\r\nI am very confused about  mutilthread and multiprocess inference time. In my test code, the mutilprocess inference time is around 3x slower than the multithread when predicting one image. Because of python GIL problems, the mutilprocess inference time is faster than multithread inference time Theoretically. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1203718665/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "Dian-Yi",
            "id": 44020057,
            "node_id": "MDQ6VXNlcjQ0MDIwMDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/44020057?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dian-Yi",
            "html_url": "https://github.com/Dian-Yi",
            "followers_url": "https://api.github.com/users/Dian-Yi/followers",
            "following_url": "https://api.github.com/users/Dian-Yi/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dian-Yi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dian-Yi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dian-Yi/subscriptions",
            "organizations_url": "https://api.github.com/users/Dian-Yi/orgs",
            "repos_url": "https://api.github.com/users/Dian-Yi/repos",
            "events_url": "https://api.github.com/users/Dian-Yi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dian-Yi/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1204722501",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10786#issuecomment-1204722501",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10786",
        "id": 1204722501,
        "node_id": "IC_kwDOCVq1mM5HzptF",
        "user": {
            "login": "Dian-Yi",
            "id": 44020057,
            "node_id": "MDQ6VXNlcjQ0MDIwMDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/44020057?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dian-Yi",
            "html_url": "https://github.com/Dian-Yi",
            "followers_url": "https://api.github.com/users/Dian-Yi/followers",
            "following_url": "https://api.github.com/users/Dian-Yi/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dian-Yi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dian-Yi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dian-Yi/subscriptions",
            "organizations_url": "https://api.github.com/users/Dian-Yi/orgs",
            "repos_url": "https://api.github.com/users/Dian-Yi/repos",
            "events_url": "https://api.github.com/users/Dian-Yi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dian-Yi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T03:46:06Z",
        "updated_at": "2022-08-04T05:36:17Z",
        "author_association": "NONE",
        "body": "I do some  following tests.\r\nfirst, using the same number processing and threading \r\n1.  Initializing onnxruntime mode using `onnxruntime.InferenceSession` in every process, one image inference cost time is slower around 3x than multithread. For example, using processing cost 1.2s,  using threading cost 0.4s.\r\n2. Initializing onnxruntime mode, and shareing class to every process, one image inference cost time is slower 1.3x than multithread. For example, using processing cost 0.52s,  using threading cost 0.4s.\r\n\r\nSo. i get the following guesses:\r\nonnxruntime has fully utilized  cpu resources, using multi onnxruntime model can only be slower in mutilprocessing.\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1204722501/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "Dian-Yi",
            "id": 44020057,
            "node_id": "MDQ6VXNlcjQ0MDIwMDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/44020057?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dian-Yi",
            "html_url": "https://github.com/Dian-Yi",
            "followers_url": "https://api.github.com/users/Dian-Yi/followers",
            "following_url": "https://api.github.com/users/Dian-Yi/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dian-Yi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dian-Yi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dian-Yi/subscriptions",
            "organizations_url": "https://api.github.com/users/Dian-Yi/orgs",
            "repos_url": "https://api.github.com/users/Dian-Yi/repos",
            "events_url": "https://api.github.com/users/Dian-Yi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dian-Yi/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1237005496",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10786#issuecomment-1237005496",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10786",
        "id": 1237005496,
        "node_id": "IC_kwDOCVq1mM5JuzS4",
        "user": {
            "login": "rajumgokak",
            "id": 108672543,
            "node_id": "U_kgDOBno2Hw",
            "avatar_url": "https://avatars.githubusercontent.com/u/108672543?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rajumgokak",
            "html_url": "https://github.com/rajumgokak",
            "followers_url": "https://api.github.com/users/rajumgokak/followers",
            "following_url": "https://api.github.com/users/rajumgokak/following{/other_user}",
            "gists_url": "https://api.github.com/users/rajumgokak/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rajumgokak/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rajumgokak/subscriptions",
            "organizations_url": "https://api.github.com/users/rajumgokak/orgs",
            "repos_url": "https://api.github.com/users/rajumgokak/repos",
            "events_url": "https://api.github.com/users/rajumgokak/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rajumgokak/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-05T13:12:45Z",
        "updated_at": "2022-09-05T13:14:32Z",
        "author_association": "NONE",
        "body": "Try to convert it to int8 model size will reduce to 1/4 of the org model size and less inference time.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1237005496/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "rajumgokak",
            "id": 108672543,
            "node_id": "U_kgDOBno2Hw",
            "avatar_url": "https://avatars.githubusercontent.com/u/108672543?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rajumgokak",
            "html_url": "https://github.com/rajumgokak",
            "followers_url": "https://api.github.com/users/rajumgokak/followers",
            "following_url": "https://api.github.com/users/rajumgokak/following{/other_user}",
            "gists_url": "https://api.github.com/users/rajumgokak/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rajumgokak/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rajumgokak/subscriptions",
            "organizations_url": "https://api.github.com/users/rajumgokak/orgs",
            "repos_url": "https://api.github.com/users/rajumgokak/repos",
            "events_url": "https://api.github.com/users/rajumgokak/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rajumgokak/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1354902535",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10786#issuecomment-1354902535",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10786",
        "id": 1354902535,
        "node_id": "IC_kwDOCVq1mM5QwiwH",
        "user": {
            "login": "TajinderSingh-1",
            "id": 30046037,
            "node_id": "MDQ6VXNlcjMwMDQ2MDM3",
            "avatar_url": "https://avatars.githubusercontent.com/u/30046037?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TajinderSingh-1",
            "html_url": "https://github.com/TajinderSingh-1",
            "followers_url": "https://api.github.com/users/TajinderSingh-1/followers",
            "following_url": "https://api.github.com/users/TajinderSingh-1/following{/other_user}",
            "gists_url": "https://api.github.com/users/TajinderSingh-1/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TajinderSingh-1/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TajinderSingh-1/subscriptions",
            "organizations_url": "https://api.github.com/users/TajinderSingh-1/orgs",
            "repos_url": "https://api.github.com/users/TajinderSingh-1/repos",
            "events_url": "https://api.github.com/users/TajinderSingh-1/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TajinderSingh-1/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-16T14:09:26Z",
        "updated_at": "2022-12-16T14:09:26Z",
        "author_association": "NONE",
        "body": "> I do some following tests. first, using the same number processing and threading\r\n> \r\n> 1. Initializing onnxruntime mode using `onnxruntime.InferenceSession` in every process, one image inference cost time is slower around 3x than multithread. For example, using processing cost 1.2s,  using threading cost 0.4s.\r\n> 2. Initializing onnxruntime mode, and shareing class to every process, one image inference cost time is slower 1.3x than multithread. For example, using processing cost 0.52s,  using threading cost 0.4s.\r\n> \r\n> So. i get the following guesses: onnxruntime has fully utilized cpu resources, using multi onnxruntime model can only be slower in mutilprocessing.\r\n\r\nThis is a bit unrelated, but how do you pass the onxxruntime session through multiple processes? I get this error when I try to share the onnxruntime session with other processes:\r\n   \r\n     ForkingPickler(file, protocol).dump(obj)\r\n    TypeError: can't pickle onnxruntime.capi.onnxruntime_pybind11_state.InferenceSession objects\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1354902535/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "TajinderSingh-1",
            "id": 30046037,
            "node_id": "MDQ6VXNlcjMwMDQ2MDM3",
            "avatar_url": "https://avatars.githubusercontent.com/u/30046037?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TajinderSingh-1",
            "html_url": "https://github.com/TajinderSingh-1",
            "followers_url": "https://api.github.com/users/TajinderSingh-1/followers",
            "following_url": "https://api.github.com/users/TajinderSingh-1/following{/other_user}",
            "gists_url": "https://api.github.com/users/TajinderSingh-1/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TajinderSingh-1/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TajinderSingh-1/subscriptions",
            "organizations_url": "https://api.github.com/users/TajinderSingh-1/orgs",
            "repos_url": "https://api.github.com/users/TajinderSingh-1/repos",
            "events_url": "https://api.github.com/users/TajinderSingh-1/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TajinderSingh-1/received_events",
            "type": "User",
            "site_admin": false
        }
    }
]