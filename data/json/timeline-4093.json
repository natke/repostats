[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636360937",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-636360937",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 636360937,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjM2MDkzNw==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-05-30T17:30:03Z",
        "updated_at": "2020-05-30T17:30:03Z",
        "author_association": "NONE",
        "body": "By the way, performance-wise, ORT is great. But in a multi-threaded, heavily orchestrated application using lots of models (2 to 5), i'm literally getting 50+ threads created. I have an 4core-8thread PC...",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636360937/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636660507",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-636660507",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 636660507,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjY2MDUwNw==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T07:21:07Z",
        "updated_at": "2020-06-01T07:21:07Z",
        "author_association": "NONE",
        "body": "Update:\r\nIf I use :\r\n```\r\nOrt::Env create_env()\r\n{\r\n    OrtThreadingOptions* envOpts = 0;\r\n    assert(Ort::Global<void>::api_.CreateThreadingOptions(&envOpts) == 0);\r\n    Ort::Env env(/*envOpts,*/ ORT_LOGGING_LEVEL_WARNING, \"test\");\r\n    Ort::Global<void>::api_.ReleaseThreadingOptions(envOpts);\r\n    return env;\r\n}\r\n```\r\n\r\nand \r\n```\r\nsession_options.SetInterOpNumThreads(1);\r\n            session_options.SetIntraOpNumThreads(1);\r\n            session_options.DisableCpuMemArena();\r\n            session_options.DisablePerSessionThreads();\r\n```\r\n\r\nIt has the opposite effect. It creates many more threads. \r\nThe biggest issue is the lack of memory freeing. I've done my best to not use a memory arena, though evidence in ```htop``` would suggest that it is using one and it is never getting freed. Now I would expect a memory arena to hold onto memory while a session is active but not when it has been deallocated.\r\n@snnn what do you make of all this? Do you experience similar issues with https://github.com/microsoft/onnxruntime/releases/download/v1.3.0/onnxruntime-linux-x64-gpu-1.3.0.tgz ?\r\nBTW, ignore my comments about OpenMP in the code above. I don't think the official builds are built with openmp. \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636660507/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 3391853452,
        "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM5MTg1MzQ1Mg==",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/3391853452",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2020-06-01T07:21:07Z",
        "performed_via_github_app": null
    },
    {
        "id": 3391853455,
        "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzOTE4NTM0NTU=",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/3391853455",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2020-06-01T07:21:07Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636664530",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-636664530",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 636664530,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjY2NDUzMA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T07:29:22Z",
        "updated_at": "2020-06-01T07:29:22Z",
        "author_association": "NONE",
        "body": "It also looks like that if you use ```OrtSessionOptionsAppendExecutionProvider_CUDA``` to use a CUDA device, more threads are created. Furthermore, when the session is destroyed, there is still a thread pool alive with a lot of memory held. Again, this is looking at ```htop``` and ```nvidia-smi```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636664530/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636684204",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-636684204",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 636684204,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjY4NDIwNA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T08:08:26Z",
        "updated_at": "2020-06-01T08:08:26Z",
        "author_association": "NONE",
        "body": "Has it got something to do with protobuf having its own memory arena ? ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/636684204/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637011160",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637011160",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637011160,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzAxMTE2MA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T17:48:19Z",
        "updated_at": "2020-06-01T17:48:19Z",
        "author_association": "NONE",
        "body": "Actually, i've just tried libdarknet. I get the same thing. Does cudnn do it's own thread pooling and memory arena business ?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637011160/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637043333",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637043333",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637043333,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzA0MzMzMw==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T18:56:34Z",
        "updated_at": "2020-06-01T18:56:34Z",
        "author_association": "NONE",
        "body": "Or can cudafree leak ? ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637043333/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637054536",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637054536",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637054536,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzA1NDUzNg==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T19:22:05Z",
        "updated_at": "2020-06-01T19:22:05Z",
        "author_association": "NONE",
        "body": "https://stackoverflow.com/questions/61346562/cuda-unified-memory-leak indicates that memory leaks are possible if there is a \"corrupt\" CUDA installation",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637054536/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637164880",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637164880",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637164880,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzE2NDg4MA==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-01T22:46:31Z",
        "updated_at": "2020-06-01T22:47:56Z",
        "author_association": "MEMBER",
        "body": "For the thread count concern, would you please try this?\r\n\r\nhttps://github.com/microsoft/onnxruntime/tree/master/onnxruntime/test/global_thread_pools \r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/master/onnxruntime/test/global_thread_pools/test_main.cc#L53\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637164880/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637263189",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637263189",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637263189,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzI2MzE4OQ==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T04:23:56Z",
        "updated_at": "2020-06-02T04:23:56Z",
        "author_association": "MEMBER",
        "body": "About thread pools closing:\r\n\r\n1. If openmp is enabled, yes, as you can see, it won't get closed. Because we didn't create the thread, openmp runtime did it.\r\n\r\n2. If openmp is disabled, then if the thread pool was created when creating the OrtEnv, then it will get destroyed when you destroy the OrtEnv. If the thread pool was created when creating the session, then it will get destroyed when you destroy the session.  \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637263189/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637284470",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637284470",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637284470,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzI4NDQ3MA==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T05:25:47Z",
        "updated_at": "2020-06-02T05:25:47Z",
        "author_association": "MEMBER",
        "body": "Note that there's currently no way to disable the arena the CUDA ExecutionProvider uses, so there will be some memory held by the session (as it owns the execution provider instance) for that (most on the CUDA device, but a small amount on CPU for transfers).\r\n\r\nUnfortunately I don't know if there's currently a way to use the same ExecutionProvider instance across multiple sessions, so each is going to end up with a separate arena. \r\n\r\n> Ort::Env create_env()\r\n{\r\n    OrtThreadingOptions* envOpts = 0;\r\n    assert(Ort::Global<void>::api_.CreateThreadingOptions(&envOpts) == 0);\r\n    Ort::Env env(/*envOpts,*/ ORT_LOGGING_LEVEL_WARNING, \"test\");\r\n    Ort::Global<void>::api_.ReleaseThreadingOptions(envOpts);\r\n    return env;\r\n}\r\n\r\nIf you don't provide OrtThreadingOptions on the first call to create the environment it will not use a global threadpool. However I would have expected an error from setting DisablePerSessionThreads if that was the case, so I'm not sure if you had envOpts commented out when constructing Ort::Env. If it wasn't commented out and you used the same Env instance for all the sessions the number of threads created by ORT shouldn't increase with each new session.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637284470/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637295511",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637295511",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637295511,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzI5NTUxMQ==",
        "user": {
            "login": "pranavsharma",
            "id": 2732907,
            "node_id": "MDQ6VXNlcjI3MzI5MDc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2732907?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pranavsharma",
            "html_url": "https://github.com/pranavsharma",
            "followers_url": "https://api.github.com/users/pranavsharma/followers",
            "following_url": "https://api.github.com/users/pranavsharma/following{/other_user}",
            "gists_url": "https://api.github.com/users/pranavsharma/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pranavsharma/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pranavsharma/subscriptions",
            "organizations_url": "https://api.github.com/users/pranavsharma/orgs",
            "repos_url": "https://api.github.com/users/pranavsharma/repos",
            "events_url": "https://api.github.com/users/pranavsharma/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pranavsharma/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T05:54:46Z",
        "updated_at": "2020-06-02T05:59:38Z",
        "author_association": "MEMBER",
        "body": "> BTW, ignore my comments about OpenMP in the code above. I don't think the official builds are built with openmp.\r\n\r\nThe official CPU builds are indeed built with openmp enabled.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637295511/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pranavsharma",
            "id": 2732907,
            "node_id": "MDQ6VXNlcjI3MzI5MDc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2732907?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pranavsharma",
            "html_url": "https://github.com/pranavsharma",
            "followers_url": "https://api.github.com/users/pranavsharma/followers",
            "following_url": "https://api.github.com/users/pranavsharma/following{/other_user}",
            "gists_url": "https://api.github.com/users/pranavsharma/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pranavsharma/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pranavsharma/subscriptions",
            "organizations_url": "https://api.github.com/users/pranavsharma/orgs",
            "repos_url": "https://api.github.com/users/pranavsharma/repos",
            "events_url": "https://api.github.com/users/pranavsharma/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pranavsharma/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637374421",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637374421",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637374421,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM3NDQyMQ==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:19:26Z",
        "updated_at": "2020-06-02T08:19:26Z",
        "author_association": "NONE",
        "body": "So i'm using:\r\n```\r\n    OrtThreadingOptions* envOpts = 0;\r\n    assert(Ort::GetApi().CreateThreadingOptions(&envOpts) == nullptr);\r\n    Ort::Env env(envOpts, ORT_LOGGING_LEVEL_WARNING, \"test\");\r\n    Ort::GetApi().ReleaseThreadingOptions(envOpts);\r\n    return env;\r\n```\r\n\r\nthen \r\n```\r\n        session_options.SetGraphOptimizationLevel(GraphOptimizationLevel::ORT_ENABLE_ALL);\r\n        session_options.SetInterOpNumThreads(1);\r\n        session_options.SetIntraOpNumThreads(1);\r\n        session_options.DisablePerSessionThreads();\r\n        if (cuda_device >= 0)\r\n            assert(OrtSessionOptionsAppendExecutionProvider_CUDA(session_options, cuda_device) == 0);\r\n```\r\n\r\nI'm running 5 models concurrently and i'm getting 25 threads, 1 of which is main thread and 5 of which are running the 5 models concurrently. I have 8 physical threads on my PC. So i would expect all 5 models to share a thread pool of 8 threads. No?\r\n\r\nIf i use :\r\n```\r\nOrt::Env env(ORT_LOGGING_LEVEL_WARNING, \"test\");\r\n```\r\nand \r\n```\r\nsession_options.SetGraphOptimizationLevel(GraphOptimizationLevel::ORT_ENABLE_ALL);\r\n        session_options.SetInterOpNumThreads(1);\r\n        session_options.SetIntraOpNumThreads(1);\r\n        if (cuda_device >= 0)\r\n            assert(OrtSessionOptionsAppendExecutionProvider_CUDA(session_options, cuda_device) == 0);\r\n```\r\n\r\ni get 11 threads when running 5 models concurrently. \r\n\r\nSo behavior isn't as expected.\r\nBy the way, i've reinstalled CUDA to avoid \"corrupt\" installations.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637374421/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637377380",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637377380",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637377380,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM3NzM4MA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:24:27Z",
        "updated_at": "2020-06-02T08:24:27Z",
        "author_association": "NONE",
        "body": "i've tried building onnxruntime from source using both CUDA 10.1 and CUDA 10.2. I get the same behavior. So i've dumped 10.1 because i want to avoid having conflicting CUDA installations. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637377380/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637378599",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637378599",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637378599,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM3ODU5OQ==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:26:33Z",
        "updated_at": "2020-06-02T08:26:33Z",
        "author_association": "NONE",
        "body": "There's also the issue with leftover threads holding loads of memory. I get similar behavior with libdarknet. So i'm wondering if CUDA library or CUDNN have internal memory pools that allocate workspaces or something like that and there's nothing you can do about it. However it would seem libdarknet is better at disposing memory when \"sessions\" are deallocated. I don't know enough about the internals of CUDA and CUDNN to say for sure. But this is all making me very nervous ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637378599/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637380613",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637380613",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637380613,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM4MDYxMw==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:29:51Z",
        "updated_at": "2020-06-02T08:29:51Z",
        "author_association": "NONE",
        "body": "Oh and i'm using ```OrtDeviceAllocator``` not ```OrtArenaAllocator```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637380613/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637384125",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637384125",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637384125,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM4NDEyNQ==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:35:43Z",
        "updated_at": "2020-06-02T08:35:43Z",
        "author_association": "NONE",
        "body": "@snnn Can you see anything wrong with this code?\r\n```\r\nOrt::Env create_env()\r\n{\r\n//    OrtThreadingOptions* envOpts = 0;\r\n//    assert(Ort::GetApi().CreateThreadingOptions(&envOpts) == nullptr);\r\n    Ort::Env env(/*envOpts,*/ ORT_LOGGING_LEVEL_WARNING, \"test\");\r\n//    Ort::GetApi().ReleaseThreadingOptions(envOpts);\r\n    return env;\r\n}\r\n\r\nOrt::Env env = create_env();\r\n\r\nstruct onnx_model::onnx_model_impl\r\n{\r\n    onnx_model_impl(const void* modeldata, size_t modelsize, int cuda_device)\r\n    :   session(nullptr)\r\n    {\r\n        session_options.SetGraphOptimizationLevel(GraphOptimizationLevel::ORT_ENABLE_ALL);\r\n        session_options.SetInterOpNumThreads(1);\r\n        session_options.SetIntraOpNumThreads(1);\r\n//        session_options.DisableCpuMemArena();\r\n//        session_options.DisablePerSessionThreads();\r\n        if (cuda_device >= 0)\r\n            assert(OrtSessionOptionsAppendExecutionProvider_CUDA(session_options, cuda_device) == 0);\r\n        \r\n        session = Ort::Session(env, modeldata, modelsize, session_options);\r\n\r\n        size_t num_input_nodes = session.GetInputCount();\r\n        \r\n        for (size_t i = 0; i < num_input_nodes; i++) \r\n        {\r\n            // print input node names\r\n            char* input_name = session.GetInputName(i, allocator);\r\n            input_names.push_back(input_name);\r\n\r\n            // print input node types\r\n            Ort::TypeInfo type_info = session.GetInputTypeInfo(i);\r\n            auto object_type        = type_info.GetONNXType();\r\n            auto tensor_info        = type_info.GetTensorTypeAndShapeInfo();\r\n            auto value_type         = tensor_info.GetElementType();\r\n            auto shape              = tensor_info.GetShape();\r\n            input_shapes.push_back(shape);\r\n            string shape_str_all = \"\";\r\n            for (auto s : shape)\r\n                shape_str_all += std::to_string(s) + \",\";\r\n            printf(\"input  %lu name %s obj type %i val type %i shape %s\\n\", i,\r\n                                                                               input_name,\r\n                                                                               (int)object_type,\r\n                                                                               (int)value_type,\r\n                                                                               shape_str_all.c_str());\r\n        }\r\n    \r\n        size_t num_output_nodes = session.GetOutputCount();\r\n\r\n        for (size_t i = 0; i < num_output_nodes; i++) \r\n        {\r\n            // print input node names\r\n            char* output_name = session.GetOutputName(i, allocator);\r\n            output_names.push_back(output_name);\r\n\r\n            // print input node types\r\n            Ort::TypeInfo type_info = session.GetOutputTypeInfo(i);\r\n            auto object_type        = type_info.GetONNXType();\r\n            auto tensor_info        = type_info.GetTensorTypeAndShapeInfo();\r\n            auto value_type         = tensor_info.GetElementType();\r\n            auto shape              = tensor_info.GetShape();\r\n            output_shapes.push_back(shape);\r\n            string shape_str_all = \"\";\r\n            for (auto s : shape)\r\n                shape_str_all += std::to_string(s) + \",\";\r\n            printf(\"output %lu name %s obj type %i val type %i shape %s\\n\", i,\r\n                                                                               output_name,\r\n                                                                               (int)object_type,\r\n                                                                               (int)value_type,\r\n                                                                               shape_str_all.c_str());\r\n        }\r\n    }\r\n       \r\n    void infer(vector<vector<int64_t>>  inputshapes, \r\n               vector<const float*>     inputs,\r\n               vector<vector<int64_t>>& outputshapes,\r\n               vector<vector<float>>&   outputs)\r\n    {\r\n        assert(inputshapes.size() == inputs.size());\r\n        assert(inputs.size() == input_names.size());\r\n        \r\n        vector<Ort::Value> input_tensors;\r\n        for (size_t i = 0 ; i < inputs.size() ; i++)\r\n        {\r\n            //check shape\r\n            auto& shape = inputshapes[i];\r\n            auto& exp   = input_shapes[i];\r\n            for (size_t d = 0 ; d < shape.size() ; d++)\r\n                if (exp[d] > 0)\r\n                    assert(exp[d] == shape[d]);\r\n            //total size\r\n            int64_t size = std::accumulate(shape.begin(), shape.end(), 1, [](int64_t p, int64_t s){return p*s;});\r\n            //load tensor\r\n            auto memory_info = Ort::MemoryInfo::CreateCpu(OrtDeviceAllocator, OrtMemTypeDefault);\r\n            input_tensors.push_back(Ort::Value::CreateTensor<float>(memory_info, \r\n                                                                    const_cast<float*>(inputs[i]), \r\n                                                                    size, \r\n                                                                    shape.data(), \r\n                                                                    shape.size()));\r\n            assert(input_tensors.back().IsTensor());\r\n        }\r\n\r\n        auto output_tensors = session.Run(Ort::RunOptions{nullptr}, input_names.data(), &input_tensors[0], input_tensors.size(), output_names.data(), output_names.size());\r\n\r\n        for (auto& output_tensor : output_tensors)\r\n        {\r\n            auto type_info = output_tensor.GetTypeInfo();\r\n//            auto object_type        = type_info.GetONNXType();\r\n            auto tensor_info        = type_info.GetTensorTypeAndShapeInfo();\r\n//            auto value_type         = tensor_info.GetElementType();\r\n            auto shape              = tensor_info.GetShape();\r\n            outputshapes.push_back(shape);\r\n            int64_t size = std::accumulate(shape.begin(), shape.end(), 1, [](int64_t p, int64_t s){return p*s;});\r\n            float* ptr = output_tensor.GetTensorMutableData<float>();\r\n            outputs.emplace_back(ptr, ptr + size);\r\n        }\r\n    }\r\n\r\n    Ort::SessionOptions                 session_options;\r\n    Ort::AllocatorWithDefaultOptions    allocator;\r\n    Ort::Session                        session;\r\n    std::vector<const char*>            input_names;\r\n    std::vector<std::vector<int64_t>>   input_shapes;\r\n    std::vector<const char*>            output_names;\r\n    std::vector<std::vector<int64_t>>   output_shapes;\r\n};\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637384125/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 3396516208,
        "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM5NjUxNjIwOA==",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/3396516208",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2020-06-02T08:35:44Z",
        "performed_via_github_app": null
    },
    {
        "id": 3396516212,
        "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzOTY1MTYyMTI=",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/3396516212",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2020-06-02T08:35:44Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637395384",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-637395384",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 637395384,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM5NTM4NA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-02T08:54:02Z",
        "updated_at": "2020-06-02T08:54:02Z",
        "author_association": "NONE",
        "body": "if there is nothing wrong with the code above it must be either:\r\n- bad CUDA/CUDNN installation (which i doubt. I've reinstalled everything from scratch)\r\n- Misunderstanding of what CUDA and CUDNN do behind the scenes\r\n- Bug in onnxruntime",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/637395384/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638011144",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638011144",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638011144,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODAxMTE0NA==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T07:24:41Z",
        "updated_at": "2020-06-03T07:24:41Z",
        "author_association": "MEMBER",
        "body": "Some clarifications:\r\n\r\nWhen you create the shared global threadpool by passing OrtThreadingOptions to the OrtEnv constructor it will default to creating pool sizes based on the number of cores. e.g. if you have 4 cores you would get 4 threads in the intra-op threadpools, and 4 in the inter-op threadpool. Any session created after that will use that threadpool, so setting the intra/inter op thread counts in session options will do nothing.\r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/905c53562601ca4940bed2e445c7fcc6445f7687/onnxruntime/core/session/inference_session.cc#L173-L210\r\n\r\nWhen you are not using the shared threadpool, each session will have its own intra/inter op threadpool and the size will be based on SessionOptions.Set{Intra|Inter}OpNumThreads\r\n\r\nI re-created most of your setup (Windows not linux though so possibly some differences) and see this after creating 4 session using the global threadpool:\r\n\r\n![image](https://user-images.githubusercontent.com/979079/83605414-354e1b00-a5bb-11ea-96ac-4a454c511827.png)\r\n\r\nOne main thread. 4 threads for global intra and inter op threadpools, and 3 CUDA threads that were created when the first CUDA EP was first created but no extra threads after that. Ignore the 3 threads from ntdll as they're not relevant to your question.\r\n\r\nThe number of CUDA threads may differ on Linux as I don't know how they choose how many threads to create.\r\n\r\nNo growth in threads occurs when calling your infer(...) method.\r\n\r\nFinally when I cleanup the sessions and free the environment the ORT threadpool threads go away. There are still the 3 CUDA threads remaining though as we don't control those. I don't know how much memory they're holding onto. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638011144/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638037702",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638037702",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638037702,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODAzNzcwMg==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T08:13:09Z",
        "updated_at": "2020-06-03T08:13:09Z",
        "author_association": "NONE",
        "body": "Thank you for your response. I think i'm satisfied with the thread pooling. I think part of the confusion is i'm building onnxruntime from source and regardless of whether or not i use option \"use_openmp\", it builds with openMP. So after passing my program through GDB and tracing thread back traces, i realised that onnxruntime was using openmp. So indeed the SetInterOpNumThreads and SetIntraOpNumThreads functions weren't doing anything. Is there a way of disabling openmp when building from source? Maybe CMAKE auto-detects openmp and uses it regardless (on Linux. I appreciate you guys develop on windows) ?\r\n\r\nThe CUDA threads not being removed and holding onto memory worries me a bit. Though less so since i realised that other libraries like darknet have similar behavior. Maybe CUDA does some internal caching, thread pooling that is hidden to the user. Maybe that is precisely what functions like cudaMallocManaged do. \r\n\r\nI'm don't know why i had a growth in threads when using a global thread pool. Maybe it's because i hadn't realised my build of onnxruntime was using openmp and the combination of the two don't play nicely. I'll try rebuilding it without openmp and see if the behaviour is as expected.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638037702/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638039647",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638039647",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638039647,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODAzOTY0Nw==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T08:16:59Z",
        "updated_at": "2020-06-03T08:16:59Z",
        "author_association": "NONE",
        "body": "So i rebuild using the following command:\r\n```\r\n./build.sh --use_cuda --cuda_version=10.2 --cuda_home /usr/local/cuda-10.2/ --cudnn_home /usr/local/cuda-10.2/ --build_shared_lib --config Release --parallel\r\n```\r\nThe cmake log outputs this:\r\n```\r\n-- Found OpenMP_C: -fopenmp (found version \"4.5\") \r\n-- Found OpenMP_CXX: -fopenmp (found version \"4.5\") \r\n-- Found OpenMP: TRUE (found version \"4.5\") \r\n```\r\n\r\nSo i'm wondering if uses it anyway, even though i haven't specified the \"use_openmp\" option.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638039647/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638048634",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638048634",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638048634,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA0ODYzNA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T08:35:19Z",
        "updated_at": "2020-06-03T08:35:19Z",
        "author_association": "NONE",
        "body": "ah, just realised the build script has this line:\r\npython3 $DIR/tools/ci_build/build.py --use_openmp --build_dir $DIR/build/Linux \"$@\"\r\nSo openmp was always being used",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638048634/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638048930",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638048930",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638048930,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA0ODkzMA==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T08:35:53Z",
        "updated_at": "2020-06-03T08:35:53Z",
        "author_association": "NONE",
        "body": "Maybe the '--use_openmp' should be removed from build.sh ?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638048930/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638064582",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638064582",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638064582,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA2NDU4Mg==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T09:02:37Z",
        "updated_at": "2020-06-03T09:02:37Z",
        "author_association": "NONE",
        "body": "Ok that worked. So now it uses onnxruntime's own thread pool, and when per-session thread pool is enabled, it gets 'freed' when the session gets deallocted. Great. \r\nIs there a way to detect if onnxruntime is built with openmp at runtime? I know the python API allows this, but not sure about C++ api?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638064582/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638074284",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638074284",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638074284,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA3NDI4NA==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T09:19:43Z",
        "updated_at": "2020-06-03T09:19:43Z",
        "author_association": "MEMBER",
        "body": "Looks like that has already been cleaned up. Apologies for the confusion that caused. \r\nhttps://github.com/microsoft/onnxruntime/commit/bd8993cb15c0ca3debfe9f54ed63c30aed972c82\r\n\r\nWhat should be done differently if it could report if  it's using openmp at runtime? \r\n\r\nFWIW you can run ldd on a binary to see if it depends on openmp libraries. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638074284/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638075579",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638075579",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638075579,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA3NTU3OQ==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T09:22:08Z",
        "updated_at": "2020-06-03T09:22:08Z",
        "author_association": "NONE",
        "body": "yeah i thought about running ldd on libonnxruntime.so at runtime, but that seems like a temporary hack. Basically i need to know whether to set:\r\n```\r\nsession_options.SetInterOpNumThreads(1);\r\nsession_options.SetIntraOpNumThreads(1);\r\n```\r\nor\r\n```\r\nsession_options.SetInterOpNumThreads(std::thread::hardware_concurrency());\r\nsession_options.SetIntraOpNumThreads(std::thread::hardware_concurrency());\r\n```\r\nWhich one depends on whether onnxruntime is built with openmp\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638075579/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638076712",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4093#issuecomment-638076712",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4093",
        "id": 638076712,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYzODA3NjcxMg==",
        "user": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-03T09:24:22Z",
        "updated_at": "2020-06-03T09:24:22Z",
        "author_association": "NONE",
        "body": "i'm temporarily using some extern bools:\r\n```\r\nextern const bool onnxruntime_is_built_with_openmp;\r\nextern const bool onnxruntime_use_global_threadpool;\r\n```\r\nto configure the onnxruntime inference code. Then i just need to define them somewhere in my app otherwise it won't compile, so it forces me to think about it and set it appropriately in order for the app to compile.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/638076712/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "pfeatherstone",
            "id": 45853521,
            "node_id": "MDQ6VXNlcjQ1ODUzNTIx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45853521?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pfeatherstone",
            "html_url": "https://github.com/pfeatherstone",
            "followers_url": "https://api.github.com/users/pfeatherstone/followers",
            "following_url": "https://api.github.com/users/pfeatherstone/following{/other_user}",
            "gists_url": "https://api.github.com/users/pfeatherstone/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pfeatherstone/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pfeatherstone/subscriptions",
            "organizations_url": "https://api.github.com/users/pfeatherstone/orgs",
            "repos_url": "https://api.github.com/users/pfeatherstone/repos",
            "events_url": "https://api.github.com/users/pfeatherstone/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pfeatherstone/received_events",
            "type": "User",
            "site_admin": false
        }
    }
]