[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1240031786",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1240031786",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1240031786,
        "node_id": "IC_kwDOCVq1mM5J6WIq",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-07T23:56:48Z",
        "updated_at": "2022-09-07T23:56:48Z",
        "author_association": "MEMBER",
        "body": "I don't think the device used by the pytorch export has any relevant to how ORT runs the model so I wouldn't worry about that. If you set the log severity to VERBOSE the node assignments will be printed out. Look for 'VerifyEachNodeIsAssignedToAnEp' in the output.\r\n\r\n```py\r\nso = onnxruntime.SessionOptions()\r\nso.log_severity_level = 0\r\nort_session = onnxruntime.InferenceSession('model.onnx', so)\r\n```\r\n\r\nShould produce output like this:\r\n\r\n```\r\n2022-09-08 09:54:11.5652487 [V:onnxruntime:, session_state.cc:1186 onnxruntime::VerifyEachNodeIsAssignedToAnEp] Node placements\r\n2022-09-08 09:54:11.5722903 [V:onnxruntime:, session_state.cc:1188 onnxruntime::VerifyEachNodeIsAssignedToAnEp] All nodes have been placed on [CPUExecutionProvider].\r\n```\r\n\r\nORT will perform various optimizations when loading the model. If you want to view how that modifies the model you can use this script to save the model with the optimizations applied.\r\n`python -m onnxruntime.tools.optimize_onnx_model --opt_level extended <input model> <output model>`\r\n\r\nOptimization levels are described here: https://onnxruntime.ai/docs/performance/graph-optimizations.html\r\n\r\nAre you binding the model input and outputs so they stay on GPU? Otherwise there's device copy between CPU and GPU that can significantly affect performance.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1240031786/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1240455413",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1240455413",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1240455413,
        "node_id": "IC_kwDOCVq1mM5J79j1",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-08T09:21:06Z",
        "updated_at": "2022-09-08T09:21:06Z",
        "author_association": "NONE",
        "body": "Thank you for your answer\r\n\r\n> I don't think the device used by the pytorch export has any relevant to how ORT runs the model so I wouldn't worry about that. If you set the log severity to VERBOSE the node assignments will be printed out. Look for 'VerifyEachNodeIsAssignedToAnEp' in the output.\r\n> \r\n> ```python\r\n> so = onnxruntime.SessionOptions()\r\n> so.log_severity_level = 0\r\n> ort_session = onnxruntime.InferenceSession('model.onnx', so)\r\n> ```\r\n\r\nI looked into the node assignments and got this output:\r\n````\r\n2022-09-08 08:45:30.708811165 [V:onnxruntime:, session_state.cc:1193 VerifyEachNodeIsAssignedToAnEp]  Provider: [CPUExecutionProvider]: [Slice (Slice_95), Concat (Concat_96), Slice (Slice_125), Concat (Concat_126), Slice (Slice_155), Concat (Concat_156), ]\r\n2022-09-08 08:45:30.708831105 [V:onnxruntime:, session_state.cc:1193 VerifyEachNodeIsAssignedToAnEp]  Provider: [CUDAExecutionProvider]: [Conv (Conv_0), Relu (Relu_1), Reshape (Reshape_3), InstanceNormalization (InstanceNormalization_6), ...\r\n````\r\nSo it does seem like some operations run on the CPU, though idk if this is the cause for the slow-down ?\r\n\r\n\r\n> ORT will perform various optimizations when loading the model. If you want to view how that modifies the model you can use this script to save the model with the optimizations applied. `python -m onnxruntime.tools.optimize_onnx_model --opt_level extended <input model> <output model>`\r\n> \r\n> Optimization levels are described here: https://onnxruntime.ai/docs/performance/graph-optimizations.html\r\n\r\nI get the attached graph as output when running the optimisations. The weird thing is that the optimised model is even slower: I go from 350ms to 690ms per inference\r\n\r\n> Are you binding the model input and outputs so they stay on GPU? Otherwise there's device copy between CPU and GPU that can significantly affect performance.\r\n\r\nI think that I'm doing it correctly, see code below:\r\n\r\n````\r\ndeviceType = 'cuda'\r\ndeviceId = '0'\r\ndevice = torch.device(deviceType + deviceId)\r\ninput_names = ort_session.get_inputs()[0].name\r\noutput_names = ort_session.get_outputs()[0].name\r\nio_binding = ort_session.io_binding()\r\n\r\ndata = onnxruntime.OrtValue.ortvalue_from_numpy(x, device.type, 0)\r\nio_binding.bind_input(input_names, deviceType, int(deviceId), np.float16, [batch_size, 1, 96, 96, 96], data.data_ptr())\r\nio_binding.bind_output(output_names, device_type=deviceType,\r\n      device_id=int(deviceId))\r\n\r\n#warm up run\r\nort_session.run_with_iobinding(io_binding)\r\n\r\nfor i in range(total_samples):\r\n  t0 = time.time()\r\n  ort_session.run_with_iobinding(io_binding)\r\n  latency.append(time.time() - t0)\r\n\r\n````\r\n\r\nOverall, I'm a bit stuck to find where the slow-down comes from.. Without resolving this we'll have to go with another solution than ONNX\r\n\r\n![model_optimised onnx](https://user-images.githubusercontent.com/53873742/189081586-8ecee6e4-a0e8-49aa-a2a7-618f574abd23.svg)\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1240455413/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241326235",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241326235",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241326235,
        "node_id": "IC_kwDOCVq1mM5J_SKb",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-08T23:14:36Z",
        "updated_at": "2022-09-08T23:40:55Z",
        "author_association": "MEMBER",
        "body": "The `Slice`s and `Concat`s that are being forced down to CPU are part of shape subgraphs - if you look at what they are doing, they slice out one int and concatenate 2 ints and so on. There is no need for these ops to be hardware accelerated (in fact they are detrimental). So ORT has logic to force these to CPU to save device bandwidth for ops that actually require hardware acceleration. So, I don't believe this is the cause for the poor perf.\r\n\r\nHave you tried using nvprof and checking which kernel takes up the most time ? That is the best way to move forward with this.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241326235/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7352079753,
        "node_id": "LE_lADOCVq1mM5RXPxdzwAAAAG2N9WJ",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7352079753",
        "actor": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-08T23:14:44Z",
        "label": {
            "name": "ep:CUDA",
            "color": "0052CC"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241339553",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241339553",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241339553,
        "node_id": "IC_kwDOCVq1mM5J_Vah",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-08T23:39:02Z",
        "updated_at": "2022-09-08T23:45:48Z",
        "author_association": "MEMBER",
        "body": "Since you have a Conv-heavy fp16 model and a card that supports tensor core operations, can you try this simple one-line update to your script - \r\n\r\nhttps://onnxruntime.ai/docs/performance/tune-performance.html#convolution-heavy-models-and-the-cuda-ep.\r\n\r\n\r\nThis is why I expect this to help your use-case:\r\n\r\n![image](https://user-images.githubusercontent.com/9969784/189243945-b85344ad-4be9-43d0-8459-c8b5f901b5ba.png)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241339553/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241583198",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241583198",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241583198,
        "node_id": "IC_kwDOCVq1mM5KAQ5e",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T07:06:25Z",
        "updated_at": "2022-09-09T07:06:25Z",
        "author_association": "MEMBER",
        "body": "> I get the attached graph as output when running the optimisations. The weird thing is that the optimised model is even slower: I go from 350ms to 690ms per inference\r\n\r\nSorry - overlooked that that script doesn't have a way to enable the CUDA EP when running. I'm guessing that results in CPU EP specific custom ops being inserted which leads to more of the model running on the CPU EP. \r\n\r\nThe script is very simple though and you can do the equivalent (set optimization level and output filename in session options) manually if you want to see the optimized model for a session with the CUDA EP enabled.\r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/0b235b27632e96c5f9cf01093d9d4d4ecf2f8447/tools/python/util/onnx_model_utils.py#L103-L105",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241583198/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241609589",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241609589",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241609589,
        "node_id": "IC_kwDOCVq1mM5KAXV1",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T07:31:19Z",
        "updated_at": "2022-09-09T07:31:19Z",
        "author_association": "NONE",
        "body": "> Since you have a Conv-heavy fp16 model and a card that supports tensor core operations, can you try this simple one-line update to your script -\r\n> \r\n> https://onnxruntime.ai/docs/performance/tune-performance.html#convolution-heavy-models-and-the-cuda-ep.\r\n> \r\n> This is why I expect this to help your use-case:\r\n> \r\n> ![image](https://user-images.githubusercontent.com/9969784/189243945-b85344ad-4be9-43d0-8459-c8b5f901b5ba.png)\r\n\r\nI was already using this actually.. (I used the same setup as [here](https://github.com/microsoft/onnxruntime/issues/10303#issue-1105503554))\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241609589/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241610460",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241610460",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241610460,
        "node_id": "IC_kwDOCVq1mM5KAXjc",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T07:32:18Z",
        "updated_at": "2022-09-09T07:32:18Z",
        "author_association": "NONE",
        "body": "> > I get the attached graph as output when running the optimisations. The weird thing is that the optimised model is even slower: I go from 350ms to 690ms per inference\r\n> \r\n> Sorry - overlooked that that script doesn't have a way to enable the CUDA EP when running. I'm guessing that results in CPU EP specific custom ops being inserted which leads to more of the model running on the CPU EP.\r\n> \r\n> The script is very simple though and you can do the equivalent (set optimization level and output filename in session options) manually if you want to see the optimized model for a session with the CUDA EP enabled.\r\n> \r\n> https://github.com/microsoft/onnxruntime/blob/0b235b27632e96c5f9cf01093d9d4d4ecf2f8447/tools/python/util/onnx_model_utils.py#L103-L105\r\n\r\nI was already using `ORT_ENABLE_ALL`, and actually don't really see a difference in performance when using `ORT_ENABLE_BASIC`",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241610460/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241678294",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241678294",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241678294,
        "node_id": "IC_kwDOCVq1mM5KAoHW",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T08:38:03Z",
        "updated_at": "2022-09-09T08:38:03Z",
        "author_association": "MEMBER",
        "body": "Any difference is dependent on the model and the EPs that are enabled. If there are no internal ORT operators with CUDA implementations that apply to nodes the CUDA EP is taking there won't be a difference between 'basic' and 'extended'/'all'. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241678294/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241746492",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1241746492",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1241746492,
        "node_id": "IC_kwDOCVq1mM5KA4w8",
        "user": {
            "login": "sloth2012",
            "id": 4048815,
            "node_id": "MDQ6VXNlcjQwNDg4MTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4048815?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sloth2012",
            "html_url": "https://github.com/sloth2012",
            "followers_url": "https://api.github.com/users/sloth2012/followers",
            "following_url": "https://api.github.com/users/sloth2012/following{/other_user}",
            "gists_url": "https://api.github.com/users/sloth2012/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sloth2012/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sloth2012/subscriptions",
            "organizations_url": "https://api.github.com/users/sloth2012/orgs",
            "repos_url": "https://api.github.com/users/sloth2012/repos",
            "events_url": "https://api.github.com/users/sloth2012/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sloth2012/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T09:40:36Z",
        "updated_at": "2022-09-09T09:40:36Z",
        "author_association": "NONE",
        "body": "Meet similar issue. My onnxruntime model is very close to pytorch model (less than pytorch model)ã€‚ ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1241746492/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "sloth2012",
            "id": 4048815,
            "node_id": "MDQ6VXNlcjQwNDg4MTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4048815?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sloth2012",
            "html_url": "https://github.com/sloth2012",
            "followers_url": "https://api.github.com/users/sloth2012/followers",
            "following_url": "https://api.github.com/users/sloth2012/following{/other_user}",
            "gists_url": "https://api.github.com/users/sloth2012/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sloth2012/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sloth2012/subscriptions",
            "organizations_url": "https://api.github.com/users/sloth2012/orgs",
            "repos_url": "https://api.github.com/users/sloth2012/repos",
            "events_url": "https://api.github.com/users/sloth2012/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sloth2012/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242309660",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1242309660",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1242309660,
        "node_id": "IC_kwDOCVq1mM5KDCQc",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T18:08:19Z",
        "updated_at": "2022-09-09T18:08:19Z",
        "author_association": "MEMBER",
        "body": "> > Since you have a Conv-heavy fp16 model and a card that supports tensor core operations, can you try this simple one-line update to your script -\r\n> > https://onnxruntime.ai/docs/performance/tune-performance.html#convolution-heavy-models-and-the-cuda-ep.\r\n> > This is why I expect this to help your use-case:\r\n> > ![image](https://user-images.githubusercontent.com/9969784/189243945-b85344ad-4be9-43d0-8459-c8b5f901b5ba.png)\r\n> \r\n> I was already using this actually.. (I used the same setup as [here](https://github.com/microsoft/onnxruntime/issues/10303#issue-1105503554))\r\n\r\nMy bad. I didn't notice that.\r\n\r\nCould you run nvprof against your script and just give us the results of that ? \r\n\r\nAlso (if shareable), can you please give us the model ? ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242309660/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247268343",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1247268343",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1247268343,
        "node_id": "IC_kwDOCVq1mM5KV833",
        "user": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-14T20:28:55Z",
        "updated_at": "2022-09-14T20:30:05Z",
        "author_association": "MEMBER",
        "body": "Can you try running with ORTModule? You can just wrap your nn.Module model via\r\n```python\r\nfrom onnxruntime.training.ortmodule import ORTModule\r\nnew_model = ORTModule(model)\r\n# ORTModule is also nn.Module so just use it with the original inputs\r\noutput = new_model(inputs)\r\n```\r\nORTModule has some optimization to reduce overhead in the use of IOBinding. If you observe ORTModule brining some speedup, then it's really IOBinding's problem.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247268343/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247352981",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1247352981",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1247352981,
        "node_id": "IC_kwDOCVq1mM5KWRiV",
        "user": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-14T22:12:47Z",
        "updated_at": "2022-09-14T22:16:21Z",
        "author_association": "MEMBER",
        "body": "Could you run `nsys profile` with your model w/wo onnxruntime? It was easy to me to identify which part is the performance bottleneck when I have profiling result. For example, in the following figure, it's clear IOBinding causes performance issue.\r\n![image](https://user-images.githubusercontent.com/3524474/190272017-b2c11bf9-0615-4d04-a34d-766db511ad61.png). \r\nAnother example below shows unnecessary cudaMemcpy's happening in Reshape and slows down the model.\r\n![image](https://user-images.githubusercontent.com/3524474/190272555-2a10d020-5987-48ed-8a36-c0687f3af376.png)\r\n\r\n\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247352981/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247366930",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1247366930",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1247366930,
        "node_id": "IC_kwDOCVq1mM5KWU8S",
        "user": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-14T22:31:21Z",
        "updated_at": "2022-09-14T22:31:21Z",
        "author_association": "MEMBER",
        "body": "Why do you have so many Cast's in [this reply's](https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1240455413) figure? ORT recently adds support for \"strided\" tensors, so I expect those Cast's are no-op's. If I am wrong and ORT does real computation on those Cast's, it could slow down significantly. To verify if `Cast` is a problem, do you mind run your model under float32 and compare the time w/wo ORT? Thanks a lot!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247366930/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247852321",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1247852321",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1247852321,
        "node_id": "IC_kwDOCVq1mM5KYLch",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T09:41:56Z",
        "updated_at": "2022-09-15T09:41:56Z",
        "author_association": "NONE",
        "body": "Hello @wschin ! Thanks for all your suggestions, I'll try them as soon as I can, as I've been getting some errors due to the installation of `ORTModule` (similar to [this](https://github.com/microsoft/onnxruntime/issues/9754)) and don't have time to fix this right now..",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1247852321/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7393283438,
        "node_id": "MEE_lADOCVq1mM5RXPxdzwAAAAG4rI1u",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7393283438",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T09:41:56Z",
        "performed_via_github_app": null
    },
    {
        "id": 7393283452,
        "node_id": "SE_lADOCVq1mM5RXPxdzwAAAAG4rI18",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7393283452",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T09:41:56Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248369178",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1248369178",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1248369178,
        "node_id": "IC_kwDOCVq1mM5KaJoa",
        "user": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T16:58:24Z",
        "updated_at": "2022-09-15T17:00:14Z",
        "author_association": "MEMBER",
        "body": "@thomas-beznik, sure thing. If #9754 is the blocker, you probably need to [build ORT from source](https://tomwildenhain-microsoft.github.io/onnxruntime/docs/build/training.html). Note that you need a clean machine to avoid dependency interference for a clean build. Btw, you don't need ORTModule to do the float32 comparison. If you have time, please do float32 comparison first. Thank you.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248369178/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7396830991,
        "node_id": "MEE_lADOCVq1mM5RXPxdzwAAAAG44q8P",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7396830991",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T16:58:24Z",
        "performed_via_github_app": null
    },
    {
        "id": 7396830999,
        "node_id": "SE_lADOCVq1mM5RXPxdzwAAAAG44q8X",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7396830999",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T16:58:24Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248396926",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1248396926",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1248396926,
        "node_id": "IC_kwDOCVq1mM5KaQZ-",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T17:26:19Z",
        "updated_at": "2022-09-15T17:26:19Z",
        "author_association": "NONE",
        "body": "> @thomas-beznik, sure thing. If #9754 is the blocker, you probably need to [build ORT from source](https://tomwildenhain-microsoft.github.io/onnxruntime/docs/build/training.html). Note that you need a clean machine to avoid dependency interference for a clean build. Btw, you don't need ORTModule to do the float32 comparison. If you have time, please do float32 comparison first. Thank you.\r\n\r\nGot it, is there an easy way to undo the installation of ORTModule ? As now I cannot run normal ONNX inference either :/",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248396926/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7397007452,
        "node_id": "MEE_lADOCVq1mM5RXPxdzwAAAAG45WBc",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7397007452",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T17:26:19Z",
        "performed_via_github_app": null
    },
    {
        "id": 7397007457,
        "node_id": "SE_lADOCVq1mM5RXPxdzwAAAAG45WBh",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7397007457",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-15T17:26:19Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248400915",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1248400915",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1248400915,
        "node_id": "IC_kwDOCVq1mM5KaRYT",
        "user": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T17:30:40Z",
        "updated_at": "2022-09-15T17:48:13Z",
        "author_association": "MEMBER",
        "body": "First, pip uninstall `onnxruntime-training`? Then, `pip install onnxruntime`?\r\n\r\nHow many inputs/outputs/operators do you have? If the number of inputs/outputs is at the same scale as the number of operators, IOBinding is super slow.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1248400915/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "wschin",
            "id": 3524474,
            "node_id": "MDQ6VXNlcjM1MjQ0NzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3524474?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wschin",
            "html_url": "https://github.com/wschin",
            "followers_url": "https://api.github.com/users/wschin/followers",
            "following_url": "https://api.github.com/users/wschin/following{/other_user}",
            "gists_url": "https://api.github.com/users/wschin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wschin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wschin/subscriptions",
            "organizations_url": "https://api.github.com/users/wschin/orgs",
            "repos_url": "https://api.github.com/users/wschin/repos",
            "events_url": "https://api.github.com/users/wschin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wschin/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1251058614",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1251058614",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1251058614,
        "node_id": "IC_kwDOCVq1mM5KkaO2",
        "user": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-19T13:58:18Z",
        "updated_at": "2022-09-19T13:58:57Z",
        "author_association": "NONE",
        "body": "> Could you run `nsys profile` with your model w/wo onnxruntime? It was easy to me to identify which part is the performance bottleneck when I have profiling result. For example, in the following figure, it's clear IOBinding causes performance issue. ![image](https://user-images.githubusercontent.com/3524474/190272017-b2c11bf9-0615-4d04-a34d-766db511ad61.png). Another example below shows unnecessary cudaMemcpy's happening in Reshape and slows down the model. ![image](https://user-images.githubusercontent.com/3524474/190272555-2a10d020-5987-48ed-8a36-c0687f3af376.png)\r\n\r\nI've attached the result from the profiling. I have a hard time understanding it unfortunately.. (this is without the ORTModule btw)\r\n[nsys-profiling.zip](https://github.com/microsoft/onnxruntime/files/9599534/nsys-profiling.zip)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1251058614/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "thomas-beznik",
            "id": 53873742,
            "node_id": "MDQ6VXNlcjUzODczNzQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/53873742?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thomas-beznik",
            "html_url": "https://github.com/thomas-beznik",
            "followers_url": "https://api.github.com/users/thomas-beznik/followers",
            "following_url": "https://api.github.com/users/thomas-beznik/following{/other_user}",
            "gists_url": "https://api.github.com/users/thomas-beznik/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thomas-beznik/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thomas-beznik/subscriptions",
            "organizations_url": "https://api.github.com/users/thomas-beznik/orgs",
            "repos_url": "https://api.github.com/users/thomas-beznik/repos",
            "events_url": "https://api.github.com/users/thomas-beznik/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thomas-beznik/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1330442188",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1330442188",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1330442188,
        "node_id": "IC_kwDOCVq1mM5PTO_M",
        "user": {
            "login": "davidmezzetti",
            "id": 561939,
            "node_id": "MDQ6VXNlcjU2MTkzOQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/561939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidmezzetti",
            "html_url": "https://github.com/davidmezzetti",
            "followers_url": "https://api.github.com/users/davidmezzetti/followers",
            "following_url": "https://api.github.com/users/davidmezzetti/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidmezzetti/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidmezzetti/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidmezzetti/subscriptions",
            "organizations_url": "https://api.github.com/users/davidmezzetti/orgs",
            "repos_url": "https://api.github.com/users/davidmezzetti/repos",
            "events_url": "https://api.github.com/users/davidmezzetti/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidmezzetti/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-29T10:53:19Z",
        "updated_at": "2022-11-30T16:33:51Z",
        "author_association": "NONE",
        "body": "I ran into a similar issue where an ONNX model was much slower than it's PyTorch counterpart on the GPU. I tried all the suggestions here including io_binding but nothing worked.\r\n\r\nTo solve the issue, profiling was enabled via the following code:\r\n\r\n```python\r\nimport onnxruntime as ort\r\n\r\nopts = ort.SessionOptions()\r\nopts.enable_profiling = True\r\n\r\nsession = ort.InferenceSession(path, opts,\r\n  [\"CUDAExecutionProvider\", \"CPUExecutionProvider\"])\r\nsession.run(None, inputs)\r\n```\r\n\r\nOnce the program exited, a profiling JSON file was generated. I took a look at that to find the longest running nodes.\r\n\r\n```\r\njq . onnxruntime_profile.json | grep dur | cut -d \":\" -f2 | sort --numeric\r\n```\r\n\r\nSkipping nodes for the full model run and session initialization, I was seeing nodes like this: `feed_forward/w_1/Conv_kernel_time`.  Reading the [documentation](https://onnxruntime.ai/docs/execution-providers/CUDA-ExecutionProvider.html#configuration-options), the following setting stood out, `cudnn_conv_algo_search`. \r\n\r\nThe program was re-run with that setting changed (to either HEURISTIC or DEFAULT).\r\n\r\n```python\r\nimport onnxruntime as ort\r\n\r\nopts = ort.SessionOptions()\r\nopts.enable_profiling = True\r\n\r\nsession = ort.InferenceSession(path, opts, \r\n  [(\"CUDAExecutionProvider\", {\"cudnn_conv_algo_search\": \"DEFAULT\"}), \"CPUExecutionProvider\"])\r\nsession.run(None, inputs)\r\n```\r\n\r\n_This time the performance was equal to or even slightly better than the PyTorch model on the GPU._\r\n\r\nI'm not sure why ONNX defaults to an EXHAUSTIVE search. In reading similar [code in PyTorch](https://github.com/pytorch/pytorch/blob/master/aten/src/ATen/native/cudnn/Conv_v7.cpp#L270), it doesn't appear PyTorch does (looks like it defaults to what ONNX calls HEURISTIC) and that is the performance difference in my case.\r\n\r\nHope this helps anyone running into performance issues one way or another. Looking at the original post, there were a lot of Conv operations, so it's worth a try.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1330442188/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "davidmezzetti",
            "id": 561939,
            "node_id": "MDQ6VXNlcjU2MTkzOQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/561939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidmezzetti",
            "html_url": "https://github.com/davidmezzetti",
            "followers_url": "https://api.github.com/users/davidmezzetti/followers",
            "following_url": "https://api.github.com/users/davidmezzetti/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidmezzetti/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidmezzetti/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidmezzetti/subscriptions",
            "organizations_url": "https://api.github.com/users/davidmezzetti/orgs",
            "repos_url": "https://api.github.com/users/davidmezzetti/repos",
            "events_url": "https://api.github.com/users/davidmezzetti/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidmezzetti/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "actor": {
            "login": "davidmezzetti",
            "id": 561939,
            "node_id": "MDQ6VXNlcjU2MTkzOQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/561939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidmezzetti",
            "html_url": "https://github.com/davidmezzetti",
            "followers_url": "https://api.github.com/users/davidmezzetti/followers",
            "following_url": "https://api.github.com/users/davidmezzetti/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidmezzetti/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidmezzetti/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidmezzetti/subscriptions",
            "organizations_url": "https://api.github.com/users/davidmezzetti/orgs",
            "repos_url": "https://api.github.com/users/davidmezzetti/repos",
            "events_url": "https://api.github.com/users/davidmezzetti/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidmezzetti/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-29T10:54:10Z",
        "updated_at": "2022-11-29T10:54:10Z",
        "source": {
            "type": "issue",
            "issue": {
                "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303",
                "repository_url": "https://api.github.com/repos/microsoft/onnxruntime",
                "labels_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303/labels{/name}",
                "comments_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303/comments",
                "events_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303/events",
                "html_url": "https://github.com/microsoft/onnxruntime/issues/10303",
                "id": 1105503554,
                "node_id": "I_kwDOCVq1mM5B5KVC",
                "number": 10303,
                "title": "onnxruntime inference is around 5 times slower than pytorch when using GPU",
                "user": {
                    "login": "nssrivathsa",
                    "id": 97871027,
                    "node_id": "U_kgDOBdVksw",
                    "avatar_url": "https://avatars.githubusercontent.com/u/97871027?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/nssrivathsa",
                    "html_url": "https://github.com/nssrivathsa",
                    "followers_url": "https://api.github.com/users/nssrivathsa/followers",
                    "following_url": "https://api.github.com/users/nssrivathsa/following{/other_user}",
                    "gists_url": "https://api.github.com/users/nssrivathsa/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/nssrivathsa/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/nssrivathsa/subscriptions",
                    "organizations_url": "https://api.github.com/users/nssrivathsa/orgs",
                    "repos_url": "https://api.github.com/users/nssrivathsa/repos",
                    "events_url": "https://api.github.com/users/nssrivathsa/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/nssrivathsa/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 2014185961,
                        "node_id": "MDU6TGFiZWwyMDE0MTg1OTYx",
                        "url": "https://api.github.com/repos/microsoft/onnxruntime/labels/core%20runtime",
                        "name": "core runtime",
                        "color": "006B75",
                        "default": false,
                        "description": "issues related to core runtime"
                    },
                    {
                        "id": 2186357781,
                        "node_id": "MDU6TGFiZWwyMTg2MzU3Nzgx",
                        "url": "https://api.github.com/repos/microsoft/onnxruntime/labels/ep:CUDA",
                        "name": "ep:CUDA",
                        "color": "0052CC",
                        "default": false,
                        "description": "issues related to the CUDA execution provider"
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 21,
                "created_at": "2022-01-17T08:05:42Z",
                "updated_at": "2022-11-29T10:54:11Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "repository": {
                    "id": 156939672,
                    "node_id": "MDEwOlJlcG9zaXRvcnkxNTY5Mzk2NzI=",
                    "name": "onnxruntime",
                    "full_name": "microsoft/onnxruntime",
                    "private": false,
                    "owner": {
                        "login": "microsoft",
                        "id": 6154722,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjYxNTQ3MjI=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/6154722?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/microsoft",
                        "html_url": "https://github.com/microsoft",
                        "followers_url": "https://api.github.com/users/microsoft/followers",
                        "following_url": "https://api.github.com/users/microsoft/following{/other_user}",
                        "gists_url": "https://api.github.com/users/microsoft/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/microsoft/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/microsoft/subscriptions",
                        "organizations_url": "https://api.github.com/users/microsoft/orgs",
                        "repos_url": "https://api.github.com/users/microsoft/repos",
                        "events_url": "https://api.github.com/users/microsoft/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/microsoft/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "html_url": "https://github.com/microsoft/onnxruntime",
                    "description": "ONNX Runtime: cross-platform, high performance ML inferencing and training accelerator",
                    "fork": false,
                    "url": "https://api.github.com/repos/microsoft/onnxruntime",
                    "forks_url": "https://api.github.com/repos/microsoft/onnxruntime/forks",
                    "keys_url": "https://api.github.com/repos/microsoft/onnxruntime/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/microsoft/onnxruntime/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/microsoft/onnxruntime/teams",
                    "hooks_url": "https://api.github.com/repos/microsoft/onnxruntime/hooks",
                    "issue_events_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/microsoft/onnxruntime/events",
                    "assignees_url": "https://api.github.com/repos/microsoft/onnxruntime/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/microsoft/onnxruntime/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/microsoft/onnxruntime/tags",
                    "blobs_url": "https://api.github.com/repos/microsoft/onnxruntime/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/microsoft/onnxruntime/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/microsoft/onnxruntime/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/microsoft/onnxruntime/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/microsoft/onnxruntime/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/microsoft/onnxruntime/languages",
                    "stargazers_url": "https://api.github.com/repos/microsoft/onnxruntime/stargazers",
                    "contributors_url": "https://api.github.com/repos/microsoft/onnxruntime/contributors",
                    "subscribers_url": "https://api.github.com/repos/microsoft/onnxruntime/subscribers",
                    "subscription_url": "https://api.github.com/repos/microsoft/onnxruntime/subscription",
                    "commits_url": "https://api.github.com/repos/microsoft/onnxruntime/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/microsoft/onnxruntime/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/microsoft/onnxruntime/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/microsoft/onnxruntime/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/microsoft/onnxruntime/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/microsoft/onnxruntime/merges",
                    "archive_url": "https://api.github.com/repos/microsoft/onnxruntime/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/microsoft/onnxruntime/downloads",
                    "issues_url": "https://api.github.com/repos/microsoft/onnxruntime/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/microsoft/onnxruntime/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/microsoft/onnxruntime/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/microsoft/onnxruntime/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/microsoft/onnxruntime/labels{/name}",
                    "releases_url": "https://api.github.com/repos/microsoft/onnxruntime/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/microsoft/onnxruntime/deployments",
                    "created_at": "2018-11-10T02:22:53Z",
                    "updated_at": "2022-12-20T19:02:34Z",
                    "pushed_at": "2022-12-20T19:11:59Z",
                    "git_url": "git://github.com/microsoft/onnxruntime.git",
                    "ssh_url": "git@github.com:microsoft/onnxruntime.git",
                    "clone_url": "https://github.com/microsoft/onnxruntime.git",
                    "svn_url": "https://github.com/microsoft/onnxruntime",
                    "homepage": "https://www.onnxruntime.ai",
                    "size": 1018648,
                    "stargazers_count": 7949,
                    "watchers_count": 7949,
                    "language": "C++",
                    "has_issues": true,
                    "has_projects": true,
                    "has_downloads": true,
                    "has_wiki": true,
                    "has_pages": true,
                    "has_discussions": true,
                    "forks_count": 1862,
                    "mirror_url": null,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 1453,
                    "license": {
                        "key": "mit",
                        "name": "MIT License",
                        "spdx_id": "MIT",
                        "url": "https://api.github.com/licenses/mit",
                        "node_id": "MDc6TGljZW5zZTEz"
                    },
                    "allow_forking": true,
                    "is_template": false,
                    "web_commit_signoff_required": false,
                    "topics": [
                        "ai-framework",
                        "deep-learning",
                        "hacktoberfest",
                        "hardware-acceleration",
                        "machine-learning",
                        "neural-networks",
                        "onnx",
                        "pytorch",
                        "scikit-learn",
                        "tensorflow"
                    ],
                    "visibility": "public",
                    "forks": 1862,
                    "open_issues": 1453,
                    "watchers": 7949,
                    "default_branch": "main",
                    "permissions": {
                        "admin": false,
                        "maintain": true,
                        "push": true,
                        "triage": true,
                        "pull": true
                    }
                },
                "body": "**Describe the bug**\r\nInference time of onnxruntime is 5x times slower as compared to the pytorch model on GPU BUT 2.5x times faster on CPU\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- ONNX Runtime installed from (source or binary): Source \r\n- ONNX Runtime version: 1.11.0 (onnx version 1.10.1)\r\n- Python version: 3.8.12\r\n- CUDA/cuDNN version:  cuda version 11.5, cudnn version 8.2\r\n- GPU model and memory: Quadro M2000M, 4 GB\r\n\r\n**To Reproduce**\r\n```\r\nbatch_size = 1\r\ntotal_samples = 1000\r\ndevice = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')\r\n    \r\ndef convert_to_onnx(resnet):\r\n   resnet.eval()\r\n   dummy_input = (torch.randn(batch_size, 3, 224, 224, device=device)).to(device=device)\r\n   input_names = [ 'input' ]\r\n   output_names = [ 'output' ]\r\n   torch.onnx.export(resnet, \r\n               dummy_input,\r\n               \"resnet18.onnx\",\r\n               verbose=True,\r\n               opset_version=13,\r\n               input_names=input_names,\r\n               output_names=output_names,\r\n               export_params=True,\r\n               do_constant_folding=True,\r\n               dynamic_axes={\r\n                  'input': {0: 'batch_size'},  # variable length axes\r\n                  'output': {0: 'batch_size'}}        \r\n               )\r\n                  \r\ndef infer_pytorch(resnet):\r\n   print('Pytorch Inference')\r\n   print('==========================')\r\n   print()\r\n\r\n   x = torch.randn((batch_size, 3, 224, 224))\r\n   x = x.to(device=device)\r\n\r\n   latency = []\r\n   for i in range(total_samples):\r\n      t0 = time.time()\r\n      resnet.eval()\r\n      with torch.no_grad():\r\n         out = resnet(x)\r\n      latency.append(time.time() - t0)\r\n\r\n   print('Number of runs:', len(latency))\r\n   print(\"Average PyTorch {} Inference time = {} ms\".format(device.type, format(sum(latency) * 1000 / len(latency), '.2f')))  \r\n\r\ndef to_numpy(tensor):\r\n   return tensor.detach().cpu().numpy() if tensor.requires_grad else tensor.cpu().numpy()\r\n\r\ndef infer_onnxruntime():\r\n   print('Onnxruntime Inference')\r\n   print('==========================')\r\n   print()\r\n\r\n   onnx_model = onnx.load(\"resnet18.onnx\")\r\n   onnx.checker.check_model(onnx_model)\r\n\r\n   # Input\r\n   x = torch.randn((batch_size, 3, 224, 224))\r\n   x = x.to(device=device)\r\n   x = to_numpy(x)\r\n\r\n   so = onnxruntime.SessionOptions()\r\n   so.execution_mode = onnxruntime.ExecutionMode.ORT_SEQUENTIAL\r\n   so.graph_optimization_level = onnxruntime.GraphOptimizationLevel.ORT_ENABLE_ALL\r\n   \r\n   exproviders = ['CUDAExecutionProvider', 'CPUExecutionProvider']\r\n\r\n   model_onnx_path = os.path.join(\".\", \"resnet18.onnx\")\r\n   ort_session = onnxruntime.InferenceSession(model_onnx_path, so, providers=exproviders)\r\n\r\n   options = ort_session.get_provider_options()\r\n   cuda_options = options['CUDAExecutionProvider']\r\n   cuda_options['cudnn_conv_use_max_workspace'] = '1'\r\n   ort_session.set_providers(['CUDAExecutionProvider'], [cuda_options])\r\n\r\n   #IOBinding\r\n   input_names = ort_session.get_inputs()[0].name\r\n   output_names = ort_session.get_outputs()[0].name\r\n   io_binding = ort_session.io_binding()\r\n\r\n   io_binding.bind_cpu_input(input_names, x)\r\n   io_binding.bind_output(output_names, device)\r\n   \r\n   #warm up run\r\n   ort_session.run_with_iobinding(io_binding)\r\n   ort_outs = io_binding.copy_outputs_to_cpu()\r\n\r\n   latency = []\r\n\r\n   for i in range(total_samples):\r\n      t0 = time.time()\r\n      ort_session.run_with_iobinding(io_binding)\r\n      latency.append(time.time() - t0)\r\n      ort_outs = io_binding.copy_outputs_to_cpu()\r\n   print('Number of runs:', len(latency))\r\n   print(\"Average onnxruntime {} Inference time = {} ms\".format(device.type, format(sum(latency) * 1000 / len(latency), '.2f')))   \r\n\r\nif __name__ == '__main__':\r\n   torch.cuda.empty_cache()\r\n   resnet = (models.resnet18(pretrained=True)).to(device=device)\r\n   convert_to_onnx(resnet)\r\n   infer_onnxruntime()\r\n   infer_pytorch(resnet)\r\n```\r\n\r\n**Current behavior**\r\n\r\nIf run on CPU, \r\n```\r\nAverage onnxruntime cpu Inference time = 18.48 ms\r\nAverage PyTorch cpu Inference time = 51.74 ms\r\n```\r\nbut, if run on GPU, I see\r\n```\r\nAverage onnxruntime cuda Inference time = 47.89 ms\r\nAverage PyTorch cuda Inference time = 8.94 ms\r\n```\r\n\r\nIf I change graph optimizations to onnxruntime.GraphOptimizationLevel.ORT_DISABLE_ALL, I see some improvements in inference time on GPU, but its still slower than Pytorch.\r\n\r\nI had read about similar issues here and ensured that i do the io binding so that the inputs are on GPU.\r\nWhen converting the resnet to onnx, I see traces like\r\n`%193 : Float(64, 3, 7, 7, strides=[147, 49, 7, 1], requires_grad=0, device=cuda:0),` \r\nso, the nodes of the model are on GPU.\r\n\r\nFurther, during the processing for onnxruntime, I print device usage stats and I see this - \r\n```\r\nUsing device: cuda:0\r\nGPU Device name: Quadro M2000M\r\nMemory Usage:\r\nAllocated: 0.1 GB\r\nCached:    0.1 GB\r\n```\r\nSo, GPU device is being used.\r\nFurther, I have used the resnet18.onnx model from the ModelZoo to see if it is a converted mode issue, but i get the same results.\r\n\r\nSo, I cannot seem to figure this out any further and I am stuck here since quite a few days.\r\nCould somebody please point out to what could be the issue here?\r\n\r\nThanks\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10303/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            }
        },
        "event": "cross-referenced"
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1336057781",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12880#issuecomment-1336057781",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12880",
        "id": 1336057781,
        "node_id": "IC_kwDOCVq1mM5Pop-1",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-03T04:54:41Z",
        "updated_at": "2022-12-03T04:54:41Z",
        "author_association": "MEMBER",
        "body": "For UNet (diffusion) model, try the following setting for best performance:\r\n```\r\nproviders=[ ( \"CUDAExecutionProvider\", {\"cudnn_conv_use_max_workspace\": \"1\", \"cudnn_conv_algo_search\": \"EXHAUSTIVE\"}),        \"CPUExecutionProvider\"]\r\n```\r\n\r\n@davidmezzetti, cuDNN convolution algo search only happens once. Even though it is slow in first inference run, the following run might be faster. You can use some warm up queries before serving user queries.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1336057781/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7945343730,
        "node_id": "MEE_lADOCVq1mM5RXPxdzwAAAAHZlFLy",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7945343730",
        "actor": {
            "login": "davidmezzetti",
            "id": 561939,
            "node_id": "MDQ6VXNlcjU2MTkzOQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/561939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidmezzetti",
            "html_url": "https://github.com/davidmezzetti",
            "followers_url": "https://api.github.com/users/davidmezzetti/followers",
            "following_url": "https://api.github.com/users/davidmezzetti/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidmezzetti/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidmezzetti/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidmezzetti/subscriptions",
            "organizations_url": "https://api.github.com/users/davidmezzetti/orgs",
            "repos_url": "https://api.github.com/users/davidmezzetti/repos",
            "events_url": "https://api.github.com/users/davidmezzetti/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidmezzetti/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-12-03T04:54:41Z",
        "performed_via_github_app": null
    },
    {
        "id": 7945343733,
        "node_id": "SE_lADOCVq1mM5RXPxdzwAAAAHZlFL1",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7945343733",
        "actor": {
            "login": "davidmezzetti",
            "id": 561939,
            "node_id": "MDQ6VXNlcjU2MTkzOQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/561939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidmezzetti",
            "html_url": "https://github.com/davidmezzetti",
            "followers_url": "https://api.github.com/users/davidmezzetti/followers",
            "following_url": "https://api.github.com/users/davidmezzetti/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidmezzetti/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidmezzetti/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidmezzetti/subscriptions",
            "organizations_url": "https://api.github.com/users/davidmezzetti/orgs",
            "repos_url": "https://api.github.com/users/davidmezzetti/repos",
            "events_url": "https://api.github.com/users/davidmezzetti/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidmezzetti/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-12-03T04:54:41Z",
        "performed_via_github_app": null
    }
]