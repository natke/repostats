[
    {
        "id": 8002052130,
        "node_id": "MEE_lADOCVq1mM5YqNybzwAAAAHc9aAi",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/8002052130",
        "actor": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-12-09T21:11:57Z",
        "performed_via_github_app": null
    },
    {
        "id": 8002052138,
        "node_id": "SE_lADOCVq1mM5YqNybzwAAAAHc9aAq",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/8002052138",
        "actor": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-12-09T21:11:57Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344792863",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13920#issuecomment-1344792863",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13920",
        "id": 1344792863,
        "node_id": "IC_kwDOCVq1mM5QJ-kf",
        "user": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-09T21:19:36Z",
        "updated_at": "2022-12-09T21:19:36Z",
        "author_association": "MEMBER",
        "body": "The support matrix shows an export error, whereas we are seeing a runtime error here, so the errors detected there may be different than yours:\r\n\r\n![image](https://user-images.githubusercontent.com/11205048/206797553-877099a5-143e-46b6-9436-ecb3f07e919d.png)\r\n\r\nIt is still possible that the exported model is incorrect. Could you also share the exported onnx model here?\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344792863/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344799872",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13920#issuecomment-1344799872",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13920",
        "id": 1344799872,
        "node_id": "IC_kwDOCVq1mM5QKASA",
        "user": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-09T21:29:01Z",
        "updated_at": "2022-12-09T21:37:16Z",
        "author_association": "CONTRIBUTOR",
        "body": "Oh did not know we could click on there. Awesome!\r\n\r\nYes, you can find the model exported as in my original post [here](https://huggingface.co/fxmarty/broken-onnx-as-strided/blob/main/asstrided_model.onnx) and a preview in netron [here](https://netron.app/?url=https://huggingface.co/fxmarty/broken-onnx-as-strided/blob/main/asstrided_model.onnx).\r\n\r\nI suspect that the `strides_original = x.stride()` is not raising an error while maybe it should. Trying to put dynamic stride by using the shape values (`a, b, c`), or e.g. `x[0][0][0]` (see the updated comment in the original model for an example), then `torch.onnx.export` rightfully raises:\r\n\r\n```\r\ntorch.onnx.errors.SymbolicValueError: Failed to export a node '%17 : Long(requires_grad=0, device=cpu) = onnx::Gather[axis=0](%16, %1), scope: __main__.MyModel3:: # /home/fxmarty/test_torchsript.py:48:0\r\n' (in list node %21 : int[] = prim::ListConstruct(%17, %18, %20), scope: __main__.MyModel3::\r\n) because it is not constant. Please try to make things (e.g. kernel sizes) static if possible.  [Caused by the value '21 defined in (%21 : int[] = prim::ListConstruct(%17, %18, %20), scope: __main__.MyModel3::\r\n)' (type 'List[int]') in the TorchScript graph. The containing node has kind 'prim::ListConstruct'.] \r\n```\r\n\r\nEdit: oh, yes, it seems the graph is wrong. There are hard-coded values in `Mul` coming from the example given in `torch.onnx.export`. Should I rather open an issue under pytorch? I think this is somewhat very minor so maybe not worth it. Did still spend a quite long time debugging this on a large model!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344799872/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "actor": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-09T21:41:39Z",
        "updated_at": "2022-12-09T21:41:39Z",
        "source": {
            "type": "issue",
            "issue": {
                "url": "https://api.github.com/repos/huggingface/optimum/issues/505",
                "repository_url": "https://api.github.com/repos/huggingface/optimum",
                "labels_url": "https://api.github.com/repos/huggingface/optimum/issues/505/labels{/name}",
                "comments_url": "https://api.github.com/repos/huggingface/optimum/issues/505/comments",
                "events_url": "https://api.github.com/repos/huggingface/optimum/issues/505/events",
                "html_url": "https://github.com/huggingface/optimum/issues/505",
                "id": 1460481056,
                "node_id": "I_kwDOFx0ogc5XDSwg",
                "number": 505,
                "title": "ONNX Conversion for LongFormer predictions different",
                "user": {
                    "login": "adithya1111",
                    "id": 9430155,
                    "node_id": "MDQ6VXNlcjk0MzAxNTU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9430155?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/adithya1111",
                    "html_url": "https://github.com/adithya1111",
                    "followers_url": "https://api.github.com/users/adithya1111/followers",
                    "following_url": "https://api.github.com/users/adithya1111/following{/other_user}",
                    "gists_url": "https://api.github.com/users/adithya1111/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/adithya1111/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/adithya1111/subscriptions",
                    "organizations_url": "https://api.github.com/users/adithya1111/orgs",
                    "repos_url": "https://api.github.com/users/adithya1111/repos",
                    "events_url": "https://api.github.com/users/adithya1111/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/adithya1111/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 3184751869,
                        "node_id": "MDU6TGFiZWwzMTg0NzUxODY5",
                        "url": "https://api.github.com/repos/huggingface/optimum/labels/bug",
                        "name": "bug",
                        "color": "d73a4a",
                        "default": true,
                        "description": "Something isn't working"
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": {
                    "login": "fxmarty",
                    "id": 9808326,
                    "node_id": "MDQ6VXNlcjk4MDgzMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/fxmarty",
                    "html_url": "https://github.com/fxmarty",
                    "followers_url": "https://api.github.com/users/fxmarty/followers",
                    "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
                    "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
                    "organizations_url": "https://api.github.com/users/fxmarty/orgs",
                    "repos_url": "https://api.github.com/users/fxmarty/repos",
                    "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/fxmarty/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "fxmarty",
                        "id": 9808326,
                        "node_id": "MDQ6VXNlcjk4MDgzMjY=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/fxmarty",
                        "html_url": "https://github.com/fxmarty",
                        "followers_url": "https://api.github.com/users/fxmarty/followers",
                        "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
                        "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
                        "organizations_url": "https://api.github.com/users/fxmarty/orgs",
                        "repos_url": "https://api.github.com/users/fxmarty/repos",
                        "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/fxmarty/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 9,
                "created_at": "2022-11-22T20:03:41Z",
                "updated_at": "2022-12-12T11:16:23Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "repository": {
                    "id": 387786881,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzODc3ODY4ODE=",
                    "name": "optimum",
                    "full_name": "huggingface/optimum",
                    "private": false,
                    "owner": {
                        "login": "huggingface",
                        "id": 25720743,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjI1NzIwNzQz",
                        "avatar_url": "https://avatars.githubusercontent.com/u/25720743?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/huggingface",
                        "html_url": "https://github.com/huggingface",
                        "followers_url": "https://api.github.com/users/huggingface/followers",
                        "following_url": "https://api.github.com/users/huggingface/following{/other_user}",
                        "gists_url": "https://api.github.com/users/huggingface/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/huggingface/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/huggingface/subscriptions",
                        "organizations_url": "https://api.github.com/users/huggingface/orgs",
                        "repos_url": "https://api.github.com/users/huggingface/repos",
                        "events_url": "https://api.github.com/users/huggingface/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/huggingface/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "html_url": "https://github.com/huggingface/optimum",
                    "description": "🏎️ Accelerate training and inference of 🤗 Transformers with easy to use hardware optimization tools",
                    "fork": false,
                    "url": "https://api.github.com/repos/huggingface/optimum",
                    "forks_url": "https://api.github.com/repos/huggingface/optimum/forks",
                    "keys_url": "https://api.github.com/repos/huggingface/optimum/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/huggingface/optimum/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/huggingface/optimum/teams",
                    "hooks_url": "https://api.github.com/repos/huggingface/optimum/hooks",
                    "issue_events_url": "https://api.github.com/repos/huggingface/optimum/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/huggingface/optimum/events",
                    "assignees_url": "https://api.github.com/repos/huggingface/optimum/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/huggingface/optimum/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/huggingface/optimum/tags",
                    "blobs_url": "https://api.github.com/repos/huggingface/optimum/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/huggingface/optimum/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/huggingface/optimum/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/huggingface/optimum/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/huggingface/optimum/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/huggingface/optimum/languages",
                    "stargazers_url": "https://api.github.com/repos/huggingface/optimum/stargazers",
                    "contributors_url": "https://api.github.com/repos/huggingface/optimum/contributors",
                    "subscribers_url": "https://api.github.com/repos/huggingface/optimum/subscribers",
                    "subscription_url": "https://api.github.com/repos/huggingface/optimum/subscription",
                    "commits_url": "https://api.github.com/repos/huggingface/optimum/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/huggingface/optimum/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/huggingface/optimum/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/huggingface/optimum/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/huggingface/optimum/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/huggingface/optimum/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/huggingface/optimum/merges",
                    "archive_url": "https://api.github.com/repos/huggingface/optimum/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/huggingface/optimum/downloads",
                    "issues_url": "https://api.github.com/repos/huggingface/optimum/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/huggingface/optimum/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/huggingface/optimum/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/huggingface/optimum/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/huggingface/optimum/labels{/name}",
                    "releases_url": "https://api.github.com/repos/huggingface/optimum/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/huggingface/optimum/deployments",
                    "created_at": "2021-07-20T12:36:40Z",
                    "updated_at": "2022-12-20T17:43:08Z",
                    "pushed_at": "2022-12-20T17:37:52Z",
                    "git_url": "git://github.com/huggingface/optimum.git",
                    "ssh_url": "git@github.com:huggingface/optimum.git",
                    "clone_url": "https://github.com/huggingface/optimum.git",
                    "svn_url": "https://github.com/huggingface/optimum",
                    "homepage": "https://huggingface.co/docs/optimum/",
                    "size": 2376,
                    "stargazers_count": 831,
                    "watchers_count": 831,
                    "language": "Python",
                    "has_issues": true,
                    "has_projects": true,
                    "has_downloads": true,
                    "has_wiki": true,
                    "has_pages": false,
                    "has_discussions": false,
                    "forks_count": 105,
                    "mirror_url": null,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 93,
                    "license": {
                        "key": "apache-2.0",
                        "name": "Apache License 2.0",
                        "spdx_id": "Apache-2.0",
                        "url": "https://api.github.com/licenses/apache-2.0",
                        "node_id": "MDc6TGljZW5zZTI="
                    },
                    "allow_forking": true,
                    "is_template": false,
                    "web_commit_signoff_required": false,
                    "topics": [
                        "graphcore",
                        "habana",
                        "inference",
                        "intel",
                        "onnx",
                        "onnxruntime",
                        "optimization",
                        "pytorch",
                        "quantization",
                        "training",
                        "transformers"
                    ],
                    "visibility": "public",
                    "forks": 105,
                    "open_issues": 93,
                    "watchers": 831,
                    "default_branch": "main",
                    "permissions": {
                        "admin": false,
                        "maintain": false,
                        "push": false,
                        "triage": false,
                        "pull": true
                    }
                },
                "body": "### System Info\n\n```shell\nPython 3.9.12\r\nOS : MacOS\r\nOptimum Version: 1.5.0\n```\n\n\n### Who can help?\n\n@JingyaHuang @lewtun @fxmarty @ydshieh : Hello guys. I have a longformer model finetuned on my dataset. I have the model exported to ONNX using Optimum. When I am trying to make predictions with the ONNX model, the results dont match with the original model's predictions. PFB the details. The final parts contain the original and ONNX model predictions and they are some what closer in some cases. But they seem to be off. So wanted to check if this is because of the global attention mask values I am passing. The model was trained using the default hyper parameters\r\n```\r\n{\r\n  \"_name_or_path\": \"/opt/ml/input/data/model-base\",\r\n  \"architectures\": [\r\n    \"LongformerForTokenClassification\"\r\n  ],\r\n  \"attention_mode\": \"longformer\",\r\n  \"attention_probs_dropout_prob\": 0.1,\r\n  \"attention_window\": [\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512,\r\n    512\r\n  ],\r\n  \"bos_token_id\": 0,\r\n  \"eos_token_id\": 2,\r\n  \"gradient_checkpointing\": false,\r\n  \"hidden_act\": \"gelu\",\r\n  \"hidden_dropout_prob\": 0.1,\r\n  \"hidden_size\": 768,\r\n  \"id2label\": {\r\n    \"0\": \"LABEL_0\",\r\n    \"1\": \"LABEL_1\",\r\n    \"2\": \"LABEL_2\",\r\n    \"3\": \"LABEL_3\"\r\n  },\r\n  \"ignore_attention_mask\": false,\r\n  \"initializer_range\": 0.02,\r\n  \"intermediate_size\": 3072,\r\n  \"label2id\": {\r\n    \"LABEL_0\": 0,\r\n    \"LABEL_1\": 1,\r\n    \"LABEL_2\": 2,\r\n    \"LABEL_3\": 3\r\n  },\r\n  \"layer_norm_eps\": 1e-05,\r\n  \"max_position_embeddings\": 4098,\r\n  \"model_type\": \"longformer\",\r\n  \"num_attention_heads\": 12,\r\n  \"num_hidden_layers\": 12,\r\n  \"pad_token_id\": 1,\r\n  \"position_embedding_type\": \"absolute\",\r\n  \"sep_token_id\": 2,\r\n  \"torch_dtype\": \"float32\",\r\n  \"transformers_version\": \"4.9.1\",\r\n  \"type_vocab_size\": 1,\r\n  \"use_cache\": true,\r\n  \"vocab_size\": 50265\r\n}\r\n```\r\n\r\nExport code to ONNX : \r\n\r\n```\r\nfrom optimum.onnxruntime import ORTModelForTokenClassification\r\nimport onnxruntime as ort\r\nonnx_model = ORTModelForTokenClassification.from_pretrained(original_model_dir, from_transformers=True)\r\nonnx_path = Path(\"onnx-longformer-model-optimum\")\r\nonnx_model.save_pretrained(onnx_path)\r\n```\r\n\r\n\r\nOriginal model predictions code : \r\n```\r\nocr_text = 'test 123'\r\ntokenized_values = tokenizer(ocr_text, max_length=int(model_config.max_position_embeddings - 2),\r\n                          truncation=True, return_tensors='pt')\r\n\r\npredictions = original_model(tokenized_values[\"input_ids\"])\r\n```\r\n\r\nONNX inference code:\r\n\r\n```\r\nimport onnxruntime as ort\r\nsession = ort.InferenceSession(\"/Users/i849730/Desktop/onnx-testing/onnx-longformer-model-optimum/model.onnx\", providers=[\"CPUExecutionProvider\"])\r\nimport onnxruntime as ort\r\nocr_text = 'test 123'\r\ntokenized_values = tokenizer(ocr_text, max_length=int(model_config.max_position_embeddings - 2),\r\n                          truncation=True, return_tensors='pt')\r\n\r\npredictions = longformer_model(tokenized_values[\"input_ids\"])\r\n\r\nsession = ort.InferenceSession(\"/home/ec2-user/SageMaker/invoice-docsep/onnx-conversion-optimum/model.onnx\", providers=[\"CPUExecutionProvider\"])\r\n\r\n#input_ids = torch.randint(tokenizer.vocab_size, (batch_size, seq_len))\r\ninput_ids = tokenized_values[\"input_ids\"]\r\n#attention_mask = torch.ones((batch_size, seq_len), dtype=torch.int64)\r\nattention_mask = tokenized_values['attention_mask']\r\n\r\nglobal_attention_mask = torch.zeros_like(input_ids)\r\n# make every second token global\r\n#global_attention_mask[:, 0] = 1\r\nglobal_attention_mask[:, ::2] = 1\r\nglobal_attention_mask = global_attention_mask.cpu().detach().numpy()\r\n\r\nonnx_inputs = {\r\n    \"input_ids\": input_ids.cpu().detach().numpy(),\r\n    \"attention_mask\": attention_mask.cpu().detach().numpy(),\r\n    \"global_attention_mask\" : global_attention_mask\r\n\r\n}\r\n\r\nres = session.run(None, onnx_inputs)\r\n```\r\n\r\nOriginal model predictions : \r\n```\r\nLongformerTokenClassifierOutput(loss=None, logits=tensor([[[ 0.6209,  0.0719,  0.1107, -0.5316],\r\n         [ 3.0321, -0.2787, -0.6460, -2.5359],\r\n         [ 2.6904,  0.1169, -0.7495, -2.8346],\r\n         [ 0.6474,  0.0761,  0.1041, -0.5438]]], grad_fn=<AddBackward0>), hidden_states=None, attentions=None, global_attentions=None)\r\n```\r\n\r\nONNX model predictions: \r\n```\r\n[array([[[ 0.49600145,  0.08062335,  0.12902021, -0.4010917 ],\r\n         [ 3.0400352 , -0.34643874, -0.6276542 , -2.444679  ],\r\n         [ 2.158992  ,  0.02124629, -0.5462518 , -2.094074  ],\r\n         [ 0.6290194 ,  0.06919068,  0.10753635, -0.5197539 ]]],\r\n       dtype=float32)]\r\n```\n\n### Information\n\n- [ ] The official example scripts\n- [X] My own modified scripts\n\n### Tasks\n\n- [ ] An officially supported task in the `examples` folder (such as GLUE/SQuAD, ...)\n- [X] My own task or dataset (give details below)\n\n### Reproduction\n\nCode snippets shared above\n\n### Expected behavior\n\nThe expected behavior is the outputs from ONNX model and original model should match. Here it is somewhat close. But still the results seem to be off ",
                "reactions": {
                    "url": "https://api.github.com/repos/huggingface/optimum/issues/505/reactions",
                    "total_count": 1,
                    "+1": 1,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/huggingface/optimum/issues/505/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            }
        },
        "event": "cross-referenced"
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344853984",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13920#issuecomment-1344853984",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13920",
        "id": 1344853984,
        "node_id": "IC_kwDOCVq1mM5QKNfg",
        "user": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-09T22:37:04Z",
        "updated_at": "2022-12-09T22:37:04Z",
        "author_association": "MEMBER",
        "body": "Yes, please open an issue on torch and mention me. Thanks for doing the hard work to isolate the issue!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1344853984/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "justinchuby",
            "id": 11205048,
            "node_id": "MDQ6VXNlcjExMjA1MDQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/justinchuby",
            "html_url": "https://github.com/justinchuby",
            "followers_url": "https://api.github.com/users/justinchuby/followers",
            "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
            "organizations_url": "https://api.github.com/users/justinchuby/orgs",
            "repos_url": "https://api.github.com/users/justinchuby/repos",
            "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/justinchuby/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1345193216",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13920#issuecomment-1345193216",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13920",
        "id": 1345193216,
        "node_id": "IC_kwDOCVq1mM5QLgUA",
        "user": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-10T09:16:07Z",
        "updated_at": "2022-12-10T09:16:07Z",
        "author_association": "CONTRIBUTOR",
        "body": "Great thanks!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1345193216/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 8004150160,
        "node_id": "CE_lADOCVq1mM5YqNybzwAAAAHdFaOQ",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/8004150160",
        "actor": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "closed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-12-10T09:16:07Z",
        "state_reason": null,
        "performed_via_github_app": null
    },
    {
        "actor": {
            "login": "fxmarty",
            "id": 9808326,
            "node_id": "MDQ6VXNlcjk4MDgzMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fxmarty",
            "html_url": "https://github.com/fxmarty",
            "followers_url": "https://api.github.com/users/fxmarty/followers",
            "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
            "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
            "organizations_url": "https://api.github.com/users/fxmarty/orgs",
            "repos_url": "https://api.github.com/users/fxmarty/repos",
            "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fxmarty/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-10T09:31:23Z",
        "updated_at": "2022-12-10T09:31:23Z",
        "source": {
            "type": "issue",
            "issue": {
                "url": "https://api.github.com/repos/pytorch/pytorch/issues/90607",
                "repository_url": "https://api.github.com/repos/pytorch/pytorch",
                "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/90607/labels{/name}",
                "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/90607/comments",
                "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/90607/events",
                "html_url": "https://github.com/pytorch/pytorch/issues/90607",
                "id": 1488280856,
                "node_id": "I_kwDOA-j9z85YtV0Y",
                "number": 90607,
                "title": "Export to ONNX of `as_strided()` hard codes stride in the graph, although it should be dynamic",
                "user": {
                    "login": "fxmarty",
                    "id": 9808326,
                    "node_id": "MDQ6VXNlcjk4MDgzMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9808326?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/fxmarty",
                    "html_url": "https://github.com/fxmarty",
                    "followers_url": "https://api.github.com/users/fxmarty/followers",
                    "following_url": "https://api.github.com/users/fxmarty/following{/other_user}",
                    "gists_url": "https://api.github.com/users/fxmarty/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/fxmarty/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/fxmarty/subscriptions",
                    "organizations_url": "https://api.github.com/users/fxmarty/orgs",
                    "repos_url": "https://api.github.com/users/fxmarty/repos",
                    "events_url": "https://api.github.com/users/fxmarty/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/fxmarty/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 693805995,
                        "node_id": "MDU6TGFiZWw2OTM4MDU5OTU=",
                        "url": "https://api.github.com/repos/pytorch/pytorch/labels/module:%20onnx",
                        "name": "module: onnx",
                        "color": "f7e101",
                        "default": false,
                        "description": "Related to torch.onnx"
                    },
                    {
                        "id": 1301347167,
                        "node_id": "MDU6TGFiZWwxMzAxMzQ3MTY3",
                        "url": "https://api.github.com/repos/pytorch/pytorch/labels/triaged",
                        "name": "triaged",
                        "color": "006b75",
                        "default": false,
                        "description": "This issue has been looked at a team member, and triaged and prioritized into an appropriate module"
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": {
                    "login": "justinchuby",
                    "id": 11205048,
                    "node_id": "MDQ6VXNlcjExMjA1MDQ4",
                    "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/justinchuby",
                    "html_url": "https://github.com/justinchuby",
                    "followers_url": "https://api.github.com/users/justinchuby/followers",
                    "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
                    "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
                    "organizations_url": "https://api.github.com/users/justinchuby/orgs",
                    "repos_url": "https://api.github.com/users/justinchuby/repos",
                    "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/justinchuby/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "justinchuby",
                        "id": 11205048,
                        "node_id": "MDQ6VXNlcjExMjA1MDQ4",
                        "avatar_url": "https://avatars.githubusercontent.com/u/11205048?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/justinchuby",
                        "html_url": "https://github.com/justinchuby",
                        "followers_url": "https://api.github.com/users/justinchuby/followers",
                        "following_url": "https://api.github.com/users/justinchuby/following{/other_user}",
                        "gists_url": "https://api.github.com/users/justinchuby/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/justinchuby/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/justinchuby/subscriptions",
                        "organizations_url": "https://api.github.com/users/justinchuby/orgs",
                        "repos_url": "https://api.github.com/users/justinchuby/repos",
                        "events_url": "https://api.github.com/users/justinchuby/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/justinchuby/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 0,
                "created_at": "2022-12-10T09:31:23Z",
                "updated_at": "2022-12-12T14:53:22Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "repository": {
                    "id": 65600975,
                    "node_id": "MDEwOlJlcG9zaXRvcnk2NTYwMDk3NQ==",
                    "name": "pytorch",
                    "full_name": "pytorch/pytorch",
                    "private": false,
                    "owner": {
                        "login": "pytorch",
                        "id": 21003710,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw",
                        "avatar_url": "https://avatars.githubusercontent.com/u/21003710?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/pytorch",
                        "html_url": "https://github.com/pytorch",
                        "followers_url": "https://api.github.com/users/pytorch/followers",
                        "following_url": "https://api.github.com/users/pytorch/following{/other_user}",
                        "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions",
                        "organizations_url": "https://api.github.com/users/pytorch/orgs",
                        "repos_url": "https://api.github.com/users/pytorch/repos",
                        "events_url": "https://api.github.com/users/pytorch/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/pytorch/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "html_url": "https://github.com/pytorch/pytorch",
                    "description": "Tensors and Dynamic neural networks in Python with strong GPU acceleration",
                    "fork": false,
                    "url": "https://api.github.com/repos/pytorch/pytorch",
                    "forks_url": "https://api.github.com/repos/pytorch/pytorch/forks",
                    "keys_url": "https://api.github.com/repos/pytorch/pytorch/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/pytorch/pytorch/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/pytorch/pytorch/teams",
                    "hooks_url": "https://api.github.com/repos/pytorch/pytorch/hooks",
                    "issue_events_url": "https://api.github.com/repos/pytorch/pytorch/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/pytorch/pytorch/events",
                    "assignees_url": "https://api.github.com/repos/pytorch/pytorch/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/pytorch/pytorch/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/pytorch/pytorch/tags",
                    "blobs_url": "https://api.github.com/repos/pytorch/pytorch/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/pytorch/pytorch/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/pytorch/pytorch/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/pytorch/pytorch/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/pytorch/pytorch/languages",
                    "stargazers_url": "https://api.github.com/repos/pytorch/pytorch/stargazers",
                    "contributors_url": "https://api.github.com/repos/pytorch/pytorch/contributors",
                    "subscribers_url": "https://api.github.com/repos/pytorch/pytorch/subscribers",
                    "subscription_url": "https://api.github.com/repos/pytorch/pytorch/subscription",
                    "commits_url": "https://api.github.com/repos/pytorch/pytorch/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/pytorch/pytorch/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/pytorch/pytorch/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/pytorch/pytorch/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/pytorch/pytorch/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/pytorch/pytorch/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/pytorch/pytorch/merges",
                    "archive_url": "https://api.github.com/repos/pytorch/pytorch/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/pytorch/pytorch/downloads",
                    "issues_url": "https://api.github.com/repos/pytorch/pytorch/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/pytorch/pytorch/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/pytorch/pytorch/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/pytorch/pytorch/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/pytorch/pytorch/labels{/name}",
                    "releases_url": "https://api.github.com/repos/pytorch/pytorch/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/pytorch/pytorch/deployments",
                    "created_at": "2016-08-13T05:26:41Z",
                    "updated_at": "2022-12-20T19:01:41Z",
                    "pushed_at": "2022-12-20T19:13:23Z",
                    "git_url": "git://github.com/pytorch/pytorch.git",
                    "ssh_url": "git@github.com:pytorch/pytorch.git",
                    "clone_url": "https://github.com/pytorch/pytorch.git",
                    "svn_url": "https://github.com/pytorch/pytorch",
                    "homepage": "https://pytorch.org",
                    "size": 1039086,
                    "stargazers_count": 61103,
                    "watchers_count": 61103,
                    "language": "C++",
                    "has_issues": true,
                    "has_projects": true,
                    "has_downloads": true,
                    "has_wiki": true,
                    "has_pages": false,
                    "has_discussions": false,
                    "forks_count": 17020,
                    "mirror_url": null,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 10669,
                    "license": {
                        "key": "other",
                        "name": "Other",
                        "spdx_id": "NOASSERTION",
                        "url": null,
                        "node_id": "MDc6TGljZW5zZTA="
                    },
                    "allow_forking": true,
                    "is_template": false,
                    "web_commit_signoff_required": false,
                    "topics": [
                        "autograd",
                        "deep-learning",
                        "gpu",
                        "machine-learning",
                        "neural-network",
                        "numpy",
                        "python",
                        "tensor"
                    ],
                    "visibility": "public",
                    "forks": 17020,
                    "open_issues": 10669,
                    "watchers": 61103,
                    "default_branch": "master",
                    "permissions": {
                        "admin": false,
                        "maintain": false,
                        "push": false,
                        "triage": false,
                        "pull": true
                    }
                },
                "body": "### 🐛 Describe the bug\n\nExporting  to ONNX a very simple PyTorch model with a `tensor.as_strided()` operation, no warning or error is raised during the export, but the exported ONNX model is wrong.\r\n\r\nI suspect the issue is related to a limited dynamic shape/stride support, either in `as_strided` or in `tensor.stride()`.\r\n\r\n### To reproduce\r\n\r\nDefine the model:\r\n\r\n```python\r\nimport torch\r\nimport torch.nn as nn\r\n\r\nclass MyModel3(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n\r\n    def forward(self, x: torch.Tensor):\r\n        a, b, c = x.size()\r\n\r\n        strides_original = x.stride()\r\n\r\n        shape = (a, b // 2, 4)\r\n        stride = (strides_original[0] // 2, strides_original[1] - 3, 3)\r\n        \r\n        # stride = (x[0][0][0], 4, 3)  <-- if used instead, this will raise an error\r\n\r\n        x_strided = x.as_strided(size=shape, stride=stride)\r\n\r\n        return x_strided\r\n```\r\n\r\nExport to ONNX:\r\n```python\r\nmodel = MyModel3()\r\nx = torch.randint(8, (50, 30, 15)) + 1\r\nres = model(x)\r\nprint(res)\r\n\r\ntorch.onnx.export(\r\n    model,\r\n    (x,),\r\n    \"/home/fxmarty/asstrided_model.onnx\",\r\n    input_names=[\"x\"],\r\n    output_names=[\"x_out\"],\r\n    dynamic_axes={\"x\":  {0: \"axis0\", 1: \"axis1\", 2: \"axis2\"}},\r\n    opset_version=14\r\n)\r\n```\r\n\r\nThe issue remains with opset 15, 16, 17.\r\n\r\n**No warning or error is shown during the export**.\r\n\r\nThe exported model can be found [here](https://huggingface.co/fxmarty/broken-onnx-as-strided/blob/main/asstrided_model.onnx) and a preview in netron [here](https://netron.app/?url=https://huggingface.co/fxmarty/broken-onnx-as-strided/blob/main/asstrided_model.onnx).\r\n\r\nTrying to put dynamic stride by using the shape values (`a, b, c`), or e.g. `x[0][0][0]` (see the comment in the original model for an example), then `torch.onnx.export` rightfully raises:\r\n\r\n```\r\ntorch.onnx.errors.SymbolicValueError: Failed to export a node '%17 : Long(requires_grad=0, device=cpu) = onnx::Gather[axis=0](%16, %1), scope: __main__.MyModel3:: # /home/fxmarty/test_torchsript.py:48:0\r\n' (in list node %21 : int[] = prim::ListConstruct(%17, %18, %20), scope: __main__.MyModel3::\r\n) because it is not constant. Please try to make things (e.g. kernel sizes) static if possible.  [Caused by the value '21 defined in (%21 : int[] = prim::ListConstruct(%17, %18, %20), scope: __main__.MyModel3::\r\n)' (type 'List[int]') in the TorchScript graph. The containing node has kind 'prim::ListConstruct'.] \r\n```\r\n\r\nYou can as well compare the results of ORT and PyTorch following the code in https://github.com/microsoft/onnxruntime/issues/13920 .\r\n\r\nThank you, pinging @justinchuby as requested!\n\n### Versions\n\nPyTorch version: 1.13.0+cu117\r\nIs debug build: False\r\nCUDA used to build PyTorch: 11.7\r\nROCM used to build PyTorch: N/A\r\n\r\nOS: Ubuntu 22.04.1 LTS (x86_64)\r\nGCC version: (Ubuntu 11.3.0-1ubuntu1~[22.04) 11.3.0](callto:22.04) 11.3.0)\r\nClang version: Could not collect\r\nCMake version: version 3.22.1\r\nLibc version: glibc-2.35\r\n\r\nPython version: 3.9.12 (main, Apr  5 2022, 06:56:58)  [GCC 7.5.0] (64-bit runtime)\r\nPython platform: Linux-5.15.0-56-generic-x86_64-with-glibc2.35\r\nIs CUDA available: True\r\nCUDA runtime version: 11.7.99\r\nCUDA_MODULE_LOADING set to: LAZY\r\nGPU models and configuration: GPU 0: NVIDIA GeForce RTX 3060 Laptop GPU\r\nNvidia driver version: 515.65.01\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.4.1\r\n/usr/local/cuda-11.7/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.4.1\r\nHIP runtime version: N/A\r\nMIOpen runtime version: N/A\r\nIs XNNPACK available: True\r\n\r\nVersions of relevant libraries:\r\n[pip3] mypy-extensions==0.4.3\r\n[pip3] numpy==1.23.1\r\n[pip3] torch==1.13.0\r\n[pip3] torch-model-archiver==0.6.1\r\n[pip3] torch-workflow-archiver==0.2.5\r\n[pip3] torchaudio==0.13.0\r\n[pip3] torchinfo==1.7.0\r\n[pip3] torchserve==0.6.1\r\n[pip3] torchvision==0.14.0\r\n[conda] cudatoolkit               11.3.1               h2bc3f7f_2    anaconda\r\n[conda] numpy                     1.23.1                   pypi_0    pypi\r\n[conda] torch                     1.13.0                   pypi_0    pypi\r\n[conda] torch-model-archiver      0.6.1                    pypi_0    pypi\r\n[conda] torch-workflow-archiver   0.2.5                    pypi_0    pypi\r\n[conda] torchaudio                0.13.0                   pypi_0    pypi\r\n[conda] torchinfo                 1.7.0                    pypi_0    pypi\r\n[conda] torchserve                0.6.1                    pypi_0    pypi\r\n[conda] torchvision               0.14.0                   pypi_0    pypi",
                "reactions": {
                    "url": "https://api.github.com/repos/pytorch/pytorch/issues/90607/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/pytorch/pytorch/issues/90607/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            }
        },
        "event": "cross-referenced"
    }
]