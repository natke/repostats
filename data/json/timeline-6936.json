[
    {
        "id": 4422827205,
        "node_id": "MDEyOkxhYmVsZWRFdmVudDQ0MjI4MjcyMDU=",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/4422827205",
        "actor": {
            "login": "HectorSVC",
            "id": 29932710,
            "node_id": "MDQ6VXNlcjI5OTMyNzEw",
            "avatar_url": "https://avatars.githubusercontent.com/u/29932710?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HectorSVC",
            "html_url": "https://github.com/HectorSVC",
            "followers_url": "https://api.github.com/users/HectorSVC/followers",
            "following_url": "https://api.github.com/users/HectorSVC/following{/other_user}",
            "gists_url": "https://api.github.com/users/HectorSVC/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HectorSVC/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HectorSVC/subscriptions",
            "organizations_url": "https://api.github.com/users/HectorSVC/orgs",
            "repos_url": "https://api.github.com/users/HectorSVC/repos",
            "events_url": "https://api.github.com/users/HectorSVC/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HectorSVC/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2021-03-08T18:22:31Z",
        "label": {
            "name": "component:coreruntime",
            "color": "303a93"
        },
        "performed_via_github_app": null
    },
    {
        "id": 4422827209,
        "node_id": "MDEyOkxhYmVsZWRFdmVudDQ0MjI4MjcyMDk=",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/4422827209",
        "actor": {
            "login": "HectorSVC",
            "id": 29932710,
            "node_id": "MDQ6VXNlcjI5OTMyNzEw",
            "avatar_url": "https://avatars.githubusercontent.com/u/29932710?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HectorSVC",
            "html_url": "https://github.com/HectorSVC",
            "followers_url": "https://api.github.com/users/HectorSVC/followers",
            "following_url": "https://api.github.com/users/HectorSVC/following{/other_user}",
            "gists_url": "https://api.github.com/users/HectorSVC/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HectorSVC/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HectorSVC/subscriptions",
            "organizations_url": "https://api.github.com/users/HectorSVC/orgs",
            "repos_url": "https://api.github.com/users/HectorSVC/repos",
            "events_url": "https://api.github.com/users/HectorSVC/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HectorSVC/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2021-03-08T18:22:31Z",
        "label": {
            "name": "type:support",
            "color": "a2eeef"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/794675743",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-794675743",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 794675743,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5NDY3NTc0Mw==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-10T00:53:40Z",
        "updated_at": "2021-03-10T00:53:40Z",
        "author_association": "MEMBER",
        "body": "Why wouldn't it work if there were batches? GRU and LSTM supports batches. The GRU Y_h output and initial_h inputs have a batch size dimension, as does the LSTM Y_h/Y_c outputs and initial_h/initial_c inputs. I'd strongly suggest establishing whether this can satisfy your requirements as a first step.\r\n\r\nIt may be simpler to create a custom operator instead of a complete EP. There's documentation on doing so here: https://www.onnxruntime.ai/docs/how-to/add-custom-op.html. \r\nYou'd have to edit the model to change the operator name of the GRU node to your custom operator name, but that should be fairly trivial to do via a simple python script. \r\n\r\nIf you decide to do a custom op or EP, bear in mind that the InferenceSession's Run method expects execution to be stateless, so you may need to protect against concurrent usage within your op implementation if that is a potential issue. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/794675743/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/797763073",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-797763073",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 797763073,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Nzc2MzA3Mw==",
        "user": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-12T21:22:53Z",
        "updated_at": "2021-03-12T21:22:53Z",
        "author_association": "NONE",
        "body": "Thks - our tests show that for a batch of sequences/timesteps ort will reset state between tsteps, which make sense since that's our understanding of non-stateful behavior in Keras, etc.  So when we run a batch, we want the init state of the previous tstep to be used in the next tstep within that batch.  That doesn't seem possible even with GRU_Y_h output has batch_size dimension.\r\n\r\nSo it looks fairly simple to create a blank EP,  but its unclear to me how to add an operator as the cpu-provider examples seems very complicated.  What do you recommend as the easiest operator to add to an EP?  Is there a very simple example to reference?  I've looked through cpu-provider and armnn provider and those have lots of dependencies and code to sift through.  Is there something simpler?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/797763073/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/797767073",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-797767073",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 797767073,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Nzc2NzA3Mw==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-12T21:31:27Z",
        "updated_at": "2021-03-12T21:31:27Z",
        "author_association": "MEMBER",
        "body": "Can you clarify 'the init state of the previous tstep to be used in the next'? The output state of the previous step is used in the next (you can get the output state from every step via the Y output) - the Y_h output is just the state at end . Wouldn't using the init state mean using the same value for all steps?\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/797767073/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/806217056",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-806217056",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 806217056,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjIxNzA1Ng==",
        "user": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-24T22:08:33Z",
        "updated_at": "2021-03-24T22:08:33Z",
        "author_association": "NONE",
        "body": "So for example, with batch size = 8,  tstep = 16,  we open a session, and run a data set, internally ort will run the first 16 tsteps, then reset state and the 2nd batch of 16 tsteps, etc.  We have no way of intercepting between the batches to save and restore state.  When running this for real time detection we'd want to maintain state (recursive system can have a longer impulse response).\r\nAnyway, it's more important we get our own EP with custom GRU that can maintain state.  Would you be able to help us with that?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/806217056/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/806239915",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-806239915",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 806239915,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjIzOTkxNQ==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-24T23:04:58Z",
        "updated_at": "2021-03-24T23:04:58Z",
        "author_association": "MEMBER",
        "body": "If you still wish to add a custom EP, the documentation is at: https://www.onnxruntime.ai/docs/how-to/add-execution-provider.html\r\n\r\n> We have no way of intercepting between the batches to save and restore state.\r\n\r\nIf you make the Y_h output from the GRU node a model output, and you provide the initial_h input of the GRU node as model input, you essentially intercept the state and can pass it into the next run. \r\n\r\nLet's say you had a really simple model. \r\n  - Model contains a GRU node followed by a Softmax.\r\n  - Let's call the model input 'InputA', and it has shape {seq_length, batch, input_size}. We use this as the X input to the GRU node.\r\n  - Let's say the GRU node Y_h output is called 'GRU_state', and that's the input to the Softmax node.\r\n  - Let's say the model output, which comes from the Softmax node, is called 'OutputA'.\r\n\r\nWith this setup, the GRU uses the default value of initial_h which is all zeros (i.e. the state is 'reset'), and 'GRU_state' only goes into Softmax so is not accessible.\r\n\r\nWe first want to capture the state, so we add the 'GRU_state' output from the GRU node to the list of model outputs (the name just needs to be added to the output list). Now 'GRU_state' goes to the Softmax node, and is also available as a model output.\r\n\r\nTo use that state in the next call, we add a model input for this value (let's call it 'InputState'), and connect it to the initial_h input of the GRU node. \r\n\r\nNow that we're not using the default value of initial_h in the GRU node, for the first call we need to provide an input filled with zeros as 'InputState' with shape {num_directions, batch_size, hidden_size}.\r\nAt the end of the first call we read 'OutputA' and 'GRU_state' from the model outputs, and pass 'GRU_state' in as 'InputState' when running the next batch.. \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/806239915/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 4610914879,
        "node_id": "MDExOkNsb3NlZEV2ZW50NDYxMDkxNDg3OQ==",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/4610914879",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "closed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2021-04-19T07:52:28Z",
        "state_reason": null,
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/825880183",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-825880183",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 825880183,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgyNTg4MDE4Mw==",
        "user": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-04-23T19:44:18Z",
        "updated_at": "2021-04-23T19:44:18Z",
        "author_association": "NONE",
        "body": "Hi Scott,\r\n\r\nThks - we have our own EP started, but just a shell at this point.  Do you know anyone who could help us copy the GRU into our EP and make these modifications?\r\n\r\nThks,\r\nChris",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/825880183/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "aawce",
            "id": 34663873,
            "node_id": "MDQ6VXNlcjM0NjYzODcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34663873?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aawce",
            "html_url": "https://github.com/aawce",
            "followers_url": "https://api.github.com/users/aawce/followers",
            "following_url": "https://api.github.com/users/aawce/following{/other_user}",
            "gists_url": "https://api.github.com/users/aawce/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/aawce/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/aawce/subscriptions",
            "organizations_url": "https://api.github.com/users/aawce/orgs",
            "repos_url": "https://api.github.com/users/aawce/repos",
            "events_url": "https://api.github.com/users/aawce/events{/privacy}",
            "received_events_url": "https://api.github.com/users/aawce/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/826543753",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-826543753",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/6936",
        "id": 826543753,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgyNjU0Mzc1Mw==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-04-26T06:28:22Z",
        "updated_at": "2021-04-26T06:28:22Z",
        "author_association": "MEMBER",
        "body": "> Thks - we have our own EP started, but just a shell at this point. Do you know anyone who could help us copy the GRU into our EP and make these modifications?\r\n\r\nYou're probably on your own for that given your desired approach doesn't really fit with ONNX Runtime's 'run' being stateless.\r\n\r\nAs ONNX Runtime is open source you're free to copy the GRU code and modify it as needed (assuming whatever necessary license info is copied across to make the lawyers happy).\r\n\r\n> This might work for some cases, but it's not clear if it works for some of our use cases where we may want to run batches of sequences/timesteps.\r\n\r\nOut of interest, what is the reason why passing the state between calls to Run doesn't work for you? I'd just like to understand why the overhead of creating a new EP (or custom op) is required.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/826543753/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 4642651782,
        "node_id": "MDEzOkFzc2lnbmVkRXZlbnQ0NjQyNjUxNzgy",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/4642651782",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "assigned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2021-04-26T06:28:49Z",
        "assignee": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "performed_via_github_app": null
    },
    {
        "actor": {
            "login": "peiwenhuang27",
            "id": 45028573,
            "node_id": "MDQ6VXNlcjQ1MDI4NTcz",
            "avatar_url": "https://avatars.githubusercontent.com/u/45028573?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/peiwenhuang27",
            "html_url": "https://github.com/peiwenhuang27",
            "followers_url": "https://api.github.com/users/peiwenhuang27/followers",
            "following_url": "https://api.github.com/users/peiwenhuang27/following{/other_user}",
            "gists_url": "https://api.github.com/users/peiwenhuang27/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/peiwenhuang27/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/peiwenhuang27/subscriptions",
            "organizations_url": "https://api.github.com/users/peiwenhuang27/orgs",
            "repos_url": "https://api.github.com/users/peiwenhuang27/repos",
            "events_url": "https://api.github.com/users/peiwenhuang27/events{/privacy}",
            "received_events_url": "https://api.github.com/users/peiwenhuang27/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-10T08:32:57Z",
        "updated_at": "2021-08-10T08:32:57Z",
        "source": {
            "type": "issue",
            "issue": {
                "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670",
                "repository_url": "https://api.github.com/repos/microsoft/onnxruntime",
                "labels_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670/labels{/name}",
                "comments_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670/comments",
                "events_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670/events",
                "html_url": "https://github.com/microsoft/onnxruntime/issues/8670",
                "id": 964731468,
                "node_id": "MDU6SXNzdWU5NjQ3MzE0Njg=",
                "number": 8670,
                "title": "[ONNXRuntimeError] : 2 : INVALID_ARGUMENT when using modified LSTM op",
                "user": {
                    "login": "peiwenhuang27",
                    "id": 45028573,
                    "node_id": "MDQ6VXNlcjQ1MDI4NTcz",
                    "avatar_url": "https://avatars.githubusercontent.com/u/45028573?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/peiwenhuang27",
                    "html_url": "https://github.com/peiwenhuang27",
                    "followers_url": "https://api.github.com/users/peiwenhuang27/followers",
                    "following_url": "https://api.github.com/users/peiwenhuang27/following{/other_user}",
                    "gists_url": "https://api.github.com/users/peiwenhuang27/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/peiwenhuang27/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/peiwenhuang27/subscriptions",
                    "organizations_url": "https://api.github.com/users/peiwenhuang27/orgs",
                    "repos_url": "https://api.github.com/users/peiwenhuang27/repos",
                    "events_url": "https://api.github.com/users/peiwenhuang27/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/peiwenhuang27/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [],
                "state": "closed",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 0,
                "created_at": "2021-08-10T08:32:57Z",
                "updated_at": "2021-08-10T09:21:10Z",
                "closed_at": "2021-08-10T09:21:10Z",
                "author_association": "NONE",
                "active_lock_reason": null,
                "repository": {
                    "id": 156939672,
                    "node_id": "MDEwOlJlcG9zaXRvcnkxNTY5Mzk2NzI=",
                    "name": "onnxruntime",
                    "full_name": "microsoft/onnxruntime",
                    "private": false,
                    "owner": {
                        "login": "microsoft",
                        "id": 6154722,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjYxNTQ3MjI=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/6154722?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/microsoft",
                        "html_url": "https://github.com/microsoft",
                        "followers_url": "https://api.github.com/users/microsoft/followers",
                        "following_url": "https://api.github.com/users/microsoft/following{/other_user}",
                        "gists_url": "https://api.github.com/users/microsoft/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/microsoft/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/microsoft/subscriptions",
                        "organizations_url": "https://api.github.com/users/microsoft/orgs",
                        "repos_url": "https://api.github.com/users/microsoft/repos",
                        "events_url": "https://api.github.com/users/microsoft/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/microsoft/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "html_url": "https://github.com/microsoft/onnxruntime",
                    "description": "ONNX Runtime: cross-platform, high performance ML inferencing and training accelerator",
                    "fork": false,
                    "url": "https://api.github.com/repos/microsoft/onnxruntime",
                    "forks_url": "https://api.github.com/repos/microsoft/onnxruntime/forks",
                    "keys_url": "https://api.github.com/repos/microsoft/onnxruntime/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/microsoft/onnxruntime/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/microsoft/onnxruntime/teams",
                    "hooks_url": "https://api.github.com/repos/microsoft/onnxruntime/hooks",
                    "issue_events_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/microsoft/onnxruntime/events",
                    "assignees_url": "https://api.github.com/repos/microsoft/onnxruntime/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/microsoft/onnxruntime/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/microsoft/onnxruntime/tags",
                    "blobs_url": "https://api.github.com/repos/microsoft/onnxruntime/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/microsoft/onnxruntime/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/microsoft/onnxruntime/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/microsoft/onnxruntime/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/microsoft/onnxruntime/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/microsoft/onnxruntime/languages",
                    "stargazers_url": "https://api.github.com/repos/microsoft/onnxruntime/stargazers",
                    "contributors_url": "https://api.github.com/repos/microsoft/onnxruntime/contributors",
                    "subscribers_url": "https://api.github.com/repos/microsoft/onnxruntime/subscribers",
                    "subscription_url": "https://api.github.com/repos/microsoft/onnxruntime/subscription",
                    "commits_url": "https://api.github.com/repos/microsoft/onnxruntime/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/microsoft/onnxruntime/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/microsoft/onnxruntime/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/microsoft/onnxruntime/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/microsoft/onnxruntime/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/microsoft/onnxruntime/merges",
                    "archive_url": "https://api.github.com/repos/microsoft/onnxruntime/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/microsoft/onnxruntime/downloads",
                    "issues_url": "https://api.github.com/repos/microsoft/onnxruntime/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/microsoft/onnxruntime/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/microsoft/onnxruntime/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/microsoft/onnxruntime/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/microsoft/onnxruntime/labels{/name}",
                    "releases_url": "https://api.github.com/repos/microsoft/onnxruntime/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/microsoft/onnxruntime/deployments",
                    "created_at": "2018-11-10T02:22:53Z",
                    "updated_at": "2022-12-20T19:02:34Z",
                    "pushed_at": "2022-12-20T19:26:57Z",
                    "git_url": "git://github.com/microsoft/onnxruntime.git",
                    "ssh_url": "git@github.com:microsoft/onnxruntime.git",
                    "clone_url": "https://github.com/microsoft/onnxruntime.git",
                    "svn_url": "https://github.com/microsoft/onnxruntime",
                    "homepage": "https://www.onnxruntime.ai",
                    "size": 1018648,
                    "stargazers_count": 7949,
                    "watchers_count": 7949,
                    "language": "C++",
                    "has_issues": true,
                    "has_projects": true,
                    "has_downloads": true,
                    "has_wiki": true,
                    "has_pages": true,
                    "has_discussions": true,
                    "forks_count": 1862,
                    "mirror_url": null,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 1453,
                    "license": {
                        "key": "mit",
                        "name": "MIT License",
                        "spdx_id": "MIT",
                        "url": "https://api.github.com/licenses/mit",
                        "node_id": "MDc6TGljZW5zZTEz"
                    },
                    "allow_forking": true,
                    "is_template": false,
                    "web_commit_signoff_required": false,
                    "topics": [
                        "ai-framework",
                        "deep-learning",
                        "hacktoberfest",
                        "hardware-acceleration",
                        "machine-learning",
                        "neural-networks",
                        "onnx",
                        "pytorch",
                        "scikit-learn",
                        "tensorflow"
                    ],
                    "visibility": "public",
                    "forks": 1862,
                    "open_issues": 1453,
                    "watchers": 7949,
                    "default_branch": "main",
                    "permissions": {
                        "admin": false,
                        "maintain": true,
                        "push": true,
                        "triage": true,
                        "pull": true
                    }
                },
                "body": "**Describe the bug**\r\nI modified the LSTM node in my model so that I get hidden states of LSTM as model outputs, and they are passed as model inputs in the next call. When I want to test run inference, I declare a numpy array of zeros to pass into session as initial state, but the session prints the error:\r\n> InvalidArgument: [ONNXRuntimeError] : 2 : INVALID_ARGUMENT : Invalid rank for input: LSTM__25_inState Got: 4 Expected: 3 Please fix either the inputs or the model.\r\n\r\n\r\n**Urgency**\r\nProject deadline by the end of the week, so please respond if possible, thank you!\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab\r\n- ONNX Runtime installed from (source or binary): binary\r\n- ONNX Runtime version: 1.8.1\r\n- Python version: 3.7\r\n- Visual Studio version (if applicable):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**To Reproduce**\r\n- Describe steps/code to reproduce the behavior.\r\nI modified my LSTM node following the instructions here: https://github.com/microsoft/onnxruntime/issues/6936#issuecomment-826543753\r\n\r\n```\r\nmodel = onnx.load(ONNX_PATH)\r\n\r\n# change initial_h value\r\n# 199: LSTM__25\r\nmodel.graph.node[199].input[5] = 'LSTM__25_inState'\r\n\r\n# create input value_info\r\nLSTM__25_inState = helper.make_tensor_value_info(\r\n        name='LSTM__25_inState', \r\n        elem_type=1,\r\n        shape=[1,None,400],)\r\nLSTM__25_inState.type.tensor_type.shape.dim[1].dim_param = 'unk__1016'\r\n\r\n# create output value_info\r\nLSTM__25_outState = helper.make_tensor_value_info(\r\n        name='LSTM__25:0',\r\n        elem_type=1,\r\n        shape=[1,None,400],\r\n)\r\nLSTM__25_outState.type.tensor_type.shape.dim[1].dim_param = 'unk__1024'\r\n\r\nmodel.graph.input.append(LSTM__25_inState)\r\nmodel.graph.output.append(LSTM__25_outState)\r\n\r\nonnx.checker.check_model(model) # checker does not raise any error\r\nonnx.save(model, ONNX_PATH)\r\n```\r\n\r\nAfter modification, my model inputs:\r\n```\r\n[name: \"input_noisy\"\r\ntype {\r\n  tensor_type {\r\n    elem_type: 1\r\n    shape {\r\n      dim {\r\n        dim_param: \"unk__1018\"\r\n      }\r\n      dim {\r\n        dim_param: \"unk__1019\"\r\n      }\r\n      dim {\r\n        dim_value: 257\r\n      }\r\n    }\r\n  }\r\n}\r\n, name: \"input_noisy_norm\"\r\ntype {\r\n  tensor_type {\r\n    elem_type: 1\r\n    shape {\r\n      dim {\r\n        dim_param: \"unk__1020\"\r\n      }\r\n      dim {\r\n        dim_value: 257\r\n      }\r\n      dim {\r\n        dim_param: \"unk__1021\"\r\n      }\r\n      dim {\r\n        dim_value: 1\r\n      }\r\n    }\r\n  }\r\n}\r\n, name: \"LSTM__25_inState\"\r\ntype {\r\n  tensor_type {\r\n    elem_type: 1\r\n    shape {\r\n      dim {\r\n        dim_value: 1\r\n      }\r\n      dim {\r\n        dim_param: \"unk__1016\"\r\n      }\r\n      dim {\r\n        dim_value: 400\r\n      }\r\n    }\r\n  }\r\n}\r\n]\r\n```\r\n\r\nmodel outputs:\r\n```\r\n[name: \"outputMask\"\r\ntype {\r\n  tensor_type {\r\n    elem_type: 1\r\n    shape {\r\n      dim {\r\n        dim_param: \"unk__1022\"\r\n      }\r\n      dim {\r\n        dim_param: \"unk__1023\"\r\n      }\r\n      dim {\r\n        dim_value: 257\r\n      }\r\n    }\r\n  }\r\n}\r\n, name: \"LSTM__25:0\"\r\ntype {\r\n  tensor_type {\r\n    elem_type: 1\r\n    shape {\r\n      dim {\r\n        dim_value: 1\r\n      }\r\n      dim {\r\n        dim_param: \"unk__1024\"\r\n      }\r\n      dim {\r\n        dim_value: 400\r\n      }\r\n    }\r\n  }\r\n}\r\n]\r\n```\r\n\r\nOnce I have the saved ONNX model, I load it into ONNX Inference Session, and load my data/declare initial LSTM zero state:\r\n```\r\ninitState_25 = np.zeros((1,1,400)).astype(np.float32)\r\n```\r\n\r\nAnd pass it along with my original data into the session.\r\n\r\n- Attach the ONNX model to the issue (where applicable) to expedite investigation.\r\n\r\n**Expected behavior**\r\nWhat baffles me is that I clearly initialized the LSTM zero state as a 3D tensor, but somehow when passing into the model, the rank becomes 4 instead of 3. I also tried initializing the state tensor as\r\n```\r\ninitState_25 = np.zeros((1,400)).astype(np.float32)\r\n```\r\nBut then it just prints that the rank is 2, while expected 3.\r\n\r\n**I printed out `session.get_inputs()` after encountering the error, and the shape of the tensor for the LSTM state became `(60, 1, 1, 400)` from `(1, 1, 400)`, and I am not sure as to why the model adds the first dimension.**\r\n\r\n\r\n**Screenshots**\r\nThe architecture of my model via Netron:\r\n<img width=\"666\" alt=\"Screen Shot 2021-08-10 at 16 28 03\" src=\"https://user-images.githubusercontent.com/45028573/128834504-229f7150-a1f9-4d49-8d9e-c8c2db07b29c.png\">\r\n<img width=\"482\" alt=\"Screen Shot 2021-08-10 at 16 28 07\" src=\"https://user-images.githubusercontent.com/45028573/128834517-274dba0d-fe88-4c22-b554-b3da5fd6079a.png\">\r\n\r\n\r\n**Additional context**\r\nAdd any other context about the problem here. If the issue is about a particular model, please share the model details as well to facilitate debugging.\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8670/timeline",
                "performed_via_github_app": null,
                "state_reason": "completed"
            }
        },
        "event": "cross-referenced"
    }
]