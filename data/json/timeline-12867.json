[
    {
        "id": 7332918204,
        "node_id": "RTE_lADOCVq1mM5RR_I5zwAAAAG1E3O8",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7332918204",
        "actor": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "renamed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-06T18:34:59Z",
        "rename": {
            "from": "onnx and ORT mismatch in their handling of Protobuf_USE_STATIC_LIBS and ORT can produce incorrect warnings",
            "to": "onnx and ORT mismatch in their handling of Protobuf_USE_STATIC_LIBS and ORT can produce incorrect warnings and failures"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238656363",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1238656363",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1238656363,
        "node_id": "IC_kwDOCVq1mM5J1GVr",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-06T21:15:01Z",
        "updated_at": "2022-09-06T21:15:01Z",
        "author_association": "MEMBER",
        "body": "You are right. Neither ORT nor protobuf use this Protobuf_USE_STATIC_LIBS variable. If you search it in https://github.com/protocolbuffers/protobuf, you will not find anything.  So, in normal usages you should not need to worry about this macro. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238656363/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7334546059,
        "node_id": "LE_lADOCVq1mM5RR_I5zwAAAAG1LEqL",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7334546059",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-07T00:24:31Z",
        "label": {
            "name": "build",
            "color": "D93F0B"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238794358",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1238794358",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1238794358,
        "node_id": "IC_kwDOCVq1mM5J1oB2",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-07T01:03:15Z",
        "updated_at": "2022-09-07T01:03:15Z",
        "author_association": "MEMBER",
        "body": ">To Reproduce\r\nBuild ORT and onnx together on Windows without setting Protobuf_USE_STATIC_LIBS to ON\r\n\r\nProtobuf_USE_STATIC_LIBS seems to only be used in a status message in the onnx cmake setup. https://github.com/onnx/onnx/search?q=Protobuf_USE_STATIC_LIBS. It doesn't seem to have any influence over how protobuf is built.\r\n\r\nBased on that, I'm not following how not setting that value would affect a build and reproduce the issue. \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238794358/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238798843",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1238798843",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1238798843,
        "node_id": "IC_kwDOCVq1mM5J1pH7",
        "user": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-07T01:12:28Z",
        "updated_at": "2022-09-07T01:12:28Z",
        "author_association": "MEMBER",
        "body": "> > To Reproduce\r\n> > Build ORT and onnx together on Windows without setting Protobuf_USE_STATIC_LIBS to ON\r\n> \r\n> Protobuf_USE_STATIC_LIBS seems to only be used in a status message in the onnx cmake setup. https://github.com/onnx/onnx/search?q=Protobuf_USE_STATIC_LIBS. It doesn't seem to have any influence over how protobuf is built.\r\n> \r\n> Based on that, I'm not following how not setting that value would affect a build and reproduce the issue.\r\n\r\nCMake uses the value to determine which libs to use for protobuf: https://github.com/Kitware/CMake/blob/master/Modules/FindProtobuf.cmake\r\n\r\nI recommend trying it locally to see it reproduce.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238798843/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238813259",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1238813259",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1238813259,
        "node_id": "IC_kwDOCVq1mM5J1spL",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-07T01:40:47Z",
        "updated_at": "2022-09-07T01:40:47Z",
        "author_association": "MEMBER",
        "body": "Oh ok. I didn't realize it was a value used internally by cmake.\r\n\r\nCould you please share the full command you're using to build?\r\n\r\nWe generally build using build.py, and there's only [one](https://github.com/microsoft/onnxruntime/blob/c571b993363d1f1095c2921c9ff3f9770c02eb85/tools/ci_build/build.py#L1041) place that sets Protobuf_USE_STATIC_LIBS, and that requires additional options for it to be hit. In my typical Windows build I don't use those additional options so Protobuf_USE_STATIC_LIBS is not explicitly set and I have no issues. \r\n\r\ne.g. this is the cmake command build.py generates\r\n\r\n```\r\n2022-09-07 11:26:22,636 util.run [INFO] - Running subprocess in 'build\\Windows.vs22\\Debug'\r\n  'C:\\Program Files\\CMake\\bin\\cmake.EXE' 'D:\\src\\github\\ort\\cmake' -Donnxruntime_RUN_ONNX_TESTS=OFF -Donnxruntime_GENERATE_TEST_REPORTS=ON '-DPython_EXECUTABLE=C:\\Program Files\\Python39\\python.exe' '-DPYTHON_EXECUTABLE=C:\\Program Files\\Python39\\python.exe' -Donnxruntime_USE_MIMALLOC=OFF -Donnxruntime_ENABLE_PYTHON=ON -Donnxruntime_BUILD_CSHARP=OFF -Donnxruntime_BUILD_JAVA=OFF -Donnxruntime_BUILD_NODEJS=OFF -Donnxruntime_BUILD_OBJC=OFF -Donnxruntime_BUILD_SHARED_LIB=ON -Donnxruntime_BUILD_APPLE_FRAMEWORK=OFF -Donnxruntime_USE_DNNL=OFF -Donnxruntime_USE_NNAPI_BUILTIN=OFF -Donnxruntime_USE_RKNPU=OFF -Donnxruntime_USE_NUPHAR_TVM=OFF -Donnxruntime_USE_LLVM=OFF -Donnxruntime_ENABLE_MICROSOFT_INTERNAL=OFF -Donnxruntime_USE_VITISAI=OFF -Donnxruntime_USE_NUPHAR=OFF -Donnxruntime_USE_TENSORRT=OFF -Donnxruntime_USE_TENSORRT_BUILTIN_PARSER=OFF -Donnxruntime_TENSORRT_PLACEHOLDER_BUILDER=OFF -Donnxruntime_USE_TVM=OFF -Donnxruntime_TVM_CUDA_RUNTIME=OFF -Donnxruntime_TVM_USE_HASH=OFF -Donnxruntime_USE_MIGRAPHX=OFF -Donnxruntime_CROSS_COMPILING=OFF -Donnxruntime_DISABLE_CONTRIB_OPS=OFF -Donnxruntime_DISABLE_ML_OPS=OFF -Donnxruntime_DISABLE_RTTI=OFF -Donnxruntime_DISABLE_EXCEPTIONS=OFF -Donnxruntime_MINIMAL_BUILD=OFF -Donnxruntime_EXTENDED_MINIMAL_BUILD=OFF -Donnxruntime_MINIMAL_BUILD_CUSTOM_OPS=OFF -Donnxruntime_REDUCED_OPS_BUILD=OFF -Donnxruntime_ENABLE_LANGUAGE_INTEROP_OPS=OFF -Donnxruntime_USE_DML=OFF -Donnxruntime_USE_WINML=OFF -Donnxruntime_BUILD_MS_EXPERIMENTAL_OPS=OFF -Donnxruntime_USE_TELEMETRY=OFF -Donnxruntime_ENABLE_LTO=OFF -Donnxruntime_USE_ACL=OFF -Donnxruntime_USE_ACL_1902=OFF -Donnxruntime_USE_ACL_1905=OFF -Donnxruntime_USE_ACL_1908=OFF -Donnxruntime_USE_ACL_2002=OFF -Donnxruntime_USE_ARMNN=OFF -Donnxruntime_ARMNN_RELU_USE_CPU=ON -Donnxruntime_ARMNN_BN_USE_CPU=ON -Donnxruntime_ENABLE_NVTX_PROFILE=OFF -Donnxruntime_ENABLE_TRAINING=OFF -Donnxruntime_ENABLE_TRAINING_OPS=OFF -Donnxruntime_ENABLE_TRAINING_TORCH_INTEROP=OFF -Donnxruntime_ENABLE_TRAINING_ON_DEVICE=OFF -Donnxruntime_ENABLE_CPU_FP16_OPS=OFF -Donnxruntime_USE_NCCL=OFF -Donnxruntime_BUILD_BENCHMARKS=OFF -Donnxruntime_USE_ROCM=OFF -DOnnxruntime_GCOV_COVERAGE=OFF -Donnxruntime_USE_MPI=ON -Donnxruntime_ENABLE_MEMORY_PROFILE=OFF -Donnxruntime_ENABLE_CUDA_LINE_NUMBER_INFO=OFF -Donnxruntime_BUILD_WEBASSEMBLY=OFF -Donnxruntime_BUILD_WEBASSEMBLY_STATIC_LIB=OFF -Donnxruntime_ENABLE_WEBASSEMBLY_EXCEPTION_CATCHING=ON -Donnxruntime_ENABLE_WEBASSEMBLY_EXCEPTION_THROWING=OFF -Donnxruntime_ENABLE_WEBASSEMBLY_THREADS=OFF -Donnxruntime_ENABLE_WEBASSEMBLY_DEBUG_INFO=OFF -Donnxruntime_ENABLE_WEBASSEMBLY_PROFILING=OFF -Donnxruntime_ENABLE_EAGER_MODE=OFF -Donnxruntime_ENABLE_LAZY_TENSOR=OFF -Donnxruntime_ENABLE_EXTERNAL_CUSTOM_OP_SCHEMAS=OFF -Donnxruntime_ENABLE_CUDA_PROFILING=OFF -Donnxruntime_ENABLE_ROCM_PROFILING=OFF -Donnxruntime_USE_XNNPACK=ON -Donnxruntime_DEV_MODE=ON -DONNX_USE_MSVC_STATIC_RUNTIME=OFF -Dprotobuf_MSVC_STATIC_RUNTIME=OFF -Dgtest_force_shared_crt=ON -Donnxruntime_PYBIND_EXPORT_OPSCHEMA=OFF -A x64 -T host=x64 -G 'Visual Studio 17 2022' -Donnxruntime_ENABLE_MEMLEAK_CHECKER=ON -DCMAKE_BUILD_TYPE=Debug\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1238813259/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7335245650,
        "node_id": "LE_lADOCVq1mM5RR_I5zwAAAAG1NvdS",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7335245650",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "labeled",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-07T04:06:34Z",
        "label": {
            "name": "feature request",
            "color": "5319E7"
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242510463",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242510463",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242510463,
        "node_id": "IC_kwDOCVq1mM5KDzR_",
        "user": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T21:55:38Z",
        "updated_at": "2022-09-09T21:55:38Z",
        "author_association": "MEMBER",
        "body": "Our team includes ort through our cmake file like so:\r\n\r\n```\r\n  set(onnxruntime_BUILD_SHARED_LIB ON)\r\n  set(onnxruntime_BUILD_UNIT_TESTS OFF)\r\n  set(onnxruntime_ENABLE_TRAINING ON)\r\n  set(onnxruntime_USE_FULL_PROTOBUF ON)\r\n  set(onnxruntime_PREFER_SYSTEM_LIB ON)\r\n  set(Protobuf_USE_STATIC_LIBS ON) <- This was added to avoid the errors from onnx\r\n  add_subdirectory(onnxruntime/cmake EXCLUDE_FROM_ALL)\r\n```\r\nand passing `-DCMAKE_PREFIX_PATH=path\\to\\protobuf-install-release` on the command line.\r\n\r\nYou can reproduce it by invoking cmake directly:\r\n```\r\ncmake -G Ninja \\path\\to\\onnxruntime\\cmake -Donnxruntime_BUILD_SHARED_LIB=ON -Donnxruntime_BUILD_UNIT_TESTS=OFF -Donnxruntime_ENABLE_TRAINING=ON -Donnxruntime_USE_FULL_PROTOBUF=ON -Donnxruntime_PREFER_SYSTEM_LIB=ON -DCMAKE_PREFIX_PATH=path\\to\\protobuf-install-release\r\n```\r\n\r\nOr using `build.bat` (though, at least for me, that fails with warnings treated as error in unrelated parts):\r\n```\r\n./build.bat --config Release --build_shared_lib --parallel --enable_training --skip_tests --use_full_protobuf --cmake_generator \"Visual Studio 17 2022\" --cmake_extra_defines CMAKE_PREFIX_PATH=path\\to\\protobuf-install-release onnxruntime_PREFER_SYSTEM_LIB=ON\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242510463/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242557439",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242557439",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242557439,
        "node_id": "IC_kwDOCVq1mM5KD-v_",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T23:33:28Z",
        "updated_at": "2022-09-09T23:33:28Z",
        "author_association": "MEMBER",
        "body": "Got it. build.py does not set the experimental onnxruntime_PREFER_SYSTEM_LIB, and it has this comment in the cmake file.\r\n\r\n```cmake\r\n#The onnxruntime_PREFER_SYSTEM_LIB is mainly designed for package managers like apt/yum/vcpkg.\r\n#Please note, by default Protobuf_USE_STATIC_LIBS is OFF but it's recommended to turn it ON on Windows. You should set it properly when onnxruntime_PREFER_SYSTEM_LIB is ON otherwise you'll hit linkage errors.\r\n#If you have already installed protobuf(or the others) in your system at the default system paths(like /usr/include), then it's better to set onnxruntime_PREFER_SYSTEM_LIB ON. Otherwise onnxruntime may see two different protobuf versions and we won't know which one will be used, the worst case could be onnxruntime picked up header files from one of them but the binaries from the other one.\r\n#It's default OFF because it's experimental now.\r\noption(onnxruntime_PREFER_SYSTEM_LIB \"Experimental: Build with the preinstalled libraries in your system\" OFF)\r\n```\r\n\r\nMy initial thought would be we could change this to make the ONNX build consistent. \r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/1e34440c370d40085fad5fd1b1002b4a04c5991d/cmake/CMakeLists.txt#L788-L811\r\n\r\nby changing it to also set ONNX_USE_PROTOBUF_SHARED_LIBS \r\n\r\n```cmake\r\n    # We have a check here but most of the cmake users don't know the Protobuf_USE_STATIC_LIBS\r\n    # variable exists and may leave it in a wrong state.\r\n    # Also need to make onnx build params consistent as (currently) that uses the value of ONNX_USE_PROTOBUF_SHARED_LIBS\r\n    # to set Protobuf_USE_STATIC_LIBS. This is somewhat fragile as changes in the ONNX cmake setup may break this.\r\n    if(NOT Protobuf_USE_STATIC_LIBS)\r\n      # ONNX Runtime itself can work in such a setting but it may cause compatibility issues\r\n      # when ONNX Runtime is integrated with the other ONNX ecosystem softwares.\r\n      message(WARNING \"Use Protobuf_USE_STATIC_LIBS to ensure compatibility with other ONNX ecosystem components.\")\r\n      set(ONNX_USE_PROTOBUF_SHARED_LIBS ON)\r\n    else()\r\n      set(ONNX_USE_PROTOBUF_SHARED_LIBS OFF)\r\n    endif()\r\n```\r\n\r\nHowever this is only in a branch that is taken when onnxruntime_PREFER_SYSTEM_LIB is set. @snnn do we need to make sure ONNX_USE_PROTOBUF_SHARED_LIBS is consistent with Protobuf_USE_STATIC_LIBS for all builds? ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242557439/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7359919727,
        "node_id": "MEE_lADOCVq1mM5RR_I5zwAAAAG2r3Zv",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7359919727",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-09T23:33:28Z",
        "performed_via_github_app": null
    },
    {
        "id": 7359919730,
        "node_id": "SE_lADOCVq1mM5RR_I5zwAAAAG2r3Zy",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7359919730",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-09T23:33:28Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242560802",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242560802",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242560802,
        "node_id": "IC_kwDOCVq1mM5KD_ki",
        "user": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-09T23:43:26Z",
        "updated_at": "2022-09-09T23:43:26Z",
        "author_association": "MEMBER",
        "body": "Setting `ONNX_USE_PROTOBUF_SHARED_LIBS` to `ON` if `Protobuf_USE_STATIC_LIBS` is not set won't work right either. For example, in our setup, we *do* want to use static libs and that's the version of protobuf we are linking against, so setting `ONNX_USE_PROTOBUF_SHARED_LIBS` to `ON` will break us.\r\n\r\nIt would be better, I think, to expose something like `ORT_USE_PROTOBUF_SHARED_LIBS` (set to OFF by default) and use that to set `ONNX_USE_PROTOBUF_SHARED_LIBS` and possibly `Protobuf_USE_STATIC_LIBS`. This will ensure that everything is consistent.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242560802/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242593438",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242593438",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242593438,
        "node_id": "IC_kwDOCVq1mM5KEHie",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-10T02:00:29Z",
        "updated_at": "2022-09-10T02:00:29Z",
        "author_association": "MEMBER",
        "body": "According to https://cmake.org/cmake/help/latest/module/FindProtobuf.html the default of Protobuf_USE_STATIC_LIBS is OFF. So if that is not set or OFF wouldn't it be using the shared protobuf libs and ONNX_USE_PROTOBUF_SHARED_LIBS should be ON to make the onnx build consistent? \r\n\r\nWith that setup, is it not the case that If you wish to use static libs you can set Protobuf_USE_STATIC_LIBS. What value would adding ORT_USE_PROTOBUF_SHARED_LIBS provide apart from having a different default?\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242593438/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242613043",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242613043",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242613043,
        "node_id": "IC_kwDOCVq1mM5KEMUz",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-10T04:00:57Z",
        "updated_at": "2022-09-10T04:00:57Z",
        "author_association": "MEMBER",
        "body": "> do we need to make sure ONNX_USE_PROTOBUF_SHARED_LIBS is consistent with Protobuf_USE_STATIC_LIBS for all builds?\r\n\r\nThe variable Protobuf_USE_STATIC_LIBS  takes effect only when onnxruntime_PREFER_SYSTEM_LIB  is ON. And the onnxruntime_PREFER_SYSTEM_LIB  variable was added only for Linux package managers. Linux only.  Most of the code was added by the community and maintained by the community.  So,  everyone is welcomed to make it better.  Also, everyone is welcomed to review such changes. On the other hand, Microsoft teams should use https://github.com/microsoft/vcpkg . \r\n\r\nBesides, the var Protobuf_USE_STATIC_LIBS was added and used by the cmake community, not Google staffs. I think from the very beginning it shouldn't exist.  The dev team of protobuf team do not suggest using protobuf as a dynamical library. There are tons of issues related to it and simply nobody won't fix them. Or, won't be able to fix them.  In my opinion, nobody have the need to dynamically link to protobuf. If someone does it, they are wrong. \r\n\r\n  In some very limited usage cases, it may still work.  But, if it doesn't work, don't report it Google and don't report it to us.  One such case is:  If you want to use the full version of protobuf(onnxruntime_USE_FULL_PROTOBUF=ON), you should only use the static version of protobuf. \r\n\r\nIn ORT's CMakeLists.txt we have:\r\n```cmake\r\nif (onnxruntime_USE_FULL_PROTOBUF)\r\n    set(PROTOBUF_LIB protobuf::libprotobuf)\r\n    #We have a check here but most of the cmake users don't know the Protobuf_USE_STATIC_LIBS\r\n    # variable exists and may leave it in a wrong state.\r\n    if (NOT Protobuf_USE_STATIC_LIBS)\r\n      # ONNX Runtime itself can work in such a setting but it may cause compatibility issues\r\n      # when ONNX Runtime is integrated with the other ONNX ecosystem softwares.\r\n      message(WARNING \"Use Protobuf_USE_STATIC_LIBS to ensure compatibility with other ONNX ecosystem components.\")\r\n    endif()\r\nendif()\r\n```\r\n\r\nBut initially it wasn't a warning. It was a fatal error. Then a 3rd-party user asked me to relax the check because he believed he could make it work in his use cases. So I let him do it.  But I would not help fix any problem coming from it.  Because I know there are many blockers there. Even the dev team of protobuf wouldn't want to touch them, why would I? And what value does it add?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242613043/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242630775",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242630775",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242630775,
        "node_id": "IC_kwDOCVq1mM5KEQp3",
        "user": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-10T05:01:20Z",
        "updated_at": "2022-09-10T05:01:20Z",
        "author_association": "MEMBER",
        "body": "@snnn a couple of things:\r\n\r\n`onnxruntime_PREFER_SYSTEM_LIB` is not documented as Linux only. If it is meant to only be used on Linux, I think it should be defined in such a way that it cannot be used on other platforms. Otherwise, it will be used elsewhere and it will run into issues. In our case, it was very convenient on *both* Windows and Linux to avoid having to build things we had prebuilt.\r\n\r\n`Protobuf_USE_STATIC_LIBS`: whether we agree with the existence of this variable or not, both `cmake` and `onnx` currently leverage it which means that by extension it impacts `onnxruntime`. While in our case we want to statically linked against `protobuf`, we ran into issues because the default for the variable is different between `cmake` and `onnx` and there's no coordination between how it is used in `onnxruntime` (through `cmake`, set to `OFF`) and `onnx` (where it is explicitly set to `ON` by default).\r\n\r\nI think it's a great idea to enforce that it is explicitly set to `ON` (and consequently that `ONNX_USE_PROTOBUF_SHARED_LIBS` is explicitly set to `OFF`) for the `onnxruntime` scenarios since that will ensure that users of `onnxruntime` don't run into random and hard diagnose issues because of mismatches between `onnxruntime` and `onnx`.\r\n\r\nHowever, even if `onnxruntime` is not going to enforce any specific setting (as it currently doesn't), as the primary product that users are going to interact with, it still needs to be the one to ensure that there is coordination between its own usage and that of `onnx`. As such, it makes sense to introduce a variable (such as `onnxruntime_USE_PROTOBUF_SHARED_LIBS` or similar) which can be set to `OFF` by default and which would control both `Protobuf_USE_STATIC_LIBS` and `ONNX_USE_PROTOBUF_SHARED_LIBS`.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242630775/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "sstamenova",
            "id": 29738015,
            "node_id": "MDQ6VXNlcjI5NzM4MDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/29738015?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sstamenova",
            "html_url": "https://github.com/sstamenova",
            "followers_url": "https://api.github.com/users/sstamenova/followers",
            "following_url": "https://api.github.com/users/sstamenova/following{/other_user}",
            "gists_url": "https://api.github.com/users/sstamenova/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sstamenova/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sstamenova/subscriptions",
            "organizations_url": "https://api.github.com/users/sstamenova/orgs",
            "repos_url": "https://api.github.com/users/sstamenova/repos",
            "events_url": "https://api.github.com/users/sstamenova/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sstamenova/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "id": 7360397658,
        "node_id": "MEE_lADOCVq1mM5RR_I5zwAAAAG2tsFa",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7360397658",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "mentioned",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-10T05:01:20Z",
        "performed_via_github_app": null
    },
    {
        "id": 7360397659,
        "node_id": "SE_lADOCVq1mM5RR_I5zwAAAAG2tsFb",
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/events/7360397659",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "event": "subscribed",
        "commit_id": null,
        "commit_url": null,
        "created_at": "2022-09-10T05:01:20Z",
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242642092",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242642092",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242642092,
        "node_id": "IC_kwDOCVq1mM5KETas",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-10T06:15:41Z",
        "updated_at": "2022-09-10T06:15:41Z",
        "author_association": "MEMBER",
        "body": "If we step back a bit and assume there was just one library consuming libprotobuf, then who should set this Protobuf_USE_STATIC_LIBS variable? I think it should be the user who invoke the cmake command. Only they know whether the preinstalled protobuf lib is static or dynamic.  For example, if I wrote a simple C/C++ program which just read a ONNX model and print out all the names of all the ops, I can do it by directly interact with protobuf, without the need of using onnx or onnxruntime. And that simple program could either use a static protobuf library or a dynamic one.  Both work good enough. So I believe the program's CMakeFile.txt should not try to set a default value for Protobuf_USE_STATIC_LIBS .  I think the name \"Protobuf_USE_STATIC_LIBS \" is a bit misleading. It is not an ON/OFF control option. When you set it to ON, it doesn't mean cmake will help you find a static library of protobuf. Conversely, it is the way to let cmake know the lib cmake found **is** static or not.  If you don't tell it, cmake would assume you have installed a dynamic one. So, my opinion is whenever you use https://github.com/Kitware/CMake/blob/master/Modules/FindProtobuf.cmake you should always manually specify `-DProtobuf_USE_STATIC_LIBS=xxx`. The software you are building doesn't know how you installed protobuf.\r\n\r\nThen back to ONNX: the var ONNX_USE_PROTOBUF_SHARED_LIBS is just another name of Protobuf_USE_STATIC_LIBS . ONNX expect you using ONNX_USE_PROTOBUF_SHARED_LIBS  instead of Protobuf_USE_STATIC_LIBS. I don't know the reason.  Probably because they want to support the case that you have both static protobuf lib and dynamic protobuf in the same application.  For example, in ORT while the core framework prefer to static link to protobuf, an ORT EP could still either statically link to protobuf or dynamically. Then it might be good to have two different variables to control the two different things. But, it is just my guessing. I don't know why ONNX decided to introduce a new variable to control this.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242642092/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242646170",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12867#issuecomment-1242646170",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12867",
        "id": 1242646170,
        "node_id": "IC_kwDOCVq1mM5KEUaa",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-10T06:34:25Z",
        "updated_at": "2022-09-10T06:34:25Z",
        "author_association": "MEMBER",
        "body": "If you set onnxruntime_USE_CUDA = ON, you build ONNX Runtime with CUDA. If you set onnxruntime_USE_CUDA = OFF, you build ONNX Runtime without CUDA. But Protobuf_USE_STATIC_LIBS doesn't work in that way. **On Windows** You should set Protobuf_USE_STATIC_LIBS to ON if you know the protobuf lib cmake will find will definitely be a static lib. And you set it to OFF if you know it would be definitely dynamic. If you are not sure, you run cmake and see what it find, then do it again and set Protobuf_USE_STATIC_LIBS correctly according to the previous run's result. It is not intuitive but it is how this cmake module works. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1242646170/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null,
        "event": "commented",
        "actor": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        }
    }
]