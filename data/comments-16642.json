[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1628416000",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16642#issuecomment-1628416000",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16642",
        "id": 1628416000,
        "node_id": "IC_kwDOCVq1mM5hD6gA",
        "user": {
            "login": "cloudhan",
            "id": 1279292,
            "node_id": "MDQ6VXNlcjEyNzkyOTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1279292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cloudhan",
            "html_url": "https://github.com/cloudhan",
            "followers_url": "https://api.github.com/users/cloudhan/followers",
            "following_url": "https://api.github.com/users/cloudhan/following{/other_user}",
            "gists_url": "https://api.github.com/users/cloudhan/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cloudhan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cloudhan/subscriptions",
            "organizations_url": "https://api.github.com/users/cloudhan/orgs",
            "repos_url": "https://api.github.com/users/cloudhan/repos",
            "events_url": "https://api.github.com/users/cloudhan/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cloudhan/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-10T07:45:51Z",
        "updated_at": "2023-07-10T07:45:51Z",
        "author_association": "MEMBER",
        "body": "@RyanUnderhill @tianleiwu #16272 Introduced a severe performance degeneration, on ROCm. Either a fix or a revert is perfered.\r\n\r\ncc. @zhangyaobit ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1628416000/reactions",
            "total_count": 1,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 1
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1628684473",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16642#issuecomment-1628684473",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16642",
        "id": 1628684473,
        "node_id": "IC_kwDOCVq1mM5hE8C5",
        "user": {
            "login": "cloudhan",
            "id": 1279292,
            "node_id": "MDQ6VXNlcjEyNzkyOTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1279292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cloudhan",
            "html_url": "https://github.com/cloudhan",
            "followers_url": "https://api.github.com/users/cloudhan/followers",
            "following_url": "https://api.github.com/users/cloudhan/following{/other_user}",
            "gists_url": "https://api.github.com/users/cloudhan/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cloudhan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cloudhan/subscriptions",
            "organizations_url": "https://api.github.com/users/cloudhan/orgs",
            "repos_url": "https://api.github.com/users/cloudhan/repos",
            "events_url": "https://api.github.com/users/cloudhan/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cloudhan/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-10T10:38:35Z",
        "updated_at": "2023-07-10T10:39:21Z",
        "author_association": "MEMBER",
        "body": "I also verified CUDA EP with\r\n```bash\r\ngit checkout f5e9625 && git cherry-pick b84c63db2a # build and run, the perf should be good\r\ngit checkout 1001ec9 && git cherry-pick b84c63db2a # build and run, the perf will be much worse\r\n```\r\nThe perf number is  0.488s and 1.735s respectively, on Tesla V100-DGXS-32GB\r\n\r\nNOTE: b84c63db2a fixed a mistake introduced by me.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1628684473/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1631167450",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16642#issuecomment-1631167450",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16642",
        "id": 1631167450,
        "node_id": "IC_kwDOCVq1mM5hOaPa",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-11T16:54:51Z",
        "updated_at": "2023-07-11T16:55:22Z",
        "author_association": "MEMBER",
        "body": "@cloudhan, what's exact command lines to reproduce the latency number? Ryan tested GPT-2 and T5 in V100, and he did not see perf regression.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1631167450/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1631990546",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16642#issuecomment-1631990546",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16642",
        "id": 1631990546,
        "node_id": "IC_kwDOCVq1mM5hRjMS",
        "user": {
            "login": "cloudhan",
            "id": 1279292,
            "node_id": "MDQ6VXNlcjEyNzkyOTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1279292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cloudhan",
            "html_url": "https://github.com/cloudhan",
            "followers_url": "https://api.github.com/users/cloudhan/followers",
            "following_url": "https://api.github.com/users/cloudhan/following{/other_user}",
            "gists_url": "https://api.github.com/users/cloudhan/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cloudhan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cloudhan/subscriptions",
            "organizations_url": "https://api.github.com/users/cloudhan/orgs",
            "repos_url": "https://api.github.com/users/cloudhan/repos",
            "events_url": "https://api.github.com/users/cloudhan/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cloudhan/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-12T07:27:13Z",
        "updated_at": "2023-07-12T07:27:13Z",
        "author_association": "MEMBER",
        "body": "I ran on the same cuda machine on latest main tip\r\n\r\nWith the same input, the E2E time scales linearly with `max_length`, even though the `min_length` is 20 and the actual outputed sequence length is less than ~30.\r\n\r\n| max_length | e2e time |\r\n| ---------- | ---------|\r\n|         32 |   0.373s |\r\n|         64 |   0.628s |\r\n|        128 |   1.157s |\r\n|        256 |   2.244s |\r\n|        512 |      err |\r\n\r\n`max_length >= 512` (not sure about the lower bound, tho) produce the following error with whisper large. \r\n\r\n```\r\nonnxruntime.capi.onnxruntime_pybind11_state.InvalidArgument: [ONNXRuntimeError] : 2 : INVALID_ARGUMENT : Non-zero status code returned while running BeamSearch node. Name:'BeamSearch_zcode' Status Message: Non-zero status code returned while running DecoderMaskedMultiHeadAttention node. Name:'Attention_0' Status Message: Input sequence length should be 1 to use DecoderMaskedMultiHeadAttention\r\n```\r\n\r\n@RyanUnderhill This info might be helpful.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1631990546/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]