[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/950483173",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-950483173",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 950483173,
        "node_id": "IC_kwDOCVq1mM44pzjl",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-25T03:02:48Z",
        "updated_at": "2021-10-25T03:02:48Z",
        "author_association": "MEMBER",
        "body": "Can you please elaborate about your scenario ? What exactly do you mean by \"release GPU memory in time and keep the session running\" ? Do you mean you want to shrink any GPU memory arena associated with the session periodically while still keeping the session alive ?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/950483173/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/950549553",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-950549553",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 950549553,
        "node_id": "IC_kwDOCVq1mM44qDwx",
        "user": {
            "login": "Z-XQ",
            "id": 37925249,
            "node_id": "MDQ6VXNlcjM3OTI1MjQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/37925249?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Z-XQ",
            "html_url": "https://github.com/Z-XQ",
            "followers_url": "https://api.github.com/users/Z-XQ/followers",
            "following_url": "https://api.github.com/users/Z-XQ/following{/other_user}",
            "gists_url": "https://api.github.com/users/Z-XQ/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Z-XQ/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Z-XQ/subscriptions",
            "organizations_url": "https://api.github.com/users/Z-XQ/orgs",
            "repos_url": "https://api.github.com/users/Z-XQ/repos",
            "events_url": "https://api.github.com/users/Z-XQ/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Z-XQ/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-25T05:45:01Z",
        "updated_at": "2021-10-25T05:45:01Z",
        "author_association": "NONE",
        "body": "> Can you please elaborate about your scenario ? What exactly do you mean by \"release GPU memory in time and keep the session running\" ? Do you mean you want to shrink any GPU memory arena associated with the session periodically while still keeping the session alive ?\r\n\r\n\r\nThank you for your reply! The following is my scenario.\r\n\r\nMy gpu is 3090. 708M gpu memory is used before open an onnxruntime session.\r\nThen I use the following to open a session.\r\nort_session = onnxruntime.InferenceSession(model_path)\r\nThe gpu memory becomes used about 1.7g\r\n\r\nWhen infers one image as following, the gpu memory becomes used about 2.0g. And the number will not decline when the infererence operation is over.\r\nseg_raw_output = tmp.run([], {self.seg_input_name: seg_input_data})[0]\r\n\r\nTherefore, I want to release some gpu memory occupation to make the occupation return to 1.7g while still keeping the session alive.\r\n\r\nThank you! I am looking forward to your reply!\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/950549553/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951546580",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-951546580",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 951546580,
        "node_id": "IC_kwDOCVq1mM44t3LU",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-26T04:23:37Z",
        "updated_at": "2021-10-26T04:23:37Z",
        "author_association": "MEMBER",
        "body": "Thanks @Z-XQ for the explanation.\r\n\r\nThe GPU memory is backed by a memory pool (arena) and we have a config knob to shrink the arena (de-allocated unused memory chunks). \r\n\r\nNot sure if we have enough tools to accomplish this in Python just yet. The best way to use this feature in C++ is to:\r\n\r\n1) Not allocate weights memory through the arena: See [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1731)\r\n\r\n\r\n2) Configure the arena to have high enough initial chunk to support most Run() calls. See \"initial_chunk_size_bytes\" [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1758)\r\n\r\n3) Finally, configure the arena to shrink on every Run(). See [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1777). This will keep the initial chunk allocated but de-allocate any unused chunk remaining after the Run() call ends.\r\n\r\nFor example, if the initial chunk size is set as 500MB, the first Run() will allocate 500MB + any additional chunks required to service the Run() call. The additional chunks will get de-allocated after Run() and only keep 500MB of memory allocated.  It is important to not allocate weights (initializers) memory through the arena as that complicates the shrinkage. Hence, step (1).\r\n\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951546580/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951584620",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-951584620",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 951584620,
        "node_id": "IC_kwDOCVq1mM44uAds",
        "user": {
            "login": "Z-XQ",
            "id": 37925249,
            "node_id": "MDQ6VXNlcjM3OTI1MjQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/37925249?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Z-XQ",
            "html_url": "https://github.com/Z-XQ",
            "followers_url": "https://api.github.com/users/Z-XQ/followers",
            "following_url": "https://api.github.com/users/Z-XQ/following{/other_user}",
            "gists_url": "https://api.github.com/users/Z-XQ/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Z-XQ/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Z-XQ/subscriptions",
            "organizations_url": "https://api.github.com/users/Z-XQ/orgs",
            "repos_url": "https://api.github.com/users/Z-XQ/repos",
            "events_url": "https://api.github.com/users/Z-XQ/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Z-XQ/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-26T05:53:37Z",
        "updated_at": "2021-10-26T05:53:37Z",
        "author_association": "NONE",
        "body": "> Thanks @Z-XQ for the explanation.\r\n> \r\n> The GPU memory is backed by a memory pool (arena) and we have a config knob to shrink the arena (de-allocated unused memory chunks).\r\n> \r\n> Not sure if we have enough tools to accomplish this in Python just yet. The best way to use this feature in C++ is to:\r\n> \r\n> 1. Not allocate weights memory through the arena: See [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1731)\r\n> 2. Configure the arena to have high enough initial chunk to support most Run() calls. See \"initial_chunk_size_bytes\" [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1758)\r\n> 3. Finally, configure the arena to shrink on every Run(). See [here](https://github.com/microsoft/onnxruntime/blob/651955d3c91be9a1cbb3ce29360758c8347016ad/onnxruntime/test/shared_lib/test_inference.cc#L1777). This will keep the initial chunk allocated but de-allocate any unused chunk remaining after the Run() call ends.\r\n> \r\n> For example, if the initial chunk size is set as 500MB, the first Run() will allocate 500MB + any additional chunks required to service the Run() call. The additional chunks will get de-allocated after Run() and only keep 500MB of memory allocated. It is important to not allocate weights (initializers) memory through the arena as that complicates the shrinkage. Hence, step (1).\r\n\r\nThanks a lot! It's too hard to convert to c++ deployment in a short time. I'll figure out other ways by using python code. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951584620/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951611508",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-951611508",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 951611508,
        "node_id": "IC_kwDOCVq1mM44uHB0",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-26T06:45:47Z",
        "updated_at": "2021-10-26T06:45:47Z",
        "author_association": "MEMBER",
        "body": "Thanks. We will need to support configuring the arena in Python. So, I will mark it an enhancement.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/951611508/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1123518723",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-1123518723",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 1123518723,
        "node_id": "IC_kwDOCVq1mM5C94kD",
        "user": {
            "login": "zlbdzhh",
            "id": 48110436,
            "node_id": "MDQ6VXNlcjQ4MTEwNDM2",
            "avatar_url": "https://avatars.githubusercontent.com/u/48110436?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/zlbdzhh",
            "html_url": "https://github.com/zlbdzhh",
            "followers_url": "https://api.github.com/users/zlbdzhh/followers",
            "following_url": "https://api.github.com/users/zlbdzhh/following{/other_user}",
            "gists_url": "https://api.github.com/users/zlbdzhh/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/zlbdzhh/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zlbdzhh/subscriptions",
            "organizations_url": "https://api.github.com/users/zlbdzhh/orgs",
            "repos_url": "https://api.github.com/users/zlbdzhh/repos",
            "events_url": "https://api.github.com/users/zlbdzhh/events{/privacy}",
            "received_events_url": "https://api.github.com/users/zlbdzhh/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-11T10:17:23Z",
        "updated_at": "2022-05-11T10:17:23Z",
        "author_association": "NONE",
        "body": "When I operated according to what you said, I reported this error in multi gpu\r\n\"Did not find an arena based allocator registered for device-id  combination in the memory arena shrink list: gpu:1\",how can \r\ni do it",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1123518723/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1136039410",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-1136039410",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 1136039410,
        "node_id": "IC_kwDOCVq1mM5DtpXy",
        "user": {
            "login": "codender",
            "id": 21005749,
            "node_id": "MDQ6VXNlcjIxMDA1NzQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/21005749?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/codender",
            "html_url": "https://github.com/codender",
            "followers_url": "https://api.github.com/users/codender/followers",
            "following_url": "https://api.github.com/users/codender/following{/other_user}",
            "gists_url": "https://api.github.com/users/codender/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/codender/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/codender/subscriptions",
            "organizations_url": "https://api.github.com/users/codender/orgs",
            "repos_url": "https://api.github.com/users/codender/repos",
            "events_url": "https://api.github.com/users/codender/events{/privacy}",
            "received_events_url": "https://api.github.com/users/codender/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-24T14:57:21Z",
        "updated_at": "2022-05-24T14:57:21Z",
        "author_association": "NONE",
        "body": "> Thanks. We will need to support configuring the arena in Python. So, I will mark it an enhancement.\r\n\r\nHi, can i release gpu mem in python now?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1136039410/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1414583425",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-1414583425",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 1414583425,
        "node_id": "IC_kwDOCVq1mM5UUNSB",
        "user": {
            "login": "chinmayjog13",
            "id": 37167529,
            "node_id": "MDQ6VXNlcjM3MTY3NTI5",
            "avatar_url": "https://avatars.githubusercontent.com/u/37167529?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chinmayjog13",
            "html_url": "https://github.com/chinmayjog13",
            "followers_url": "https://api.github.com/users/chinmayjog13/followers",
            "following_url": "https://api.github.com/users/chinmayjog13/following{/other_user}",
            "gists_url": "https://api.github.com/users/chinmayjog13/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chinmayjog13/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chinmayjog13/subscriptions",
            "organizations_url": "https://api.github.com/users/chinmayjog13/orgs",
            "repos_url": "https://api.github.com/users/chinmayjog13/repos",
            "events_url": "https://api.github.com/users/chinmayjog13/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chinmayjog13/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-03T01:19:47Z",
        "updated_at": "2023-02-03T01:19:47Z",
        "author_association": "NONE",
        "body": "Hi, any update on this issue?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1414583425/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1641862590",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9509#issuecomment-1641862590",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9509",
        "id": 1641862590,
        "node_id": "IC_kwDOCVq1mM5h3NW-",
        "user": {
            "login": "yingfenging",
            "id": 49307961,
            "node_id": "MDQ6VXNlcjQ5MzA3OTYx",
            "avatar_url": "https://avatars.githubusercontent.com/u/49307961?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yingfenging",
            "html_url": "https://github.com/yingfenging",
            "followers_url": "https://api.github.com/users/yingfenging/followers",
            "following_url": "https://api.github.com/users/yingfenging/following{/other_user}",
            "gists_url": "https://api.github.com/users/yingfenging/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/yingfenging/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/yingfenging/subscriptions",
            "organizations_url": "https://api.github.com/users/yingfenging/orgs",
            "repos_url": "https://api.github.com/users/yingfenging/repos",
            "events_url": "https://api.github.com/users/yingfenging/events{/privacy}",
            "received_events_url": "https://api.github.com/users/yingfenging/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-19T10:51:50Z",
        "updated_at": "2023-07-19T10:51:50Z",
        "author_association": "NONE",
        "body": "@hariharans29    Hi, can i release gpu mem in python now?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1641862590/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]