[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1428895246",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13445#issuecomment-1428895246",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13445",
        "id": 1428895246,
        "node_id": "IC_kwDOCVq1mM5VKzYO",
        "user": {
            "login": "guschmue",
            "id": 22941064,
            "node_id": "MDQ6VXNlcjIyOTQxMDY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/22941064?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/guschmue",
            "html_url": "https://github.com/guschmue",
            "followers_url": "https://api.github.com/users/guschmue/followers",
            "following_url": "https://api.github.com/users/guschmue/following{/other_user}",
            "gists_url": "https://api.github.com/users/guschmue/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/guschmue/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/guschmue/subscriptions",
            "organizations_url": "https://api.github.com/users/guschmue/orgs",
            "repos_url": "https://api.github.com/users/guschmue/repos",
            "events_url": "https://api.github.com/users/guschmue/events{/privacy}",
            "received_events_url": "https://api.github.com/users/guschmue/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-14T00:10:22Z",
        "updated_at": "2023-02-14T00:10:22Z",
        "author_association": "MEMBER",
        "body": "that model once unpacked is a little over 2GB but during model load with have it twice in memory so even with 4GB it doesn't fit. One could try the .ort format that would have some memory. \r\nBut it is sure a large model for a browser - the poor cache!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1428895246/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1429131343",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13445#issuecomment-1429131343",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13445",
        "id": 1429131343,
        "node_id": "IC_kwDOCVq1mM5VLtBP",
        "user": {
            "login": "josephrocca",
            "id": 1167575,
            "node_id": "MDQ6VXNlcjExNjc1NzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1167575?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josephrocca",
            "html_url": "https://github.com/josephrocca",
            "followers_url": "https://api.github.com/users/josephrocca/followers",
            "following_url": "https://api.github.com/users/josephrocca/following{/other_user}",
            "gists_url": "https://api.github.com/users/josephrocca/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/josephrocca/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/josephrocca/subscriptions",
            "organizations_url": "https://api.github.com/users/josephrocca/orgs",
            "repos_url": "https://api.github.com/users/josephrocca/repos",
            "events_url": "https://api.github.com/users/josephrocca/events{/privacy}",
            "received_events_url": "https://api.github.com/users/josephrocca/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-14T05:12:14Z",
        "updated_at": "2023-02-14T05:12:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "Thanks for your reply! Is it necessary to have it twice in memory?\r\n\r\nYeah, the model is big! But it's surprisingly possible to run large models at reasonable speeds in the browser these days (thanks to ORT and friends) - e.g. https://josephrocca.github.io/rwkv-v4-web/demo\r\n\r\nIf it's not to hard to avoid loading models into memory twice, then that would be great! Otherwise I guess Wasm Memory64 will solve this when that eventually lands in browsers.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1429131343/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1430153341",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13445#issuecomment-1430153341",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13445",
        "id": 1430153341,
        "node_id": "IC_kwDOCVq1mM5VPmh9",
        "user": {
            "login": "guschmue",
            "id": 22941064,
            "node_id": "MDQ6VXNlcjIyOTQxMDY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/22941064?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/guschmue",
            "html_url": "https://github.com/guschmue",
            "followers_url": "https://api.github.com/users/guschmue/followers",
            "following_url": "https://api.github.com/users/guschmue/following{/other_user}",
            "gists_url": "https://api.github.com/users/guschmue/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/guschmue/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/guschmue/subscriptions",
            "organizations_url": "https://api.github.com/users/guschmue/orgs",
            "repos_url": "https://api.github.com/users/guschmue/repos",
            "events_url": "https://api.github.com/users/guschmue/events{/privacy}",
            "received_events_url": "https://api.github.com/users/guschmue/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-14T17:58:30Z",
        "updated_at": "2023-02-14T17:58:30Z",
        "author_association": "MEMBER",
        "body": "for the regular onnx files we need to those 2 copies.\r\nThe .ort files are flatbuffers and we should be able to use the initializers without copy.\r\nNeeds some extra session options:\r\n```\r\n  const sessionOption = {\r\n    executionProviders: [\"wasm\"],\r\n    enableMemPattern: false,\r\n    enableCpuMemArena: false,\r\n    extra: {\r\n      session: {\r\n        disable_prepacking: \"1\",\r\n        use_device_allocator_for_initializers: \"0\",\r\n        use_ort_model_bytes_directly: \"1\",\r\n        use_ort_model_bytes_for_initializers: \"1\"\r\n      }\r\n    }\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1430153341/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1431225654",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13445#issuecomment-1431225654",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13445",
        "id": 1431225654,
        "node_id": "IC_kwDOCVq1mM5VTsU2",
        "user": {
            "login": "josephrocca",
            "id": 1167575,
            "node_id": "MDQ6VXNlcjExNjc1NzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1167575?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josephrocca",
            "html_url": "https://github.com/josephrocca",
            "followers_url": "https://api.github.com/users/josephrocca/followers",
            "following_url": "https://api.github.com/users/josephrocca/following{/other_user}",
            "gists_url": "https://api.github.com/users/josephrocca/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/josephrocca/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/josephrocca/subscriptions",
            "organizations_url": "https://api.github.com/users/josephrocca/orgs",
            "repos_url": "https://api.github.com/users/josephrocca/repos",
            "events_url": "https://api.github.com/users/josephrocca/events{/privacy}",
            "received_events_url": "https://api.github.com/users/josephrocca/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-15T11:32:35Z",
        "updated_at": "2023-02-15T11:32:35Z",
        "author_association": "CONTRIBUTOR",
        "body": "That works - thanks! For those coming across this thread in the future, I installed ONNX Runtime with pip, and then ran this:\r\n```\r\npython -m onnxruntime.tools.convert_onnx_models_to_ort myOriginalModel.onnx\r\n```\r\nAnd then I used `myOriginalModel.with_runtime_opt.ort` to create an inference session using the session options given above.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1431225654/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1432238950",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13445#issuecomment-1432238950",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13445",
        "id": 1432238950,
        "node_id": "IC_kwDOCVq1mM5VXjtm",
        "user": {
            "login": "guschmue",
            "id": 22941064,
            "node_id": "MDQ6VXNlcjIyOTQxMDY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/22941064?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/guschmue",
            "html_url": "https://github.com/guschmue",
            "followers_url": "https://api.github.com/users/guschmue/followers",
            "following_url": "https://api.github.com/users/guschmue/following{/other_user}",
            "gists_url": "https://api.github.com/users/guschmue/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/guschmue/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/guschmue/subscriptions",
            "organizations_url": "https://api.github.com/users/guschmue/orgs",
            "repos_url": "https://api.github.com/users/guschmue/repos",
            "events_url": "https://api.github.com/users/guschmue/events{/privacy}",
            "received_events_url": "https://api.github.com/users/guschmue/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-15T23:47:09Z",
        "updated_at": "2023-02-15T23:47:09Z",
        "author_association": "MEMBER",
        "body": "thanks for trying!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1432238950/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]