[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1180948086",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11889#issuecomment-1180948086",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11889",
        "id": 1180948086,
        "node_id": "IC_kwDOCVq1mM5GY9Z2",
        "user": {
            "login": "ytaous",
            "id": 4484531,
            "node_id": "MDQ6VXNlcjQ0ODQ1MzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4484531?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ytaous",
            "html_url": "https://github.com/ytaous",
            "followers_url": "https://api.github.com/users/ytaous/followers",
            "following_url": "https://api.github.com/users/ytaous/following{/other_user}",
            "gists_url": "https://api.github.com/users/ytaous/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ytaous/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ytaous/subscriptions",
            "organizations_url": "https://api.github.com/users/ytaous/orgs",
            "repos_url": "https://api.github.com/users/ytaous/repos",
            "events_url": "https://api.github.com/users/ytaous/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ytaous/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-07-11T22:31:29Z",
        "updated_at": "2022-07-11T22:31:29Z",
        "author_association": "MEMBER",
        "body": "Do u have steps to repro and full stack?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1180948086/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460928005",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11889#issuecomment-1460928005",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11889",
        "id": 1460928005,
        "node_id": "IC_kwDOCVq1mM5XE_4F",
        "user": {
            "login": "mreso",
            "id": 13337103,
            "node_id": "MDQ6VXNlcjEzMzM3MTAz",
            "avatar_url": "https://avatars.githubusercontent.com/u/13337103?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mreso",
            "html_url": "https://github.com/mreso",
            "followers_url": "https://api.github.com/users/mreso/followers",
            "following_url": "https://api.github.com/users/mreso/following{/other_user}",
            "gists_url": "https://api.github.com/users/mreso/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mreso/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mreso/subscriptions",
            "organizations_url": "https://api.github.com/users/mreso/orgs",
            "repos_url": "https://api.github.com/users/mreso/repos",
            "events_url": "https://api.github.com/users/mreso/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mreso/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-08T21:54:52Z",
        "updated_at": "2023-03-08T21:56:05Z",
        "author_association": "NONE",
        "body": "Hi @ytaous,\r\n\r\nI am not the original poster so I don't know if this is the same cause but I stumbled over the same error message looking into a different issue.\r\n\r\nMy env is:\r\nPytorch 1.13.1\r\nORT 1.14.1\r\nLet me know if you need more info.\r\n\r\nRepro:\r\n\r\n```python\r\nfrom typing import Tuple, List \r\nimport torch\r\nimport torch.nn as nn\r\nimport onnxruntime as ort\r\n\r\nclass Foo(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n\r\n        self.fc_1 = nn.Linear(1, 1)\r\n        self.fc_2 = nn.Linear(1, 1)\r\n\r\n    def forward(self, x : List[Tuple[torch.Tensor]]) -> torch.Tensor:\r\n        return self.fc_1(x[0][0]) + self.fc_2(x[1][0])\r\n\r\n\r\nmodel = Foo()\r\n\r\ndummy_input = (torch.rand(1),), (torch.rand(1),)\r\nprint(dummy_input)\r\nprint(model(dummy_input))\r\n\r\nscripted_model = torch.jit.script(model, example_inputs=dummy_input)\r\n\r\ninput_names = [ \"actual_input_1\" ] + [ \"learned_%d\" % i for i in range(4) ]\r\noutput_names = [ \"output1\" ]\r\n\r\ntorch.onnx.export(scripted_model, [dummy_input], \"model.onnx\", verbose=True, input_names=input_names, output_names=output_names)\r\n\r\nort_session = ort.InferenceSession(\"model.onnx\")\r\n```\r\nOutput:\r\n```\r\n((tensor([0.3086]),), (tensor([0.6852]),))\r\ntensor([-0.6065], grad_fn=<AddBackward0>)\r\n/Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/torch/jit/_script.py:1280: UserWarning: Warning: monkeytype is not installed. Please install https://github.com/Instagram/MonkeyType to enable Profile-Directed Typing in TorchScript. Refer to https://github.com/Instagram/MonkeyType/blob/master/README.rst to install MonkeyType.\r\n  warnings.warn(\"Warning: monkeytype is not installed. Please install https://github.com/Instagram/MonkeyType \"\r\nExported graph: graph(%actual_input_1 : (Float(1, strides=[1], requires_grad=0, device=cpu))[],\r\n      %learned_1 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cpu),\r\n      %learned_3 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cpu),\r\n      %onnx::MatMul_16 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cpu),\r\n      %onnx::MatMul_17 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cpu)):\r\n  %/Constant_output_0 : Long(device=cpu) = onnx::Constant[value={0}, onnx_name=\"/Constant\"](), scope: Foo:: # /Users/mreso/Projects/playground/onnx/export.py:16:25\r\n  %/Gather_output_0 : Tensor = onnx::Gather[axis=0, onnx_name=\"/Gather\"](%actual_input_1, %/Constant_output_0), scope: Foo:: # /Users/mreso/Projects/playground/onnx/export.py:16:25\r\n  %/fc_1/MatMul_output_0 : Tensor = onnx::MatMul[onnx_name=\"/fc_1/MatMul\"](%/Gather_output_0, %onnx::MatMul_16), scope: Foo::/torch.nn.modules.linear.Linear::fc_1 # /Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/torch/nn/modules/linear.py:114:15\r\n  %/fc_1/Add_output_0 : FloatTensor(device=cpu) = onnx::Add[onnx_name=\"/fc_1/Add\"](%learned_1, %/fc_1/MatMul_output_0), scope: Foo::/torch.nn.modules.linear.Linear::fc_1 # /Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/torch/nn/modules/linear.py:114:15\r\n  %/Constant_1_output_0 : Long(device=cpu) = onnx::Constant[value={1}, onnx_name=\"/Constant_1\"](), scope: Foo:: # /Users/mreso/Projects/playground/onnx/export.py:16:46\r\n  %/Gather_1_output_0 : Tensor = onnx::Gather[axis=0, onnx_name=\"/Gather_1\"](%actual_input_1, %/Constant_1_output_0), scope: Foo:: # /Users/mreso/Projects/playground/onnx/export.py:16:46\r\n  %/fc_2/MatMul_output_0 : Tensor = onnx::MatMul[onnx_name=\"/fc_2/MatMul\"](%/Gather_1_output_0, %onnx::MatMul_17), scope: Foo::/torch.nn.modules.linear.Linear::fc_2 # /Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/torch/nn/modules/linear.py:114:15\r\n  %/fc_2/Add_output_0 : FloatTensor(device=cpu) = onnx::Add[onnx_name=\"/fc_2/Add\"](%learned_3, %/fc_2/MatMul_output_0), scope: Foo::/torch.nn.modules.linear.Linear::fc_2 # /Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/torch/nn/modules/linear.py:114:15\r\n  %output1 : Float(*, strides=[1], requires_grad=1, device=cpu) = onnx::Add[onnx_name=\"/Add\"](%/fc_1/Add_output_0, %/fc_2/Add_output_0), scope: Foo:: # /Users/mreso/Projects/playground/onnx/export.py:16:15\r\n  return (%output1)\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mreso/Projects/playground/onnx/export.py\", line 32, in <module>\r\n    ort_session = ort.InferenceSession(\"model.onnx\")\r\n  File \"/Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py\", line 360, in __init__\r\n    self._create_inference_session(providers, provider_options, disabled_optimizers)\r\n  File \"/Users/mreso/miniconda3/envs/onnx/lib/python3.9/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py\", line 397, in _create_inference_session\r\n    sess = C.InferenceSession(session_options, self._model_path, True, self._read_config_from_model)\r\nonnxruntime.capi.onnxruntime_pybind11_state.Fail: [ONNXRuntimeError] : 1 : FAIL : Load model from model.onnx failed:Unsuported type proto value case.\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460928005/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1461017813",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11889#issuecomment-1461017813",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11889",
        "id": 1461017813,
        "node_id": "IC_kwDOCVq1mM5XFVzV",
        "user": {
            "login": "mitchelldehaven",
            "id": 47208251,
            "node_id": "MDQ6VXNlcjQ3MjA4MjUx",
            "avatar_url": "https://avatars.githubusercontent.com/u/47208251?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mitchelldehaven",
            "html_url": "https://github.com/mitchelldehaven",
            "followers_url": "https://api.github.com/users/mitchelldehaven/followers",
            "following_url": "https://api.github.com/users/mitchelldehaven/following{/other_user}",
            "gists_url": "https://api.github.com/users/mitchelldehaven/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mitchelldehaven/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mitchelldehaven/subscriptions",
            "organizations_url": "https://api.github.com/users/mitchelldehaven/orgs",
            "repos_url": "https://api.github.com/users/mitchelldehaven/repos",
            "events_url": "https://api.github.com/users/mitchelldehaven/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mitchelldehaven/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-08T23:16:07Z",
        "updated_at": "2023-03-08T23:16:07Z",
        "author_association": "NONE",
        "body": "I'm running into this same issue, albeit in a slightly more complicated case of a custom operator. I'm able to reproduce @mreso 's example as well with the same `pytorch` and `onnxruntime` versions.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1461017813/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]