[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1447274049",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1447274049",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1447274049,
        "node_id": "IC_kwDOCVq1mM5WQ6ZB",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-27T23:23:04Z",
        "updated_at": "2023-02-27T23:23:04Z",
        "author_association": "MEMBER",
        "body": "the generated .wasm file size can be reduced when build from source.\r\n\r\n- general build flags. The following build flags are used in onnxruntime-web release. If you don't need the corresponding features you can build without those flags. This may reduce ~3MB on the file size.\r\n    - `--use_xnnpack`: if you don't need the XNNPACK EP (which potentially run faster on some models), you can build without this flag.\r\n    - `--use_extensions --cmake_extra_defines onnxruntime_WEBASSEMBLY_DEFAULT_EXTENSION_FLAGS=ON`: if you don't need onnxruntime extensions (for preprocess/postprocess, eg. tokenizers, image normalization), you can build without these flags.\r\n    - `--enable_wasm_api_exception_catching`: without this flag, any onnxruntime error will cause abort in web assembly instance. if you are sure your code will not cause any onnxruntime error (usually because of invalid model/input), you can build without this flag.\r\n\r\n- minimal build. [Minimal build](https://onnxruntime.ai/docs/build/custom.html#minimal-build) excluded quite a lot code and can significantly reduce the file size. However, with a minimal build, you can only load the [ORT format model](https://onnxruntime.ai/docs/reference/ort-format-models.html). An .onnx model need to be converted into an .ort model to work with minimal build ORT.\r\n\r\n- using a config file to further reduce the file size. Checkout the links below:\r\n    - [Reduced operator config file](https://onnxruntime.ai/docs/reference/operators/reduced-operator-config-file.html)\r\n    - [converting ONNX models to ORT format](https://onnxruntime.ai/docs/reference/ort-format-models.html)\r\n\r\nWhen you use all of the ways above, the final .wasm file size can be reduced to ~2MB (may vary depending on the actual model used). However, it requires quite a few steps to acheive. It's developer's decision whether to do the optimizations considering it may take nontrivial efforts to get there.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1447274049/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1447792554",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1447792554",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1447792554,
        "node_id": "IC_kwDOCVq1mM5WS4-q",
        "user": {
            "login": "liuyingbin123",
            "id": 40049781,
            "node_id": "MDQ6VXNlcjQwMDQ5Nzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/40049781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/liuyingbin123",
            "html_url": "https://github.com/liuyingbin123",
            "followers_url": "https://api.github.com/users/liuyingbin123/followers",
            "following_url": "https://api.github.com/users/liuyingbin123/following{/other_user}",
            "gists_url": "https://api.github.com/users/liuyingbin123/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/liuyingbin123/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/liuyingbin123/subscriptions",
            "organizations_url": "https://api.github.com/users/liuyingbin123/orgs",
            "repos_url": "https://api.github.com/users/liuyingbin123/repos",
            "events_url": "https://api.github.com/users/liuyingbin123/events{/privacy}",
            "received_events_url": "https://api.github.com/users/liuyingbin123/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-28T08:49:37Z",
        "updated_at": "2023-02-28T08:49:37Z",
        "author_association": "NONE",
        "body": "> \r\n\r\nthanks very much",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1447792554/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1450073834",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1450073834",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1450073834,
        "node_id": "IC_kwDOCVq1mM5Wbl7q",
        "user": {
            "login": "liuyingbin123",
            "id": 40049781,
            "node_id": "MDQ6VXNlcjQwMDQ5Nzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/40049781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/liuyingbin123",
            "html_url": "https://github.com/liuyingbin123",
            "followers_url": "https://api.github.com/users/liuyingbin123/followers",
            "following_url": "https://api.github.com/users/liuyingbin123/following{/other_user}",
            "gists_url": "https://api.github.com/users/liuyingbin123/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/liuyingbin123/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/liuyingbin123/subscriptions",
            "organizations_url": "https://api.github.com/users/liuyingbin123/orgs",
            "repos_url": "https://api.github.com/users/liuyingbin123/repos",
            "events_url": "https://api.github.com/users/liuyingbin123/events{/privacy}",
            "received_events_url": "https://api.github.com/users/liuyingbin123/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-01T12:31:40Z",
        "updated_at": "2023-03-01T12:31:40Z",
        "author_association": "NONE",
        "body": "> the generated .wasm file size can be reduced when build from source.\r\n> \r\n> * general build flags. The following build flags are used in onnxruntime-web release. If you don't need the corresponding features you can build without those flags. This may reduce ~3MB on the file size.\r\n>   \r\n>   * `--use_xnnpack`: if you don't need the XNNPACK EP (which potentially run faster on some models), you can build without this flag.\r\n>   * `--use_extensions --cmake_extra_defines onnxruntime_WEBASSEMBLY_DEFAULT_EXTENSION_FLAGS=ON`: if you don't need onnxruntime extensions (for preprocess/postprocess, eg. tokenizers, image normalization), you can build without these flags.\r\n>   * `--enable_wasm_api_exception_catching`: without this flag, any onnxruntime error will cause abort in web assembly instance. if you are sure your code will not cause any onnxruntime error (usually because of invalid model/input), you can build without this flag.\r\n> * minimal build. [Minimal build](https://onnxruntime.ai/docs/build/custom.html#minimal-build) excluded quite a lot code and can significantly reduce the file size. However, with a minimal build, you can only load the [ORT format model](https://onnxruntime.ai/docs/reference/ort-format-models.html). An .onnx model need to be converted into an .ort model to work with minimal build ORT.\r\n> * using a config file to further reduce the file size. Checkout the links below:\r\n>   \r\n>   * [Reduced operator config file](https://onnxruntime.ai/docs/reference/operators/reduced-operator-config-file.html)\r\n>   * [converting ONNX models to ORT format](https://onnxruntime.ai/docs/reference/ort-format-models.html)\r\n> \r\n> When you use all of the ways above, the final .wasm file size can be reduced to ~2MB (may vary depending on the actual model used). However, it requires quite a few steps to acheive. It's developer's decision whether to do the optimizations considering it may take nontrivial efforts to get there.\r\n\r\ni have a question. why i do not get the ort.min.js file.\r\nmy build command is:\r\n./build.sh --config Release --build_wasm --skip_tests --disable_wasm_exception_catching --disable_rtti --enable_wasm_threads --enable_wasm_simd",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1450073834/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1451043771",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1451043771",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1451043771,
        "node_id": "IC_kwDOCVq1mM5WfSu7",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-01T23:52:23Z",
        "updated_at": "2023-03-01T23:52:23Z",
        "author_association": "MEMBER",
        "body": "this is the first step of building onnxruntime web. This step builds the web assembly artifacts.\r\n\r\nthe second step is to build the typescript source code and generate the final ort.min.js file.\r\n\r\nhttps://onnxruntime.ai/docs/build/web.html",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1451043771/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1451516451",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1451516451",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1451516451,
        "node_id": "IC_kwDOCVq1mM5WhGIj",
        "user": {
            "login": "liuyingbin123",
            "id": 40049781,
            "node_id": "MDQ6VXNlcjQwMDQ5Nzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/40049781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/liuyingbin123",
            "html_url": "https://github.com/liuyingbin123",
            "followers_url": "https://api.github.com/users/liuyingbin123/followers",
            "following_url": "https://api.github.com/users/liuyingbin123/following{/other_user}",
            "gists_url": "https://api.github.com/users/liuyingbin123/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/liuyingbin123/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/liuyingbin123/subscriptions",
            "organizations_url": "https://api.github.com/users/liuyingbin123/orgs",
            "repos_url": "https://api.github.com/users/liuyingbin123/repos",
            "events_url": "https://api.github.com/users/liuyingbin123/events{/privacy}",
            "received_events_url": "https://api.github.com/users/liuyingbin123/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-02T08:57:45Z",
        "updated_at": "2023-03-02T08:58:50Z",
        "author_association": "NONE",
        "body": "> this is the first step of building onnxruntime web. This step builds the web assembly artifacts.\r\n> \r\n> the second step is to build the typescript source code and generate the final ort.min.js file.\r\n> \r\n> https://onnxruntime.ai/docs/build/web.html\r\n\r\n**when i use this comand to compile onnxruntime:**\r\n./build.sh --config Release  --build_wasm --skip_tests --parallel --disable_wasm_exception_catching --disable_rtti --use_xnnpack --minimal_build extend --disable_contrib_ops  --disable_ml_ops --enable_reduced_operator_type_support --include_ops_by_config /home/doctorimage/web_fp32.all.required_operators_and_types.config  --build_dir \"/home/doctorimage/onnxruntime/build/wasm\r\n\r\n**i got this error:**\r\n\r\n\r\n/home/doctorimage/onnxruntime/cmake/external/emsdk/upstream/emscripten/cache/sysroot/include/c++/v1/__memory/allocator.h:114:58: error: invalid application of 'sizeof' to an incomplete type 'onnxruntime::QDQ::NodeGroup'\r\n            _VSTD::__libcpp_deallocate((void*)__p, __n * sizeof(_Tp), _LIBCPP_ALIGNOF(_Tp));\r\n                                                         ^~~~~~~~~~~\r\n/home/doctorimage/onnxruntime/cmake/external/emsdk/upstream/emscripten/cache/sysroot/include/c++/v1/__memory/allocator_traits.h:282:13: note: in instantiation of member function 'std::allocator<onnxruntime::QDQ::NodeGroup>::deallocate' requested here\r\n        __a.deallocate(__p, __n);\r\n            ^\r\n/home/doctorimage/onnxruntime/cmake/external/emsdk/upstream/emscripten/cache/sysroot/include/c++/v1/vector:402:25: note: in instantiation of member function 'std::allocator_traits<std::allocator<onnxruntime::QDQ::NodeGroup>>::deallocate' requested here\r\n        __alloc_traits::deallocate(__alloc(), this->__begin_, capacity());\r\n                        ^\r\n/home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.cc:288:44: note: in instantiation of member function 'std::vector<onnxruntime::QDQ::NodeGroup>::~vector' requested here\r\n  const auto qdq_selections = selector_mgr.GetQDQSelections(graph_viewer);\r\n                                           ^\r\n/home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.h:21:8: note: forward declaration of 'onnxruntime::QDQ::NodeGroup'\r\nstruct NodeGroup;\r\n       ^\r\nIn file included from /home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.cc:4:\r\nIn file included from /home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.h:8:\r\n/home/doctorimage/onnxruntime/cmake/external/emsdk/upstream/emscripten/cache/sysroot/include/c++/v1/vector:508:52: error: arithmetic on a pointer to an incomplete type 'onnxruntime::QDQ::NodeGroup'\r\n        {return static_cast<size_type>(__end_cap() - this->__begin_);}\r\n                                       ~~~~~~~~~~~ ^\r\n/home/doctorimage/onnxruntime/cmake/external/emsdk/upstream/emscripten/cache/sysroot/include/c++/v1/vector:402:63: note: in instantiation of member function 'std::vector<onnxruntime::QDQ::NodeGroup>::capacity' requested here\r\n        __alloc_traits::deallocate(__alloc(), this->__begin_, capacity());\r\n                                                              ^\r\n/home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.cc:288:44: note: in instantiation of member function 'std::vector<onnxruntime::QDQ::NodeGroup>::~vector' requested here\r\n  const auto qdq_selections = selector_mgr.GetQDQSelections(graph_viewer);\r\n                                           ^\r\n/home/doctorimage/onnxruntime/onnxruntime/core/providers/shared/node_unit/node_unit.h:21:8: note: forward declaration of 'onnxruntime::QDQ::NodeGroup'\r\nstruct NodeGroup;\r\n       ^\r\n14 errors generated.\r\n\r\n**without --use_xnnpack, it works fine.**",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1451516451/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1452602834",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14817#issuecomment-1452602834",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14817",
        "id": 1452602834,
        "node_id": "IC_kwDOCVq1mM5WlPXS",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-02T21:57:10Z",
        "updated_at": "2023-03-02T21:57:10Z",
        "author_association": "MEMBER",
        "body": "it looks like that `struct onnxruntime::QDQ::NodeGroup` is not defined in minimal build (`ORT_MINIMAL_BUILD`) (qdq_selectors.h), but function `GetAllNodeUnits()` (node_unit.cc) uses it. This breaks the minimal build. @skottmckay could you help to take a look?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1452602834/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]