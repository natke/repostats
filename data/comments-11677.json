[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1142892494",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1142892494",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1142892494,
        "node_id": "IC_kwDOCVq1mM5EHyfO",
        "user": {
            "login": "RyanUnderhill",
            "id": 38674843,
            "node_id": "MDQ6VXNlcjM4Njc0ODQz",
            "avatar_url": "https://avatars.githubusercontent.com/u/38674843?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/RyanUnderhill",
            "html_url": "https://github.com/RyanUnderhill",
            "followers_url": "https://api.github.com/users/RyanUnderhill/followers",
            "following_url": "https://api.github.com/users/RyanUnderhill/following{/other_user}",
            "gists_url": "https://api.github.com/users/RyanUnderhill/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/RyanUnderhill/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/RyanUnderhill/subscriptions",
            "organizations_url": "https://api.github.com/users/RyanUnderhill/orgs",
            "repos_url": "https://api.github.com/users/RyanUnderhill/repos",
            "events_url": "https://api.github.com/users/RyanUnderhill/events{/privacy}",
            "received_events_url": "https://api.github.com/users/RyanUnderhill/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-06-01T00:42:39Z",
        "updated_at": "2022-06-01T00:42:39Z",
        "author_association": "MEMBER",
        "body": "In pytorch, contiguous() just ensures the data in the tensor is contiguous in memory. In onnxruntime the data returned by 'GetTensorMutableData()' is always contiguous, so this shouldn't be needed.\r\n\r\nI'm not sure how the ordering of the memory would affect it being gray vs rgb, can you give more details?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1142892494/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1143048647",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1143048647",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1143048647,
        "node_id": "IC_kwDOCVq1mM5EIYnH",
        "user": {
            "login": "djdll",
            "id": 57391029,
            "node_id": "MDQ6VXNlcjU3MzkxMDI5",
            "avatar_url": "https://avatars.githubusercontent.com/u/57391029?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/djdll",
            "html_url": "https://github.com/djdll",
            "followers_url": "https://api.github.com/users/djdll/followers",
            "following_url": "https://api.github.com/users/djdll/following{/other_user}",
            "gists_url": "https://api.github.com/users/djdll/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/djdll/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/djdll/subscriptions",
            "organizations_url": "https://api.github.com/users/djdll/orgs",
            "repos_url": "https://api.github.com/users/djdll/repos",
            "events_url": "https://api.github.com/users/djdll/events{/privacy}",
            "received_events_url": "https://api.github.com/users/djdll/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-06-01T02:22:09Z",
        "updated_at": "2022-06-01T02:22:09Z",
        "author_association": "NONE",
        "body": "I finally solved the problem by converting float* floatarr = ort_outputs[0].GetTensorMutableData<float>(); to a tensor and then saving it as a mat. I suspect that since I'm saving an rgb image, I can't convert float* floatarr to mat directly and need to go through a Tensor as an intermediary.\r\nHere's how I found it on the web hopefully it will help others:\r\n`std::vector<cv::Mat> results;\r\n\ttorch::Tensor result_r = torch::from_blob(floatarr, { sr_h,sr_w,1 });\r\n\ttorch::Tensor result_g = torch::from_blob(&floatarr[sr_h * sr_w - 1], { sr_h,sr_w,1 });\r\n\ttorch::Tensor result_b = torch::from_blob(&floatarr[sr_h * sr_w * 2 - 1], { sr_h,sr_w,1 });\r\n\ttorch::Tensor result = torch::cat({ result_r, result_g, result_b }, 2);\r\n\tresult = result.mul(255);\r\n\tresult = result.clamp(0, 255);\r\n\tresult = result.to(torch::kU8);\r\n\tcv::Mat resultImg(sr_h, sr_w, CV_8UC3);\r\n\tstd::memcpy((void*)resultImg.data, result.data_ptr(), sizeof(torch::kU8)* result.numel());\r\n\t//cv::cvtColor(resultImg, resultImg, cv::COLOR_RGB2BGR);\r\n\tresults.push_back(resultImg);`",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1143048647/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1143049896",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1143049896",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1143049896,
        "node_id": "IC_kwDOCVq1mM5EIY6o",
        "user": {
            "login": "djdll",
            "id": 57391029,
            "node_id": "MDQ6VXNlcjU3MzkxMDI5",
            "avatar_url": "https://avatars.githubusercontent.com/u/57391029?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/djdll",
            "html_url": "https://github.com/djdll",
            "followers_url": "https://api.github.com/users/djdll/followers",
            "following_url": "https://api.github.com/users/djdll/following{/other_user}",
            "gists_url": "https://api.github.com/users/djdll/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/djdll/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/djdll/subscriptions",
            "organizations_url": "https://api.github.com/users/djdll/orgs",
            "repos_url": "https://api.github.com/users/djdll/repos",
            "events_url": "https://api.github.com/users/djdll/events{/privacy}",
            "received_events_url": "https://api.github.com/users/djdll/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-06-01T02:24:51Z",
        "updated_at": "2022-06-01T02:24:51Z",
        "author_association": "NONE",
        "body": "@RyanUnderhill The key to this problem I think is the problem of converting float * floatarr to three-channel mat, if you have a more official solution, please tell me more",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1143049896/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263796754",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1263796754",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1263796754,
        "node_id": "IC_kwDOCVq1mM5LVAIS",
        "user": {
            "login": "kikirizki",
            "id": 7989381,
            "node_id": "MDQ6VXNlcjc5ODkzODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7989381?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kikirizki",
            "html_url": "https://github.com/kikirizki",
            "followers_url": "https://api.github.com/users/kikirizki/followers",
            "following_url": "https://api.github.com/users/kikirizki/following{/other_user}",
            "gists_url": "https://api.github.com/users/kikirizki/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kikirizki/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kikirizki/subscriptions",
            "organizations_url": "https://api.github.com/users/kikirizki/orgs",
            "repos_url": "https://api.github.com/users/kikirizki/repos",
            "events_url": "https://api.github.com/users/kikirizki/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kikirizki/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-30T16:47:10Z",
        "updated_at": "2022-09-30T16:47:10Z",
        "author_association": "NONE",
        "body": "@djdll Hi did you find another solution without libtorch?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263796754/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263797689",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1263797689",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1263797689,
        "node_id": "IC_kwDOCVq1mM5LVAW5",
        "user": {
            "login": "kikirizki",
            "id": 7989381,
            "node_id": "MDQ6VXNlcjc5ODkzODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7989381?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kikirizki",
            "html_url": "https://github.com/kikirizki",
            "followers_url": "https://api.github.com/users/kikirizki/followers",
            "following_url": "https://api.github.com/users/kikirizki/following{/other_user}",
            "gists_url": "https://api.github.com/users/kikirizki/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kikirizki/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kikirizki/subscriptions",
            "organizations_url": "https://api.github.com/users/kikirizki/orgs",
            "repos_url": "https://api.github.com/users/kikirizki/repos",
            "events_url": "https://api.github.com/users/kikirizki/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kikirizki/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-30T16:48:12Z",
        "updated_at": "2022-09-30T16:48:12Z",
        "author_association": "NONE",
        "body": "I have the same problem where my cv::Mat is not contiguous\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263797689/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263802956",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1263802956",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1263802956,
        "node_id": "IC_kwDOCVq1mM5LVBpM",
        "user": {
            "login": "kikirizki",
            "id": 7989381,
            "node_id": "MDQ6VXNlcjc5ODkzODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7989381?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kikirizki",
            "html_url": "https://github.com/kikirizki",
            "followers_url": "https://api.github.com/users/kikirizki/followers",
            "following_url": "https://api.github.com/users/kikirizki/following{/other_user}",
            "gists_url": "https://api.github.com/users/kikirizki/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kikirizki/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kikirizki/subscriptions",
            "organizations_url": "https://api.github.com/users/kikirizki/orgs",
            "repos_url": "https://api.github.com/users/kikirizki/repos",
            "events_url": "https://api.github.com/users/kikirizki/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kikirizki/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-30T16:53:59Z",
        "updated_at": "2022-09-30T16:53:59Z",
        "author_association": "NONE",
        "body": "@djdll it also happened on python but it can be solved with this following code\r\n\r\n`        img is not contiguous\r\n        \r\n        # First slice missing dims\r\n        N_slice = 0 if 'N' not in format else slice(None)\r\n        H_slice = 0 if 'H' not in format else slice(None)\r\n        W_slice = 0 if 'W' not in format else slice(None)\r\n        C_slice = 0 if 'C' not in format else slice(None)\r\n        img = img[N_slice, H_slice, W_slice, C_slice]\r\n\r\n        f = ''\r\n        if 'N' in format: f += 'N'\r\n        if 'H' in format: f += 'H'\r\n        if 'W' in format: f += 'W'\r\n        if 'C' in format: f += 'C'\r\n\r\n        if f != format:\r\n            # Transpose to target\r\n            d = { s:i for i,s in enumerate(f) }\r\n            transpose_order = [ d[s] for s in format ]\r\n            img = img.transpose(transpose_order)\r\n\r\n        return np.ascontiguousarray(img)`",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1263802956/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264174971",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/11677#issuecomment-1264174971",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/11677",
        "id": 1264174971,
        "node_id": "IC_kwDOCVq1mM5LWcd7",
        "user": {
            "login": "djdll",
            "id": 57391029,
            "node_id": "MDQ6VXNlcjU3MzkxMDI5",
            "avatar_url": "https://avatars.githubusercontent.com/u/57391029?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/djdll",
            "html_url": "https://github.com/djdll",
            "followers_url": "https://api.github.com/users/djdll/followers",
            "following_url": "https://api.github.com/users/djdll/following{/other_user}",
            "gists_url": "https://api.github.com/users/djdll/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/djdll/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/djdll/subscriptions",
            "organizations_url": "https://api.github.com/users/djdll/orgs",
            "repos_url": "https://api.github.com/users/djdll/repos",
            "events_url": "https://api.github.com/users/djdll/events{/privacy}",
            "received_events_url": "https://api.github.com/users/djdll/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-01T00:48:13Z",
        "updated_at": "2022-10-01T00:48:13Z",
        "author_association": "NONE",
        "body": "@kikirizki If you are using torch(pytorch/libtorch), you can try a = a.contiguous(); If you are not using torch you can try to process the three channels of the image separately before merging the final output, I don't know if it can help you",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264174971/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]