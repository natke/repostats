[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1552478261",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15962#issuecomment-1552478261",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15962",
        "id": 1552478261,
        "node_id": "IC_kwDOCVq1mM5ciPA1",
        "user": {
            "login": "satyajandhyala",
            "id": 26722914,
            "node_id": "MDQ6VXNlcjI2NzIyOTE0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26722914?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/satyajandhyala",
            "html_url": "https://github.com/satyajandhyala",
            "followers_url": "https://api.github.com/users/satyajandhyala/followers",
            "following_url": "https://api.github.com/users/satyajandhyala/following{/other_user}",
            "gists_url": "https://api.github.com/users/satyajandhyala/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/satyajandhyala/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/satyajandhyala/subscriptions",
            "organizations_url": "https://api.github.com/users/satyajandhyala/orgs",
            "repos_url": "https://api.github.com/users/satyajandhyala/repos",
            "events_url": "https://api.github.com/users/satyajandhyala/events{/privacy}",
            "received_events_url": "https://api.github.com/users/satyajandhyala/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-18T06:05:27Z",
        "updated_at": "2023-05-18T06:05:27Z",
        "author_association": "MEMBER",
        "body": "I ran this test and dumped valgrind verbose report.\r\nPlease check a very detailed explanation to the exact same problem. It appears that there is no clean way to free this memory created by nsync library.\r\nhttps://github.com/tensorflow/tensorflow/issues/21582\r\n\r\nThe memory is allocated here \r\n==29640== 800 bytes in 2 blocks are possibly lost in loss record 13 of 13\r\n==29640==    at 0x4848899: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)\r\n==29640==    by 0x5A97417: nsync::nsync_waiter_new_() (common.c:189)\r\n==29640==    by 0x5A94D33: nsync::nsync_cv_wait_with_deadline_generic(nsync::nsync_cv_s_*, void*, void (*)(void*), void (*)(void*), timespec, nsync::nsync_note_s_*) (cv.c:195)\r\n==29640==    by 0x5A95518: nsync::nsync_cv_wait_with_deadline(nsync::nsync_cv_s_*, nsync::nsync_mu_s_*, timespec, nsync::nsync_note_s_*) (cv.c:438)\r\n==29640==    by 0x5A95559: nsync::nsync_cv_wait(nsync::nsync_cv_s_*, nsync::nsync_mu_s_*) (cv.c:450)\r\n==29640==    by 0x586C595: onnxruntime::OrtCondVar::wait(std::unique_lock<onnxruntime::OrtMutex>&) (ort_mutex.cc:39)\r\n==29640==    by 0x585E407: onnxruntime::concurrency::ThreadPoolTempl<onnxruntime::Env>::WorkerData::SetBlocked(std::function<bool ()>, std::function<void ()>) (EigenNonBlockingThreadPool.h:1451)\r\n==29640==    by 0x585CA85: onnxruntime::concurrency::ThreadPoolTempl<onnxruntime::Env>::WorkerLoop(int) (EigenNonBlockingThreadPool.h:1534)\r\n==29640==    by 0x585B5DD: onnxruntime::concurrency::ThreadPoolTempl<onnxruntime::Env>::WorkerLoop(int, Eigen::ThreadPoolInterface*) (EigenNonBlockingThreadPool.h:678)\r\n==29640==    by 0x58671C5: onnxruntime::(anonymous namespace)::PosixThread::ThreadMain(void*) (env.cc:280)\r\n==29640==    by 0x68C4B42: start_thread (pthread_create.c:442)\r\n==29640==    by 0x6955BB3: clone (clone.S:100)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1552478261/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1553924154",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15962#issuecomment-1553924154",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15962",
        "id": 1553924154,
        "node_id": "IC_kwDOCVq1mM5cnwA6",
        "user": {
            "login": "satyajandhyala",
            "id": 26722914,
            "node_id": "MDQ6VXNlcjI2NzIyOTE0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26722914?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/satyajandhyala",
            "html_url": "https://github.com/satyajandhyala",
            "followers_url": "https://api.github.com/users/satyajandhyala/followers",
            "following_url": "https://api.github.com/users/satyajandhyala/following{/other_user}",
            "gists_url": "https://api.github.com/users/satyajandhyala/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/satyajandhyala/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/satyajandhyala/subscriptions",
            "organizations_url": "https://api.github.com/users/satyajandhyala/orgs",
            "repos_url": "https://api.github.com/users/satyajandhyala/repos",
            "events_url": "https://api.github.com/users/satyajandhyala/events{/privacy}",
            "received_events_url": "https://api.github.com/users/satyajandhyala/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-19T02:41:25Z",
        "updated_at": "2023-05-19T02:41:25Z",
        "author_association": "MEMBER",
        "body": "@icetube23 Please check my reply and let me know if you have any questions.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1553924154/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1554192137",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15962#issuecomment-1554192137",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15962",
        "id": 1554192137,
        "node_id": "IC_kwDOCVq1mM5coxcJ",
        "user": {
            "login": "icetube23",
            "id": 34234056,
            "node_id": "MDQ6VXNlcjM0MjM0MDU2",
            "avatar_url": "https://avatars.githubusercontent.com/u/34234056?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/icetube23",
            "html_url": "https://github.com/icetube23",
            "followers_url": "https://api.github.com/users/icetube23/followers",
            "following_url": "https://api.github.com/users/icetube23/following{/other_user}",
            "gists_url": "https://api.github.com/users/icetube23/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/icetube23/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/icetube23/subscriptions",
            "organizations_url": "https://api.github.com/users/icetube23/orgs",
            "repos_url": "https://api.github.com/users/icetube23/repos",
            "events_url": "https://api.github.com/users/icetube23/events{/privacy}",
            "received_events_url": "https://api.github.com/users/icetube23/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-19T07:58:32Z",
        "updated_at": "2023-05-19T07:58:32Z",
        "author_association": "NONE",
        "body": "Thanks a lot for your help! This solves all questions I had related to this issue.\r\n\r\nI'll quickly summarize what I take away from the link you provided:\r\n- There is no obvious (multi-threading related) user error in the code example I provided\r\n- The possibly lost blocks Valgrind complains about are coming from the nsync library, this memory is not actually leaked but only reused with in nsync in a way that Valgrind does not like (using interior pointers)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1554192137/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]