[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1258408077",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13088#issuecomment-1258408077",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13088",
        "id": 1258408077,
        "node_id": "IC_kwDOCVq1mM5LAciN",
        "user": {
            "login": "GeorgeS2019",
            "id": 49812372,
            "node_id": "MDQ6VXNlcjQ5ODEyMzcy",
            "avatar_url": "https://avatars.githubusercontent.com/u/49812372?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GeorgeS2019",
            "html_url": "https://github.com/GeorgeS2019",
            "followers_url": "https://api.github.com/users/GeorgeS2019/followers",
            "following_url": "https://api.github.com/users/GeorgeS2019/following{/other_user}",
            "gists_url": "https://api.github.com/users/GeorgeS2019/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GeorgeS2019/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GeorgeS2019/subscriptions",
            "organizations_url": "https://api.github.com/users/GeorgeS2019/orgs",
            "repos_url": "https://api.github.com/users/GeorgeS2019/repos",
            "events_url": "https://api.github.com/users/GeorgeS2019/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GeorgeS2019/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-26T17:56:56Z",
        "updated_at": "2022-09-26T17:59:22Z",
        "author_association": "NONE",
        "body": "#### reference:  \r\n[[Feature Request] Classify Contributed Ops](https://github.com/microsoft/onnxruntime/issues/13084#top)\r\n```mermaid\r\nflowchart TD\r\n    text--> GPT2\\nmodel-->|com.microsoft.nlp.BeamSearch\\nops| output\\ntext\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1258408077/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1260097874",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13088#issuecomment-1260097874",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13088",
        "id": 1260097874,
        "node_id": "IC_kwDOCVq1mM5LG5FS",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-27T21:59:59Z",
        "updated_at": "2022-09-27T21:59:59Z",
        "author_association": "MEMBER",
        "body": "@Zapotecatl, beam search operator will try pad the output to max length when eos token is generated and early stopping is enabled. Did you enable early stopping?\r\n\r\nIt is not recommended to change EOS token ID after model training.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1260097874/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264446331",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13088#issuecomment-1264446331",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13088",
        "id": 1264446331,
        "node_id": "IC_kwDOCVq1mM5LXet7",
        "user": {
            "login": "Zapotecatl",
            "id": 6554457,
            "node_id": "MDQ6VXNlcjY1NTQ0NTc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6554457?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Zapotecatl",
            "html_url": "https://github.com/Zapotecatl",
            "followers_url": "https://api.github.com/users/Zapotecatl/followers",
            "following_url": "https://api.github.com/users/Zapotecatl/following{/other_user}",
            "gists_url": "https://api.github.com/users/Zapotecatl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Zapotecatl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Zapotecatl/subscriptions",
            "organizations_url": "https://api.github.com/users/Zapotecatl/orgs",
            "repos_url": "https://api.github.com/users/Zapotecatl/repos",
            "events_url": "https://api.github.com/users/Zapotecatl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Zapotecatl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-01T18:26:21Z",
        "updated_at": "2022-10-01T18:26:21Z",
        "author_association": "NONE",
        "body": "Hi @tianleiwu , thanks for the answer.\r\n\r\nNo, I didn't enable early stopping. I looking for that option in the code, then I modified this code line in convert_generation.py:\r\n\r\n`model_group.set_defaults(early_stopping=True)`\r\n\r\nI have exported my model with this new option in true. I ran the GPT2 (it's actually GPT NEO...) for max_length = 64 and max_length = 128:\r\n\r\n**Input**: _Ignacio Perez, an evolutionary biologist from the University of La Paz, and several companions, were exploring the Andes Mountains when they found a small valley, with no other animals or humans._\r\n\r\nmax_length = 64\r\n**Output**: _' We thought it must be some kind of natural phenomenon,' Perez said._\r\n\r\nmax_length = 128\r\n**Output**: _' We thoughtit must be some kind of natural phenomenon,' Perez said. It was so quiet that we didn't hear anything until we got close to it.' The group decided to explore further into the valley in order to see if there might be any signs of human habitation. They walked for about two hours before coming across what appeared to be a cave entrance_\r\n\r\n\r\nAs you can see, I continue have the problem. In my application I am using max_lenght = 128 and the idea is stop in the first dot (If there was the option to stop with: \".\", \"?\" And \"!\", it would be great).\r\n\r\nMaybe I'm doing something wrong?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264446331/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264471144",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13088#issuecomment-1264471144",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13088",
        "id": 1264471144,
        "node_id": "IC_kwDOCVq1mM5LXkxo",
        "user": {
            "login": "Zapotecatl",
            "id": 6554457,
            "node_id": "MDQ6VXNlcjY1NTQ0NTc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6554457?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Zapotecatl",
            "html_url": "https://github.com/Zapotecatl",
            "followers_url": "https://api.github.com/users/Zapotecatl/followers",
            "following_url": "https://api.github.com/users/Zapotecatl/following{/other_user}",
            "gists_url": "https://api.github.com/users/Zapotecatl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Zapotecatl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Zapotecatl/subscriptions",
            "organizations_url": "https://api.github.com/users/Zapotecatl/orgs",
            "repos_url": "https://api.github.com/users/Zapotecatl/repos",
            "events_url": "https://api.github.com/users/Zapotecatl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Zapotecatl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-01T20:16:24Z",
        "updated_at": "2022-10-01T20:16:55Z",
        "author_association": "NONE",
        "body": "Oh sorry, I had removed my first eos_code.\r\n\r\nThe early stopping works very good. The time of the answer is around 1 and 3 seconds.\r\n\r\nAfter, many months, I have achivieved my goal:\r\n+ GPT NEO with reasonable answers.\r\n+ Answers in practical time only using CPU\r\n+ Onnx in C++ with Unreal engine 4 (I had a lot of problems with pytorch and UE...)\r\n\r\nThank you very much @tianleiwu , I would never have achieved it without your help. Thanks for everything!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264471144/reactions",
            "total_count": 2,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 1,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264791404",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/13088#issuecomment-1264791404",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/13088",
        "id": 1264791404,
        "node_id": "IC_kwDOCVq1mM5LYy9s",
        "user": {
            "login": "Zapotecatl",
            "id": 6554457,
            "node_id": "MDQ6VXNlcjY1NTQ0NTc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6554457?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Zapotecatl",
            "html_url": "https://github.com/Zapotecatl",
            "followers_url": "https://api.github.com/users/Zapotecatl/followers",
            "following_url": "https://api.github.com/users/Zapotecatl/following{/other_user}",
            "gists_url": "https://api.github.com/users/Zapotecatl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Zapotecatl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Zapotecatl/subscriptions",
            "organizations_url": "https://api.github.com/users/Zapotecatl/orgs",
            "repos_url": "https://api.github.com/users/Zapotecatl/repos",
            "events_url": "https://api.github.com/users/Zapotecatl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Zapotecatl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-03T00:59:03Z",
        "updated_at": "2022-10-03T00:59:03Z",
        "author_association": "NONE",
        "body": "I did some tests in \"chat mode\". I mean something like this:\r\n\r\n```\r\nHuman: How are you? \r\nAI: I'm fine. \r\nHuman: What is your name? \r\nAI: My name is Anna.\r\n```\r\n\r\nIn this case my solution about force eos_token_id = 13 (dot) doesn't work because GPT NEO avoid write the dot. I return eos_token_id to its standard value (\"<|endoftext|>\":50256).\r\n\r\nThe workaround was play with value max_length (I kept the early_stopping = true). The tex generation produce also unnecessary answers, but is is small (I am getting times between 3 and 4 seconds). Something like:\r\n\r\n```\r\nAI: I live in London.\r\nHuman: where //<---- unnecessary response\r\n```\r\n\r\nI think a new option like \"stop token\" would be fantastic. \r\n\r\nAnyway, the onnx convert_generation.py is amazing!\r\n\r\nRegards.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1264791404/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]