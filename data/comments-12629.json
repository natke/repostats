[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218158438",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1218158438",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1218158438,
        "node_id": "IC_kwDOCVq1mM5Im59m",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-17T15:23:53Z",
        "updated_at": "2022-08-17T15:23:53Z",
        "author_association": "CONTRIBUTOR",
        "body": "How are you accessing the outputs in Java? And can you supply an example model?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218158438/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218964531",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1218964531",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1218964531,
        "node_id": "IC_kwDOCVq1mM5Ip-wz",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-18T02:51:24Z",
        "updated_at": "2022-08-18T02:51:24Z",
        "author_association": "CONTRIBUTOR",
        "body": "I checked one of the test models (a logistic regression exported from scikit-learn), and I got the expected output of a tensor containing the predicted labels, and a sequence of maps containing the labels and probabilities for each example. There might be some oddities in the handling of the zipmap, so how was the model exported from scikit-learn?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218964531/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1219541042",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1219541042",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1219541042,
        "node_id": "IC_kwDOCVq1mM5IsLgy",
        "user": {
            "login": "dan-kur",
            "id": 95598696,
            "node_id": "U_kgDOBbK4aA",
            "avatar_url": "https://avatars.githubusercontent.com/u/95598696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dan-kur",
            "html_url": "https://github.com/dan-kur",
            "followers_url": "https://api.github.com/users/dan-kur/followers",
            "following_url": "https://api.github.com/users/dan-kur/following{/other_user}",
            "gists_url": "https://api.github.com/users/dan-kur/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dan-kur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dan-kur/subscriptions",
            "organizations_url": "https://api.github.com/users/dan-kur/orgs",
            "repos_url": "https://api.github.com/users/dan-kur/repos",
            "events_url": "https://api.github.com/users/dan-kur/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dan-kur/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-18T14:09:09Z",
        "updated_at": "2022-08-18T14:09:09Z",
        "author_association": "NONE",
        "body": "The model was exported using the `to_onnx` method of skl2onnx. In the options, I specified \"zipmap\": False. When I do inference with the model on Python, I do get the full probability array.\r\n\r\nOn the Java side, I am mapping the probabilities output to an OnnxSequence. When I look at the info of the sequence, length=1. If I print it out, I get an array with only one value. \r\n\r\nIt looks like: \r\n\r\n```\r\nOrtSession.Result pred = session.run(onnxInputMap);\r\nOnnxSequence probabilities = (OnnxSequence) pred.get(1);\r\nSystem.out.println(probabilities);\r\nSystem.out.println(probabilities.getValue());\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1219541042/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1219790072",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1219790072",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1219790072,
        "node_id": "IC_kwDOCVq1mM5ItIT4",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-18T18:13:07Z",
        "updated_at": "2022-08-18T18:13:07Z",
        "author_association": "CONTRIBUTOR",
        "body": "Ok, I'll look at it. The spec for the behaviour of the onnx sequence seems underspecified, currently in Java it is written to pull out the first element of each tensor in the sequence because in the test examples I had all sequences contained a list of single element tensors. If it can in fact return a sequence of non-scalar tensors then I'll need to refactor the logic in Java and the native bridge.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1219790072/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1220142112",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1220142112",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1220142112,
        "node_id": "IC_kwDOCVq1mM5IueQg",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-19T01:33:52Z",
        "updated_at": "2022-08-19T01:35:03Z",
        "author_association": "CONTRIBUTOR",
        "body": "I exported a logistic regression from scikit-learn using `onx = to_onnx(lr,x.astype(numpy.float32),target_opset=12,options={type(model): {'zipmap': False}})` and when inspecting that model in Java I see that the output is a tensor:\r\n\r\n```\r\njshell> session.getOutputInfo()\r\n$11 ==> {\r\nlabel=NodeInfo(name=label,info=TensorInfo(javaType=INT64,onnxType=ONNX_TENSOR_ELEMENT_DATA_TYPE_INT64,shape=[-1])),\r\nprobabilities=NodeInfo(name=probabilities,info=TensorInfo(javaType=FLOAT,onnxType=ONNX_TENSOR_ELEMENT_DATA_TYPE_FLOAT,shape=[-1, 3]))\r\n}\r\n```\r\n\r\nand those probabilities are all returned as outputs.\r\n\r\nCan you provide more information so I can replicate this? Either an ONNX model or the exact series of commands you use to generate it?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1220142112/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1220880829",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1220880829",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1220880829,
        "node_id": "IC_kwDOCVq1mM5IxSm9",
        "user": {
            "login": "dan-kur",
            "id": 95598696,
            "node_id": "U_kgDOBbK4aA",
            "avatar_url": "https://avatars.githubusercontent.com/u/95598696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dan-kur",
            "html_url": "https://github.com/dan-kur",
            "followers_url": "https://api.github.com/users/dan-kur/followers",
            "following_url": "https://api.github.com/users/dan-kur/following{/other_user}",
            "gists_url": "https://api.github.com/users/dan-kur/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dan-kur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dan-kur/subscriptions",
            "organizations_url": "https://api.github.com/users/dan-kur/orgs",
            "repos_url": "https://api.github.com/users/dan-kur/repos",
            "events_url": "https://api.github.com/users/dan-kur/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dan-kur/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-19T16:43:17Z",
        "updated_at": "2022-08-19T19:00:59Z",
        "author_association": "NONE",
        "body": "I tried to share the model here but that file type does not seem to be supported. If there is an alternative place I can share it, please let me know.\r\n\r\nHowever, the model is as such:\r\n\r\n- the classifier is a logistic regression\r\n- it is wrapped in a `sklearn.multioutput.MultiOutputClassifier` object\r\n- it is then wrapped in a `sklearn.pipeline.Pipeline` object (the first step was a vectorizer)\r\n\r\nWhen I examined the output of the model in Java, I got the following:\r\n`label=NodeInfo(name=label,info=TensorInfo(javaType=INT64,onnxType=ONNX_TENSOR_ELEMENT_DATA_TYPE_INT64,shape=[-1, 1])), probabilities=NodeInfo(name=probabilities,info=SequenceInfo(length=UNKNOWN,type=FLOAT))}`\r\n\r\nHowever, when I tried exporting only a logistic regression, I got a similar output type as you for the probabilities.\r\n\r\nI suspect the difference is with the `MultiOutputClassifier` and/or the `Pipeline` objects, and they are leading to the probabilities being cast to an `OnnxSequence` rather than an `OnnxTensor`.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1220880829/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1221021887",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1221021887",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1221021887,
        "node_id": "IC_kwDOCVq1mM5Ix1C_",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-19T19:19:52Z",
        "updated_at": "2022-08-19T19:19:52Z",
        "author_association": "CONTRIBUTOR",
        "body": "You can email the model to me at adam.pocock@oracle.com, but I'm out on vacation next week and won't look at it until the week after.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1221021887/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1221082001",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1221082001",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1221082001,
        "node_id": "IC_kwDOCVq1mM5IyDuR",
        "user": {
            "login": "dan-kur",
            "id": 95598696,
            "node_id": "U_kgDOBbK4aA",
            "avatar_url": "https://avatars.githubusercontent.com/u/95598696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dan-kur",
            "html_url": "https://github.com/dan-kur",
            "followers_url": "https://api.github.com/users/dan-kur/followers",
            "following_url": "https://api.github.com/users/dan-kur/following{/other_user}",
            "gists_url": "https://api.github.com/users/dan-kur/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dan-kur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dan-kur/subscriptions",
            "organizations_url": "https://api.github.com/users/dan-kur/orgs",
            "repos_url": "https://api.github.com/users/dan-kur/repos",
            "events_url": "https://api.github.com/users/dan-kur/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dan-kur/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-19T20:48:52Z",
        "updated_at": "2022-08-19T20:48:52Z",
        "author_association": "NONE",
        "body": "Thanks! I sent you an email. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1221082001/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1249975331",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1249975331",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1249975331,
        "node_id": "IC_kwDOCVq1mM5KgRwj",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-17T01:58:37Z",
        "updated_at": "2022-09-17T01:58:56Z",
        "author_association": "CONTRIBUTOR",
        "body": "Could you test out this branch - https://github.com/Craigacp/onnxruntime/tree/java-sequence-fix. I've modified `OnnxSequence.getValue()` so it now returns either `List<OnnxTensor>` or `List<Map<Object,Object>>` depending on the sequence element type. It passes the ported C# test for operating on sequences of tensors, but I'm not entirely happy with the semantics as I think it should either return pure Java side values or Onnx values rather than a mixture. I'm leaning towards making it return `List<OnnxTensor>` and `List<OnnxMap>`, because forcing the creation of multidimensional java arrays ruins any performance in the system, but that's a bit more work than I have time for at the moment.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1249975331/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1251327955",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/12629#issuecomment-1251327955",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/12629",
        "id": 1251327955,
        "node_id": "IC_kwDOCVq1mM5Klb_T",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-19T17:31:31Z",
        "updated_at": "2022-09-19T17:31:31Z",
        "author_association": "CONTRIBUTOR",
        "body": "I found a little more time and moved `OnnxSequence` over so that `getValue` now returns `List<? extends OnnxValue>` which means both types of things supported in a sequence now behave the same way.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1251327955/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]