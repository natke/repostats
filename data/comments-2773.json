[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570547650",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-570547650",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 570547650,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDU0NzY1MA==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-03T11:29:40Z",
        "updated_at": "2020-01-03T11:29:40Z",
        "author_association": "CONTRIBUTOR",
        "body": "Running with:\r\n```csharp\r\n            options.AppendExecutionProvider_CUDA(0);\r\n            //options.AppendExecutionProvider_Tensorrt(0);\r\n```\r\nThat is with CUDA instead of TensorRT shows that CUDA version also has a memory leak. While ~2 bytes is small this does accumulate in production too. \r\n\r\n``` ini\r\n\r\nBenchmarkDotNet=v0.12.0, OS=Windows 10.0.17763.864 (1809/October2018Update/Redstone5)\r\nIntel Core i7-8700 CPU 3.20GHz (Coffee Lake), 1 CPU, 12 logical and 6 physical cores\r\n  [Host]     : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n  DefaultJob : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n\r\n```\r\n| Method |     Mean |    Error |   StdDev | Gen 0 | Gen 1 | Gen 2 | Allocated | Allocated native memory | Native memory leak |\r\n|------- |---------:|---------:|---------:|------:|------:|------:|----------:|------------------------:|-------------------:|\r\n|    Run | 567.6 us | 11.03 us | 11.32 us |     - |     - |     - |     920 B |                 21730 B |                2 B |\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570547650/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570548779",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-570548779",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 570548779,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDU0ODc3OQ==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-03T11:35:14Z",
        "updated_at": "2020-01-03T11:35:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "Running with none of these providers:\r\n```csharp\r\n            //options.AppendExecutionProvider_CUDA(0);\r\n            //options.AppendExecutionProvider_Tensorrt(0);\r\n```\r\nthat is with default execution provider when built with cuda, cudnn, tensorrt support (I do not know which path/execution provider is used then). Then the native memory leak disappears. However, the execution time is way above our limits.\r\n\r\n``` ini\r\n\r\nBenchmarkDotNet=v0.12.0, OS=Windows 10.0.17763.864 (1809/October2018Update/Redstone5)\r\nIntel Core i7-8700 CPU 3.20GHz (Coffee Lake), 1 CPU, 12 logical and 6 physical cores\r\n  [Host]     : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n  DefaultJob : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n\r\n\r\n```\r\n| Method |     Mean |     Error |    StdDev | Gen 0 | Gen 1 | Gen 2 | Allocated | Allocated native memory | Native memory leak |\r\n|------- |---------:|----------:|----------:|------:|------:|------:|----------:|------------------------:|-------------------:|\r\n|    Run | 2.598 ms | 0.0159 ms | 0.0149 ms |     - |     - |     - |     928 B |                 20638 B |                  - |\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570548779/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570659726",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-570659726",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 570659726,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDY1OTcyNg==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-03T18:38:39Z",
        "updated_at": "2020-01-03T18:38:39Z",
        "author_association": "MEMBER",
        "body": "Do you know which thread the test function \"public float Run()\" will be in? It's always the same thread or it could be a new thread created by the benchmark framework?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570659726/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570669925",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-570669925",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 570669925,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDY2OTkyNQ==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-03T19:15:22Z",
        "updated_at": "2020-01-03T19:15:22Z",
        "author_association": "CONTRIBUTOR",
        "body": "@snnn if you run a simple loop around the run this will still leak. And I am pretty sure this occurs on a single thread in BDN. No mattter what calling `OrtRun` repeatedly on a single thread leaks.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/570669925/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572049685",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572049685",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572049685,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjA0OTY4NQ==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-08T13:26:35Z",
        "updated_at": "2020-01-08T13:26:35Z",
        "author_association": "CONTRIBUTOR",
        "body": "CUDA isn't a real memory leak, it appears to be a false positive in BDNs NativeMemoryProfiler, probably due to some startup allocations .",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572049685/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572289622",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572289622",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572289622,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjI4OTYyMg==",
        "user": {
            "login": "jywu-msft",
            "id": 43355415,
            "node_id": "MDQ6VXNlcjQzMzU1NDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/43355415?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jywu-msft",
            "html_url": "https://github.com/jywu-msft",
            "followers_url": "https://api.github.com/users/jywu-msft/followers",
            "following_url": "https://api.github.com/users/jywu-msft/following{/other_user}",
            "gists_url": "https://api.github.com/users/jywu-msft/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jywu-msft/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jywu-msft/subscriptions",
            "organizations_url": "https://api.github.com/users/jywu-msft/orgs",
            "repos_url": "https://api.github.com/users/jywu-msft/repos",
            "events_url": "https://api.github.com/users/jywu-msft/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jywu-msft/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-08T22:30:52Z",
        "updated_at": "2020-01-08T22:30:52Z",
        "author_association": "MEMBER",
        "body": "@stevenlix , can you take a look?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572289622/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572498019",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572498019",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572498019,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjQ5ODAxOQ==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-09T10:33:09Z",
        "updated_at": "2020-01-09T10:33:09Z",
        "author_association": "CONTRIBUTOR",
        "body": "@stevenlix it looks to me and I am not 100% sure but that the leak is in the lines:\r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/293b15480be468529cbd05e0c150fad23b08f186/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc#L523\r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/293b15480be468529cbd05e0c150fad23b08f186/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc#L679\r\n\r\nwhich creates an optimization profile as a raw pointer:\r\n```cpp\r\n    virtual nvinfer1::IOptimizationProfile* createOptimizationProfile() noexcept = 0;\r\n```\r\nnow the documentation says you must not delete this, since the `IBuilder` retains ownership, but it looks to me it was not intended that one creates one every time no matter if needed or not. \r\n\r\nAt least basedon profiling using PerfView and a Debug build of onnxruntime together with the benchmark code detailed earlier one can see that this leaks memory for every time this is called.\r\n\r\n![image](https://user-images.githubusercontent.com/10798831/72058662-c18c3880-32d0-11ea-9d4c-7295923fc2a0.png)\r\n\r\nTo fix this I changed the code to only create the optimization profile if needed in case of shape changes. This is a quick fix though, I think the handling of shape changes needs to be handled differently. We do not have shape changes so we can live with the quick fix. It's better than nothing.\r\n\r\nThe fix can be seen in #2805\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572498019/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572514195",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572514195",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572514195,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjUxNDE5NQ==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-09T11:11:38Z",
        "updated_at": "2020-01-09T11:11:38Z",
        "author_association": "CONTRIBUTOR",
        "body": "After this fix BDN also shows there no longer is a native memory leak:\r\n\r\n``` ini\r\n\r\nBenchmarkDotNet=v0.12.0, OS=Windows 10.0.17763.864 (1809/October2018Update/Redstone5)\r\nIntel Core i7-8700 CPU 3.20GHz (Coffee Lake), 1 CPU, 12 logical and 6 physical cores\r\n  [Host]     : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n  DefaultJob : .NET Framework 4.8 (4.8.4042.0), X64 RyuJIT\r\n\r\n\r\n```\r\n| Method |     Mean |   Error |   StdDev |   Median | Gen 0 | Gen 1 | Gen 2 | Allocated | Allocated native memory | Native memory leak |\r\n|------- |---------:|--------:|---------:|---------:|------:|------:|------:|----------:|------------------------:|-------------------:|\r\n|    Run | 417.3 us | 8.26 us | 21.16 us | 406.2 us |     - |     - |     - |     916 B |                  8490 B |                  - |\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572514195/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572672524",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572672524",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572672524,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjY3MjUyNA==",
        "user": {
            "login": "jywu-msft",
            "id": 43355415,
            "node_id": "MDQ6VXNlcjQzMzU1NDE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/43355415?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jywu-msft",
            "html_url": "https://github.com/jywu-msft",
            "followers_url": "https://api.github.com/users/jywu-msft/followers",
            "following_url": "https://api.github.com/users/jywu-msft/following{/other_user}",
            "gists_url": "https://api.github.com/users/jywu-msft/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jywu-msft/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jywu-msft/subscriptions",
            "organizations_url": "https://api.github.com/users/jywu-msft/orgs",
            "repos_url": "https://api.github.com/users/jywu-msft/repos",
            "events_url": "https://api.github.com/users/jywu-msft/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jywu-msft/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-09T17:41:49Z",
        "updated_at": "2020-01-09T17:42:03Z",
        "author_association": "MEMBER",
        "body": "> @stevenlix it looks to me and I am not 100% sure but that the leak is in the lines:\r\n> \r\n> https://github.com/microsoft/onnxruntime/blob/293b15480be468529cbd05e0c150fad23b08f186/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc#L523\r\n> \r\n> https://github.com/microsoft/onnxruntime/blob/293b15480be468529cbd05e0c150fad23b08f186/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc#L679\r\n> \r\n> which creates an optimization profile as a raw pointer:\r\n> \r\n> ```c++\r\n>     virtual nvinfer1::IOptimizationProfile* createOptimizationProfile() noexcept = 0;\r\n> ```\r\n> \r\n> now the documentation says you must not delete this, since the `IBuilder` retains ownership, but it looks to me it was not intended that one creates one every time no matter if needed or not.\r\n> \r\n> At least basedon profiling using PerfView and a Debug build of onnxruntime together with the benchmark code detailed earlier one can see that this leaks memory for every time this is called.\r\n> \r\n> ![image](https://user-images.githubusercontent.com/10798831/72058662-c18c3880-32d0-11ea-9d4c-7295923fc2a0.png)\r\n> \r\n> To fix this I changed the code to only create the optimization profile if needed in case of shape changes. This is a quick fix though, I think the handling of shape changes needs to be handled differently. We do not have shape changes so we can live with the quick fix. It's better than nothing.\r\n> \r\n> The fix can be seen in #2805\r\n\r\n\r\nThanks for debugging and root causing the issue!\r\nI think we'll need to refactor the code to not always create an optimization profile.\r\nprobably we can just re-use the one initially created in TensorrtExecutionProvider::Compile()\r\nand update it as needed.\r\n@stevenlix is working on a fix and we'll probably ask you to help us validate it.\r\nThanks again!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572672524/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572773592",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-572773592",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 572773592,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3Mjc3MzU5Mg==",
        "user": {
            "login": "stevenlix",
            "id": 38092805,
            "node_id": "MDQ6VXNlcjM4MDkyODA1",
            "avatar_url": "https://avatars.githubusercontent.com/u/38092805?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/stevenlix",
            "html_url": "https://github.com/stevenlix",
            "followers_url": "https://api.github.com/users/stevenlix/followers",
            "following_url": "https://api.github.com/users/stevenlix/following{/other_user}",
            "gists_url": "https://api.github.com/users/stevenlix/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/stevenlix/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/stevenlix/subscriptions",
            "organizations_url": "https://api.github.com/users/stevenlix/orgs",
            "repos_url": "https://api.github.com/users/stevenlix/repos",
            "events_url": "https://api.github.com/users/stevenlix/events{/privacy}",
            "received_events_url": "https://api.github.com/users/stevenlix/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-09T21:53:14Z",
        "updated_at": "2020-01-09T21:53:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "@jywu-msft, after looking at the code, I think @nietras 's fix is good for now. Usually trt_profile is not needed in the compute unless shape range is changed, and it's better to keep it in local.  ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/572773592/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/578125537",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-578125537",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 578125537,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODEyNTUzNw==",
        "user": {
            "login": "nietras",
            "id": 10798831,
            "node_id": "MDQ6VXNlcjEwNzk4ODMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/10798831?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nietras",
            "html_url": "https://github.com/nietras",
            "followers_url": "https://api.github.com/users/nietras/followers",
            "following_url": "https://api.github.com/users/nietras/following{/other_user}",
            "gists_url": "https://api.github.com/users/nietras/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nietras/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nietras/subscriptions",
            "organizations_url": "https://api.github.com/users/nietras/orgs",
            "repos_url": "https://api.github.com/users/nietras/repos",
            "events_url": "https://api.github.com/users/nietras/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nietras/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-24T13:16:14Z",
        "updated_at": "2020-01-24T13:16:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "appears to be fixed",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/578125537/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/614660637",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2773#issuecomment-614660637",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2773",
        "id": 614660637,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDY2MDYzNw==",
        "user": {
            "login": "solarflarefx",
            "id": 45402633,
            "node_id": "MDQ6VXNlcjQ1NDAyNjMz",
            "avatar_url": "https://avatars.githubusercontent.com/u/45402633?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/solarflarefx",
            "html_url": "https://github.com/solarflarefx",
            "followers_url": "https://api.github.com/users/solarflarefx/followers",
            "following_url": "https://api.github.com/users/solarflarefx/following{/other_user}",
            "gists_url": "https://api.github.com/users/solarflarefx/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/solarflarefx/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/solarflarefx/subscriptions",
            "organizations_url": "https://api.github.com/users/solarflarefx/orgs",
            "repos_url": "https://api.github.com/users/solarflarefx/repos",
            "events_url": "https://api.github.com/users/solarflarefx/events{/privacy}",
            "received_events_url": "https://api.github.com/users/solarflarefx/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-04-16T13:42:11Z",
        "updated_at": "2020-04-16T13:42:11Z",
        "author_association": "NONE",
        "body": "@nietras After you built from source, how did you use this build in your C# project?  I built from source and got three DLLs: \r\n- custom_op_library.dll\r\n- dnnl.dll\r\n- onnxruntime.dll\r\n\r\nI tried adding these DLLs by right clicking and adding as a reference, but it seems like these DLLs can't be added as COM components.  Was I supposed to get other files after the build?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/614660637/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]