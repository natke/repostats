[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658355149",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16938#issuecomment-1658355149",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16938",
        "id": 1658355149,
        "node_id": "IC_kwDOCVq1mM5i2H3N",
        "user": {
            "login": "tcherckez-nvidia",
            "id": 127761168,
            "node_id": "U_kgDOB517EA",
            "avatar_url": "https://avatars.githubusercontent.com/u/127761168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tcherckez-nvidia",
            "html_url": "https://github.com/tcherckez-nvidia",
            "followers_url": "https://api.github.com/users/tcherckez-nvidia/followers",
            "following_url": "https://api.github.com/users/tcherckez-nvidia/following{/other_user}",
            "gists_url": "https://api.github.com/users/tcherckez-nvidia/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tcherckez-nvidia/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tcherckez-nvidia/subscriptions",
            "organizations_url": "https://api.github.com/users/tcherckez-nvidia/orgs",
            "repos_url": "https://api.github.com/users/tcherckez-nvidia/repos",
            "events_url": "https://api.github.com/users/tcherckez-nvidia/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tcherckez-nvidia/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-31T13:16:42Z",
        "updated_at": "2023-07-31T13:16:42Z",
        "author_association": "NONE",
        "body": "[fp8_fp32_fp8_test_.zip](https://github.com/microsoft/onnxruntime/files/12215345/fp8_fp32_fp8_test_.zip)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658355149/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658534574",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16938#issuecomment-1658534574",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16938",
        "id": 1658534574,
        "node_id": "IC_kwDOCVq1mM5i2zqu",
        "user": {
            "login": "xadupre",
            "id": 22452781,
            "node_id": "MDQ6VXNlcjIyNDUyNzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/22452781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/xadupre",
            "html_url": "https://github.com/xadupre",
            "followers_url": "https://api.github.com/users/xadupre/followers",
            "following_url": "https://api.github.com/users/xadupre/following{/other_user}",
            "gists_url": "https://api.github.com/users/xadupre/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/xadupre/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/xadupre/subscriptions",
            "organizations_url": "https://api.github.com/users/xadupre/orgs",
            "repos_url": "https://api.github.com/users/xadupre/repos",
            "events_url": "https://api.github.com/users/xadupre/events{/privacy}",
            "received_events_url": "https://api.github.com/users/xadupre/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-31T14:53:53Z",
        "updated_at": "2023-07-31T14:53:53Z",
        "author_association": "MEMBER",
        "body": "Is it for both providers, only CPU, only CUDA?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658534574/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658545594",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16938#issuecomment-1658545594",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16938",
        "id": 1658545594,
        "node_id": "IC_kwDOCVq1mM5i22W6",
        "user": {
            "login": "tcherckez-nvidia",
            "id": 127761168,
            "node_id": "U_kgDOB517EA",
            "avatar_url": "https://avatars.githubusercontent.com/u/127761168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tcherckez-nvidia",
            "html_url": "https://github.com/tcherckez-nvidia",
            "followers_url": "https://api.github.com/users/tcherckez-nvidia/followers",
            "following_url": "https://api.github.com/users/tcherckez-nvidia/following{/other_user}",
            "gists_url": "https://api.github.com/users/tcherckez-nvidia/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tcherckez-nvidia/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tcherckez-nvidia/subscriptions",
            "organizations_url": "https://api.github.com/users/tcherckez-nvidia/orgs",
            "repos_url": "https://api.github.com/users/tcherckez-nvidia/repos",
            "events_url": "https://api.github.com/users/tcherckez-nvidia/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tcherckez-nvidia/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-31T14:59:51Z",
        "updated_at": "2023-07-31T14:59:51Z",
        "author_association": "NONE",
        "body": "Both.\r\n\r\nBTW I've tested this against locally built pytorch which have support for fp8(was added lately) with the following code, and torch is having the expect values (!=ORT results):\r\n```\r\ntorch_ref = torch.tensor(input).to(torch.float8_e4m3fn).to(torch.float32)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658545594/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658587578",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16938#issuecomment-1658587578",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16938",
        "id": 1658587578,
        "node_id": "IC_kwDOCVq1mM5i3Am6",
        "user": {
            "login": "xadupre",
            "id": 22452781,
            "node_id": "MDQ6VXNlcjIyNDUyNzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/22452781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/xadupre",
            "html_url": "https://github.com/xadupre",
            "followers_url": "https://api.github.com/users/xadupre/followers",
            "following_url": "https://api.github.com/users/xadupre/following{/other_user}",
            "gists_url": "https://api.github.com/users/xadupre/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/xadupre/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/xadupre/subscriptions",
            "organizations_url": "https://api.github.com/users/xadupre/orgs",
            "repos_url": "https://api.github.com/users/xadupre/repos",
            "events_url": "https://api.github.com/users/xadupre/events{/privacy}",
            "received_events_url": "https://api.github.com/users/xadupre/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-31T15:20:10Z",
        "updated_at": "2023-07-31T15:20:10Z",
        "author_association": "MEMBER",
        "body": "The bug is only for CPU, I'll fix that. CUDA is using nvidia API to cast. I don't think your example was using CUDA. This is what I did and CUDA provider returns the value you expect.\r\n\r\n```python\r\nimport os\r\nimport numpy as np\r\nfrom onnx.reference import ReferenceEvaluator\r\nfrom onnxruntime import InferenceSession\r\n\r\nthis = os.path.dirname(__file__)\r\n\r\nx = np.load(os.path.join(this, \"te.cast_fp8_1_fp32_input.npy\"))\r\nx[0, 0] = 1.8131605\r\ny = np.load(os.path.join(this, \"te.cast_fp8_1_fp32_out_0.npy\"))\r\nprint(x[:4, :4])\r\nprint(y[:4, :4])\r\nprint(\"---------\")\r\n\r\nref = ReferenceEvaluator(os.path.join(this, \"te.cast_fp8_1_fp32.onnx\"))\r\ngot = ref.run(None, {'input': x})[0]\r\nprint(got[:4, :4])\r\nprint(\"---------\")\r\n\r\nsess = InferenceSession(os.path.join(this, \"te.cast_fp8_1_fp32.onnx\"), providers=[\"CPUExecutionProvider\"])\r\ngot = sess.run(None, {'input': x})[0]\r\nprint(got[:4, :4])\r\nprint(\"---------\")\r\n\r\nsess = InferenceSession(os.path.join(this, \"te.cast_fp8_1_fp32.onnx\"), providers=[\"CUDAExecutionProvider\"])\r\ngot = sess.run(None, {'input': x})[0]\r\nprint(got[:4, :4])\r\nprint(\"---------\")\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1658587578/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1659720196",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16938#issuecomment-1659720196",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16938",
        "id": 1659720196,
        "node_id": "IC_kwDOCVq1mM5i7VIE",
        "user": {
            "login": "tcherckez-nvidia",
            "id": 127761168,
            "node_id": "U_kgDOB517EA",
            "avatar_url": "https://avatars.githubusercontent.com/u/127761168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tcherckez-nvidia",
            "html_url": "https://github.com/tcherckez-nvidia",
            "followers_url": "https://api.github.com/users/tcherckez-nvidia/followers",
            "following_url": "https://api.github.com/users/tcherckez-nvidia/following{/other_user}",
            "gists_url": "https://api.github.com/users/tcherckez-nvidia/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tcherckez-nvidia/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tcherckez-nvidia/subscriptions",
            "organizations_url": "https://api.github.com/users/tcherckez-nvidia/orgs",
            "repos_url": "https://api.github.com/users/tcherckez-nvidia/repos",
            "events_url": "https://api.github.com/users/tcherckez-nvidia/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tcherckez-nvidia/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-01T07:23:41Z",
        "updated_at": "2023-08-01T07:23:53Z",
        "author_association": "NONE",
        "body": "Missed a warning  - `Failed to create CUDAExecutionProvider`, I'm guessing ORT defaults to use `CPUExecutionProvider` on such cases",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1659720196/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]