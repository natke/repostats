[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1473468293",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15078#issuecomment-1473468293",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15078",
        "id": 1473468293,
        "node_id": "IC_kwDOCVq1mM5X01eF",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-17T09:09:07Z",
        "updated_at": "2023-03-17T09:09:07Z",
        "author_association": "MEMBER",
        "body": "Can you please include the code you're using to measure the run time. \r\n\r\nIf for example you're not using a high resolution timer those differences would be expected but would be coming from the measurement rather than the inferencing time.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1473468293/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1473514859",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15078#issuecomment-1473514859",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15078",
        "id": 1473514859,
        "node_id": "IC_kwDOCVq1mM5X1A1r",
        "user": {
            "login": "DennisJcy",
            "id": 106725464,
            "node_id": "U_kgDOBlyAWA",
            "avatar_url": "https://avatars.githubusercontent.com/u/106725464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DennisJcy",
            "html_url": "https://github.com/DennisJcy",
            "followers_url": "https://api.github.com/users/DennisJcy/followers",
            "following_url": "https://api.github.com/users/DennisJcy/following{/other_user}",
            "gists_url": "https://api.github.com/users/DennisJcy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/DennisJcy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/DennisJcy/subscriptions",
            "organizations_url": "https://api.github.com/users/DennisJcy/orgs",
            "repos_url": "https://api.github.com/users/DennisJcy/repos",
            "events_url": "https://api.github.com/users/DennisJcy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/DennisJcy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-17T09:31:36Z",
        "updated_at": "2023-03-18T01:02:25Z",
        "author_association": "NONE",
        "body": "thanks for your reply,i record  the time like under.After your advice, i used omp_get_wtime(),but the result is almost the same. \r\n@skottmckay \r\n```c++\r\nchar* ONNX_CORE::RunSession(cv::Mat &iImg, YOLO_RESULT &oResult)\r\n{\r\n\tclock_t starttime_1 = clock();\r\n\tchar* Ret = RET_OK;\r\n\t...//pre-porcess\r\n\tclock_t starttime_2 = clock();\r\n        double start_1 = omp_get_wtime();\r\n\tauto output_tensors = session->Run(Ort::RunOptions{ nullptr }, YOLO_input_node_names.data(), &input_tensor, 1, YOLO_output_node_names.data(), YOLO_output_node_names.size());\r\n\tclock_t starttime_3 = clock();\r\n        double start_2 = omp_get_wtime();\r\n        .....//post-process\r\n\tclock_t starttime_4 = clock();\r\n\tdouble pre_process_time = (double)(starttime_2 - starttime_1) / CLOCKS_PER_SEC * 1000;\r\n\tdouble process_time = (double)(starttime_3 - starttime_2) / CLOCKS_PER_SEC * 1000;\r\n\tdouble post_process_time = (double)(starttime_4 - starttime_3) / CLOCKS_PER_SEC * 1000;\r\n\tif (cuda_enable)\r\n\t{\r\n\t\tstd::cout << \"[ONNX(cuda) RUN TIME]: \" << pre_process_time << \"ms pre-process, \" << process_time << \"ms inference, \" << post_process_time << \"ms post-process.\" << std::endl;\r\n                std::cout << \"[ONNX(cuda) RUN TIME]: \" << (double)(start_2 - start_1) * 1000 << std::endl;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tstd::cout << \"[ONNX(cpu) RUN TIME]: \" << pre_process_time << \"ms pre-process, \" << process_time << \"ms inference, \" << post_process_time << \"ms post-process.\" << std::endl;\r\n\t}\r\n\treturn Ret;\r\n}\r\n\r\n```\r\n![image](https://user-images.githubusercontent.com/106725464/225866506-726b71a7-0646-4a0a-ac37-d32908967f7b.png)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1473514859/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1474472859",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15078#issuecomment-1474472859",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15078",
        "id": 1474472859,
        "node_id": "IC_kwDOCVq1mM5X4qub",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-17T22:33:42Z",
        "updated_at": "2023-03-17T22:33:42Z",
        "author_association": "MEMBER",
        "body": "I don't believe either `clock` or `omp_get_wtime` are high resolution timers, and [clock](https://en.cppreference.com/w/cpp/chrono/c/clock) is tracking processor time not overall time taken.\r\n\r\nFor C++ I would expect you need to use std::chrono::high_resolution_clock and not a wall clock.\r\n\r\nAdditionally, you're including the time to call omp_get_wtime in your timing data further invalidating it. You should also only be measuring the time taken by the single line calling Run. That means you should also construct RunOptions prior to starting timing for the call to Run. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1474472859/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1474552053",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15078#issuecomment-1474552053",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15078",
        "id": 1474552053,
        "node_id": "IC_kwDOCVq1mM5X4-D1",
        "user": {
            "login": "DennisJcy",
            "id": 106725464,
            "node_id": "U_kgDOBlyAWA",
            "avatar_url": "https://avatars.githubusercontent.com/u/106725464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DennisJcy",
            "html_url": "https://github.com/DennisJcy",
            "followers_url": "https://api.github.com/users/DennisJcy/followers",
            "following_url": "https://api.github.com/users/DennisJcy/following{/other_user}",
            "gists_url": "https://api.github.com/users/DennisJcy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/DennisJcy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/DennisJcy/subscriptions",
            "organizations_url": "https://api.github.com/users/DennisJcy/orgs",
            "repos_url": "https://api.github.com/users/DennisJcy/repos",
            "events_url": "https://api.github.com/users/DennisJcy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/DennisJcy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-18T00:55:21Z",
        "updated_at": "2023-03-18T00:55:51Z",
        "author_association": "NONE",
        "body": "Thank you for your advice!\r\nYour second advice really helps!It seems like that the problem caused by the Ort::RunOptions,I moved `Ort::RunOptions options = Ort::RunOptions{nullptr}` to the .h  to be global,and the problem solved!\r\nThanks for your help! @skottmckay ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1474552053/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]