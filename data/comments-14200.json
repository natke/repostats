[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1377351533",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14200#issuecomment-1377351533",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14200",
        "id": 1377351533,
        "node_id": "IC_kwDOCVq1mM5SGLdt",
        "user": {
            "login": "xadupre",
            "id": 22452781,
            "node_id": "MDQ6VXNlcjIyNDUyNzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/22452781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/xadupre",
            "html_url": "https://github.com/xadupre",
            "followers_url": "https://api.github.com/users/xadupre/followers",
            "following_url": "https://api.github.com/users/xadupre/following{/other_user}",
            "gists_url": "https://api.github.com/users/xadupre/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/xadupre/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/xadupre/subscriptions",
            "organizations_url": "https://api.github.com/users/xadupre/orgs",
            "repos_url": "https://api.github.com/users/xadupre/repos",
            "events_url": "https://api.github.com/users/xadupre/events{/privacy}",
            "received_events_url": "https://api.github.com/users/xadupre/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-10T14:18:38Z",
        "updated_at": "2023-01-10T14:18:38Z",
        "author_association": "MEMBER",
        "body": "I think your error comes from the fast `output_2` is duplicated twice: `outputs=[\"output_1\", \"output_2\", \"output_2\"]`. That's why they seem the same.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1377351533/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1381366733",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14200#issuecomment-1381366733",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14200",
        "id": 1381366733,
        "node_id": "IC_kwDOCVq1mM5SVfvN",
        "user": {
            "login": "luchangli03",
            "id": 34341633,
            "node_id": "MDQ6VXNlcjM0MzQxNjMz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34341633?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/luchangli03",
            "html_url": "https://github.com/luchangli03",
            "followers_url": "https://api.github.com/users/luchangli03/followers",
            "following_url": "https://api.github.com/users/luchangli03/following{/other_user}",
            "gists_url": "https://api.github.com/users/luchangli03/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/luchangli03/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/luchangli03/subscriptions",
            "organizations_url": "https://api.github.com/users/luchangli03/orgs",
            "repos_url": "https://api.github.com/users/luchangli03/repos",
            "events_url": "https://api.github.com/users/luchangli03/events{/privacy}",
            "received_events_url": "https://api.github.com/users/luchangli03/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-13T06:22:13Z",
        "updated_at": "2023-01-13T06:22:13Z",
        "author_association": "NONE",
        "body": "> I think your error comes from the fast `output_2` is duplicated twice: `outputs=[\"output_1\", \"output_2\", \"output_2\"]`. That's why they seem the same.\r\n\r\nIt's doesn't matter!\r\n\r\nimport onnx\r\nimport numpy as np\r\nfrom onnx.helper import make_node, make_graph, make_tensor_value_info, make_model, make_opsetid\r\n\r\ninputs = [onnx.helper.make_tensor_value_info(name=\"input\", elem_type=onnx.TensorProto.FLOAT, shape=[1, 49, 8, 192])]\r\n\r\noutputs = [onnx.helper.make_tensor_value_info(name=\"output_1\", elem_type=onnx.TensorProto.FLOAT, shape=(-1,)),\r\n           onnx.helper.make_tensor_value_info(name=\"output_2\", elem_type=onnx.TensorProto.FLOAT, shape=(-1,)),\r\n           onnx.helper.make_tensor_value_info(name=\"output_3\", elem_type=onnx.TensorProto.FLOAT, shape=(-1,)),\r\n           ]\r\n\r\nsplit_tensor = onnx.helper.make_tensor(\r\n    name=\"split\", data_type=onnx.TensorProto.DataType.INT64, dims=[3], vals=[32, 32, 128])\r\n\r\nnode = onnx.helper.make_node(\r\n    \"Split\",\r\n    inputs=[\"input\", \"split\"],\r\n    outputs=[\"output_1\", \"output_2\", \"output_3\"],\r\n    axis=3,\r\n)\r\n\r\ngraph = onnx.helper.make_graph(nodes=[node], name=\"split\", inputs=inputs, outputs=outputs)\r\n\r\ngraph.initializer.append(split_tensor)\r\n\r\nonnx_model = onnx.helper.make_model(graph, opset_imports=[make_opsetid(domain=\"\", version=15)])\r\n\r\nonnx.save(onnx_model, \"split.onnx\")\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1381366733/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1381798818",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14200#issuecomment-1381798818",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14200",
        "id": 1381798818,
        "node_id": "IC_kwDOCVq1mM5SXJOi",
        "user": {
            "login": "xadupre",
            "id": 22452781,
            "node_id": "MDQ6VXNlcjIyNDUyNzgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/22452781?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/xadupre",
            "html_url": "https://github.com/xadupre",
            "followers_url": "https://api.github.com/users/xadupre/followers",
            "following_url": "https://api.github.com/users/xadupre/following{/other_user}",
            "gists_url": "https://api.github.com/users/xadupre/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/xadupre/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/xadupre/subscriptions",
            "organizations_url": "https://api.github.com/users/xadupre/orgs",
            "repos_url": "https://api.github.com/users/xadupre/repos",
            "events_url": "https://api.github.com/users/xadupre/events{/privacy}",
            "received_events_url": "https://api.github.com/users/xadupre/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-13T12:41:19Z",
        "updated_at": "2023-01-13T12:41:19Z",
        "author_association": "MEMBER",
        "body": "Here is the example I used to check your example. I replaced shape `(-1,)` by `None` and it gives the correct results. A link to find more information about shapes: https://onnx.ai/onnx/intro/python.html#a-simple-example-a-linear-regression.\r\n\r\n```python\r\nimport onnx\r\nimport numpy as np\r\nfrom onnx.helper import (\r\n    make_node,\r\n    make_graph,\r\n    make_tensor_value_info,\r\n    make_model,\r\n    make_opsetid,\r\n)\r\n\r\ninputs = [\r\n    onnx.helper.make_tensor_value_info(\r\n        name=\"input\", elem_type=onnx.TensorProto.FLOAT, shape=[1, 49, 8, 192]\r\n    )\r\n]\r\n\r\noutputs = [\r\n    onnx.helper.make_tensor_value_info(\r\n        name=\"output_1\", elem_type=onnx.TensorProto.FLOAT, shape=None\r\n    ),\r\n    onnx.helper.make_tensor_value_info(\r\n        name=\"output_2\", elem_type=onnx.TensorProto.FLOAT, shape=None\r\n    ),\r\n    onnx.helper.make_tensor_value_info(\r\n        name=\"output_3\", elem_type=onnx.TensorProto.FLOAT, shape=None,\r\n    ),\r\n]\r\n\r\nsplit_tensor = onnx.helper.make_tensor(\r\n    name=\"split\",\r\n    data_type=onnx.TensorProto.DataType.INT64,\r\n    dims=[3],\r\n    vals=[32, 32, 128],\r\n)\r\n\r\nnode = onnx.helper.make_node(\r\n    \"Split\",\r\n    inputs=[\"input\", \"split\"],\r\n    outputs=[\"output_1\", \"output_2\", \"output_3\"],\r\n    axis=3,\r\n)\r\n\r\ngraph = onnx.helper.make_graph(\r\n    nodes=[node], name=\"split\", inputs=inputs, outputs=outputs\r\n)\r\n\r\ngraph.initializer.append(split_tensor)\r\n\r\nonnx_model = onnx.helper.make_model(\r\n    graph, opset_imports=[make_opsetid(domain=\"\", version=15)]\r\n)\r\n\r\nfrom onnx.shape_inference import infer_shapes\r\nwith_shapes = infer_shapes(onnx_model)\r\nprint(with_shapes)\r\n\r\nimport numpy as np\r\nfrom onnx.reference import ReferenceEvaluator\r\nx = np.random.randn(1,49,8,192).astype(np.float32)\r\nref = ReferenceEvaluator(onnx_model)\r\nys = ref.run(None, {'input': x})\r\nprint([y.shape for y in ys])\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1381798818/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1411906770",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14200#issuecomment-1411906770",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14200",
        "id": 1411906770,
        "node_id": "IC_kwDOCVq1mM5UJ_zS",
        "user": {
            "login": "luchangli03",
            "id": 34341633,
            "node_id": "MDQ6VXNlcjM0MzQxNjMz",
            "avatar_url": "https://avatars.githubusercontent.com/u/34341633?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/luchangli03",
            "html_url": "https://github.com/luchangli03",
            "followers_url": "https://api.github.com/users/luchangli03/followers",
            "following_url": "https://api.github.com/users/luchangli03/following{/other_user}",
            "gists_url": "https://api.github.com/users/luchangli03/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/luchangli03/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/luchangli03/subscriptions",
            "organizations_url": "https://api.github.com/users/luchangli03/orgs",
            "repos_url": "https://api.github.com/users/luchangli03/repos",
            "events_url": "https://api.github.com/users/luchangli03/events{/privacy}",
            "received_events_url": "https://api.github.com/users/luchangli03/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-01T11:28:34Z",
        "updated_at": "2023-02-01T11:28:34Z",
        "author_association": "NONE",
        "body": "> ```python\r\n> import onnx\r\n> import numpy as np\r\n> from onnx.helper import (\r\n>     make_node,\r\n>     make_graph,\r\n>     make_tensor_value_info,\r\n>     make_model,\r\n>     make_opsetid,\r\n> )\r\n> \r\n> inputs = [\r\n>     onnx.helper.make_tensor_value_info(\r\n>         name=\"input\", elem_type=onnx.TensorProto.FLOAT, shape=[1, 49, 8, 192]\r\n>     )\r\n> ]\r\n> \r\n> outputs = [\r\n>     onnx.helper.make_tensor_value_info(\r\n>         name=\"output_1\", elem_type=onnx.TensorProto.FLOAT, shape=None\r\n>     ),\r\n>     onnx.helper.make_tensor_value_info(\r\n>         name=\"output_2\", elem_type=onnx.TensorProto.FLOAT, shape=None\r\n>     ),\r\n>     onnx.helper.make_tensor_value_info(\r\n>         name=\"output_3\", elem_type=onnx.TensorProto.FLOAT, shape=None,\r\n>     ),\r\n> ]\r\n> \r\n> split_tensor = onnx.helper.make_tensor(\r\n>     name=\"split\",\r\n>     data_type=onnx.TensorProto.DataType.INT64,\r\n>     dims=[3],\r\n>     vals=[32, 32, 128],\r\n> )\r\n> \r\n> node = onnx.helper.make_node(\r\n>     \"Split\",\r\n>     inputs=[\"input\", \"split\"],\r\n>     outputs=[\"output_1\", \"output_2\", \"output_3\"],\r\n>     axis=3,\r\n> )\r\n> \r\n> graph = onnx.helper.make_graph(\r\n>     nodes=[node], name=\"split\", inputs=inputs, outputs=outputs\r\n> )\r\n> \r\n> graph.initializer.append(split_tensor)\r\n> \r\n> onnx_model = onnx.helper.make_model(\r\n>     graph, opset_imports=[make_opsetid(domain=\"\", version=15)]\r\n> )\r\n> \r\n> from onnx.shape_inference import infer_shapes\r\n> with_shapes = infer_shapes(onnx_model)\r\n> print(with_shapes)\r\n> \r\n> import numpy as np\r\n> from onnx.reference import ReferenceEvaluator\r\n> x = np.random.randn(1,49,8,192).astype(np.float32)\r\n> ref = ReferenceEvaluator(onnx_model)\r\n> ys = ref.run(None, {'input': x})\r\n> print([y.shape for y in ys])\r\n> ```\r\n\r\nthe bug is not in ReferenceEvaluator, but in onnxruntime.tools.symbolic_shape_infer, since I use it to infer nodes shape and get the shape stored in graph value_info.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1411906770/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]