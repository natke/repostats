[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/672276241",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-672276241",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 672276241,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3MjI3NjI0MQ==",
        "user": {
            "login": "hariharans29",
            "id": 9969784,
            "node_id": "MDQ6VXNlcjk5Njk3ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9969784?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hariharans29",
            "html_url": "https://github.com/hariharans29",
            "followers_url": "https://api.github.com/users/hariharans29/followers",
            "following_url": "https://api.github.com/users/hariharans29/following{/other_user}",
            "gists_url": "https://api.github.com/users/hariharans29/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hariharans29/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hariharans29/subscriptions",
            "organizations_url": "https://api.github.com/users/hariharans29/orgs",
            "repos_url": "https://api.github.com/users/hariharans29/repos",
            "events_url": "https://api.github.com/users/hariharans29/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hariharans29/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-11T20:59:10Z",
        "updated_at": "2020-08-11T20:59:10Z",
        "author_association": "MEMBER",
        "body": "@tianleiwu - can you please take a look ?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/672276241/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/679841454",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-679841454",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 679841454,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3OTg0MTQ1NA==",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-25T06:56:53Z",
        "updated_at": "2020-08-25T06:56:53Z",
        "author_association": "MEMBER",
        "body": "@klimentij, \r\n\r\nDid you solve the issue?\r\n\r\nI added a [notebook](https://github.com/microsoft/onnxruntime/blob/master/onnxruntime/python/tools/transformers/notebooks/Inference_GPT2_with_OnnxRuntime_on_CPU.ipynb) for GPT-2 with example for generation. \r\n\r\nIn this case batch_size=1, past_sequence_length=145 and sequence_length=1. The attention mask shape should be [1,146].\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/679841454/reactions",
            "total_count": 1,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 1,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/688678991",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-688678991",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 688678991,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODY3ODk5MQ==",
        "user": {
            "login": "carter54",
            "id": 26741594,
            "node_id": "MDQ6VXNlcjI2NzQxNTk0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26741594?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carter54",
            "html_url": "https://github.com/carter54",
            "followers_url": "https://api.github.com/users/carter54/followers",
            "following_url": "https://api.github.com/users/carter54/following{/other_user}",
            "gists_url": "https://api.github.com/users/carter54/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carter54/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carter54/subscriptions",
            "organizations_url": "https://api.github.com/users/carter54/orgs",
            "repos_url": "https://api.github.com/users/carter54/repos",
            "events_url": "https://api.github.com/users/carter54/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carter54/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-08T07:33:05Z",
        "updated_at": "2020-09-08T07:33:21Z",
        "author_association": "NONE",
        "body": "@tianleiwu Thanks for the GPT2 example! \r\ncould you provide some beam-search example code with onnx GPT2 please?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/688678991/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/693426635",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-693426635",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 693426635,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MzQyNjYzNQ==",
        "user": {
            "login": "klimentij",
            "id": 3247669,
            "node_id": "MDQ6VXNlcjMyNDc2Njk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3247669?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/klimentij",
            "html_url": "https://github.com/klimentij",
            "followers_url": "https://api.github.com/users/klimentij/followers",
            "following_url": "https://api.github.com/users/klimentij/following{/other_user}",
            "gists_url": "https://api.github.com/users/klimentij/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/klimentij/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/klimentij/subscriptions",
            "organizations_url": "https://api.github.com/users/klimentij/orgs",
            "repos_url": "https://api.github.com/users/klimentij/repos",
            "events_url": "https://api.github.com/users/klimentij/events{/privacy}",
            "received_events_url": "https://api.github.com/users/klimentij/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-16T14:02:01Z",
        "updated_at": "2020-09-16T14:05:00Z",
        "author_association": "NONE",
        "body": "> @klimentij,\r\n> \r\n> Did you solve the issue?\r\n> \r\n> I added a [notebook](https://github.com/microsoft/onnxruntime/blob/master/onnxruntime/python/tools/transformers/notebooks/Inference_GPT2_with_OnnxRuntime_on_CPU.ipynb) for GPT-2 with example for generation.\r\n> \r\n> In this case batch_size=1, past_sequence_length=145 and sequence_length=1. The attention mask shape should be [1,146].\r\n\r\nI manged to convert my fine-tuned GPT2-1.5B with `benchmark_gpt2.py`. Then in this notebook I replaced fp32 with fp16 and put all tensors to cuda â€” and the model started working on cuda. \r\n\r\nI can observe 4-10x speedups (depending on the batch size) on GPU comparing to Higgingface Pytorch model. \r\n\r\nThank you! You saved my day.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/693426635/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/693430895",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-693430895",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 693430895,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MzQzMDg5NQ==",
        "user": {
            "login": "klimentij",
            "id": 3247669,
            "node_id": "MDQ6VXNlcjMyNDc2Njk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3247669?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/klimentij",
            "html_url": "https://github.com/klimentij",
            "followers_url": "https://api.github.com/users/klimentij/followers",
            "following_url": "https://api.github.com/users/klimentij/following{/other_user}",
            "gists_url": "https://api.github.com/users/klimentij/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/klimentij/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/klimentij/subscriptions",
            "organizations_url": "https://api.github.com/users/klimentij/orgs",
            "repos_url": "https://api.github.com/users/klimentij/repos",
            "events_url": "https://api.github.com/users/klimentij/events{/privacy}",
            "received_events_url": "https://api.github.com/users/klimentij/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-16T14:08:48Z",
        "updated_at": "2020-09-16T14:08:48Z",
        "author_association": "NONE",
        "body": "> @tianleiwu Thanks for the GPT2 example!\r\n> could you provide some beam-search example code with onnx GPT2 please?\r\n\r\nI'm about to slightly modify and plug-in generation code from Hugginface, there's also a beam search there: https://github.com/huggingface/transformers/blob/master/src/transformers/generation_utils.py\r\n\r\nMight be helpful @carter54 ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/693430895/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/694598247",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-694598247",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 694598247,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5NDU5ODI0Nw==",
        "user": {
            "login": "carter54",
            "id": 26741594,
            "node_id": "MDQ6VXNlcjI2NzQxNTk0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26741594?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carter54",
            "html_url": "https://github.com/carter54",
            "followers_url": "https://api.github.com/users/carter54/followers",
            "following_url": "https://api.github.com/users/carter54/following{/other_user}",
            "gists_url": "https://api.github.com/users/carter54/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carter54/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carter54/subscriptions",
            "organizations_url": "https://api.github.com/users/carter54/orgs",
            "repos_url": "https://api.github.com/users/carter54/repos",
            "events_url": "https://api.github.com/users/carter54/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carter54/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-18T01:40:04Z",
        "updated_at": "2020-09-18T01:40:04Z",
        "author_association": "NONE",
        "body": "@klimentij Thanks for the reply. I have tried hugginface code, but it includes a lot of matrix operations by torch, I'm trying to replace them by numpy (because torch package is 800Mb+). The greedy search works now, and the numpy version works faster than the torch version. Working on numpy version of beam search now...",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/694598247/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/753802316",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-753802316",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 753802316,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc1MzgwMjMxNg==",
        "user": {
            "login": "carter54",
            "id": 26741594,
            "node_id": "MDQ6VXNlcjI2NzQxNTk0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26741594?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carter54",
            "html_url": "https://github.com/carter54",
            "followers_url": "https://api.github.com/users/carter54/followers",
            "following_url": "https://api.github.com/users/carter54/following{/other_user}",
            "gists_url": "https://api.github.com/users/carter54/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carter54/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carter54/subscriptions",
            "organizations_url": "https://api.github.com/users/carter54/orgs",
            "repos_url": "https://api.github.com/users/carter54/repos",
            "events_url": "https://api.github.com/users/carter54/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carter54/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-01-04T07:15:22Z",
        "updated_at": "2021-01-04T07:15:35Z",
        "author_association": "NONE",
        "body": "@klimentij Hi friend~ Can I ask some questions about deploying gpt with onnxruntime-gpu?\r\n1. did you use io binding? I meet a problem with I passed empty past state in the first step inference.\r\n2. when using onnxruntime-gpu for gpt inference, did you see a lot of warning like this \"[W:onnxruntime:Default, fallback_cpu_capability.h:140 GetCpuPreferedNodes] Force fallback to CPU execution for node: Gather_2996\"? It seems that some node are calculated in CPU. I assume this will cost extra time to copying data between cpu and gpu...\r\n\r\nThanks in advance!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/753802316/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/757142668",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-757142668",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 757142668,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc1NzE0MjY2OA==",
        "user": {
            "login": "klimentij",
            "id": 3247669,
            "node_id": "MDQ6VXNlcjMyNDc2Njk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3247669?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/klimentij",
            "html_url": "https://github.com/klimentij",
            "followers_url": "https://api.github.com/users/klimentij/followers",
            "following_url": "https://api.github.com/users/klimentij/following{/other_user}",
            "gists_url": "https://api.github.com/users/klimentij/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/klimentij/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/klimentij/subscriptions",
            "organizations_url": "https://api.github.com/users/klimentij/orgs",
            "repos_url": "https://api.github.com/users/klimentij/repos",
            "events_url": "https://api.github.com/users/klimentij/events{/privacy}",
            "received_events_url": "https://api.github.com/users/klimentij/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-01-09T12:33:28Z",
        "updated_at": "2021-01-09T12:33:28Z",
        "author_association": "NONE",
        "body": "@carter54 \r\n> 1. did you use io binding? I meet a problem with I passed empty past state in the first step inference.\r\n\r\nYes, like that:\r\n```\r\ndef inference_with_io_binding(session, config, input_ids, position_ids, attention_mask, past):\r\n    output_shapes = Gpt2Helper.get_output_shapes(batch_size=input_ids.size(0),\r\n                                                 past_sequence_length=past[0].size(\r\n                                                     3),\r\n                                                 sequence_length=input_ids.size(\r\n                                                     1),\r\n                                                 config=config)\r\n    output_buffers = Gpt2Helper.get_output_buffers(\r\n        output_shapes, device, is_float16=True)\r\n\r\n    io_binding = Gpt2Helper.prepare_io_binding(session, input_ids, position_ids, attention_mask, past,\r\n                                               output_buffers, output_shapes)\r\n    session.run_with_iobinding(io_binding)\r\n\r\n    outputs = Gpt2Helper.get_outputs_from_io_binding_buffer(session, output_buffers, output_shapes,\r\n                                                            return_numpy=False)\r\n    return outputs\r\n```\r\n\r\n> 2. when using onnxruntime-gpu for gpt inference, did you see a lot of warning like this \"[W:onnxruntime:Default, fallback_cpu_capability.h:140 GetCpuPreferedNodes] Force fallback to CPU execution for node: Gather_2996\"? It seems that some node are calculated in CPU. I assume this will cost extra time to copying data between cpu and gpu...\r\n\r\nNo, I haven't met this issue\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/757142668/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/757630077",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4756#issuecomment-757630077",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4756",
        "id": 757630077,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc1NzYzMDA3Nw==",
        "user": {
            "login": "carter54",
            "id": 26741594,
            "node_id": "MDQ6VXNlcjI2NzQxNTk0",
            "avatar_url": "https://avatars.githubusercontent.com/u/26741594?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carter54",
            "html_url": "https://github.com/carter54",
            "followers_url": "https://api.github.com/users/carter54/followers",
            "following_url": "https://api.github.com/users/carter54/following{/other_user}",
            "gists_url": "https://api.github.com/users/carter54/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carter54/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carter54/subscriptions",
            "organizations_url": "https://api.github.com/users/carter54/orgs",
            "repos_url": "https://api.github.com/users/carter54/repos",
            "events_url": "https://api.github.com/users/carter54/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carter54/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-01-11T05:22:55Z",
        "updated_at": "2021-01-11T05:22:55Z",
        "author_association": "NONE",
        "body": "@klimentij Thx mate!\r\nMy first issue is due to the version of onnxruntime (1.6.0), rolling back to 1.5.2 solved my problem.\r\nSecond issue might relate to the model conversion from torch to onnx.\r\nAnyway, thx for your suggestions~",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/757630077/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]