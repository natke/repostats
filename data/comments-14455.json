[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1408312834",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1408312834",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1408312834,
        "node_id": "IC_kwDOCVq1mM5T8SYC",
        "user": {
            "login": "carsten-schultz-pix4d",
            "id": 95354687,
            "node_id": "U_kgDOBa7_Pw",
            "avatar_url": "https://avatars.githubusercontent.com/u/95354687?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carsten-schultz-pix4d",
            "html_url": "https://github.com/carsten-schultz-pix4d",
            "followers_url": "https://api.github.com/users/carsten-schultz-pix4d/followers",
            "following_url": "https://api.github.com/users/carsten-schultz-pix4d/following{/other_user}",
            "gists_url": "https://api.github.com/users/carsten-schultz-pix4d/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carsten-schultz-pix4d/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carsten-schultz-pix4d/subscriptions",
            "organizations_url": "https://api.github.com/users/carsten-schultz-pix4d/orgs",
            "repos_url": "https://api.github.com/users/carsten-schultz-pix4d/repos",
            "events_url": "https://api.github.com/users/carsten-schultz-pix4d/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carsten-schultz-pix4d/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-30T09:58:52Z",
        "updated_at": "2023-01-30T09:58:52Z",
        "author_association": "NONE",
        "body": "A bot tagged this for \"mobile\".  We are dealing with macOS here, I specified the ARM architecture because the Macbook on which I tested happens to have an M1 processor. I do not know enough about iOS/iPadOS to say whether this is a problem on there, too. I do not know if pure C++ applications are even possible on those platforms, so the situation may be different.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1408312834/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1409105853",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1409105853",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1409105853,
        "node_id": "IC_kwDOCVq1mM5T_T-9",
        "user": {
            "login": "yuslepukhin",
            "id": 11303988,
            "node_id": "MDQ6VXNlcjExMzAzOTg4",
            "avatar_url": "https://avatars.githubusercontent.com/u/11303988?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yuslepukhin",
            "html_url": "https://github.com/yuslepukhin",
            "followers_url": "https://api.github.com/users/yuslepukhin/followers",
            "following_url": "https://api.github.com/users/yuslepukhin/following{/other_user}",
            "gists_url": "https://api.github.com/users/yuslepukhin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/yuslepukhin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/yuslepukhin/subscriptions",
            "organizations_url": "https://api.github.com/users/yuslepukhin/orgs",
            "repos_url": "https://api.github.com/users/yuslepukhin/repos",
            "events_url": "https://api.github.com/users/yuslepukhin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/yuslepukhin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-30T18:21:56Z",
        "updated_at": "2023-01-30T18:21:56Z",
        "author_association": "MEMBER",
        "body": "You are welcome to submit a patch. Thanks for reporting it.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1409105853/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1425014287",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1425014287",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1425014287,
        "node_id": "IC_kwDOCVq1mM5U7_4P",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-10T00:27:11Z",
        "updated_at": "2023-02-10T00:27:11Z",
        "author_association": "MEMBER",
        "body": "TBH we don't usually write Objective-C code either so we don't claim any expertise there.\r\n\r\nAre there any potential issues with adding the `@autoreleasepool` blocks, in particular with the lifetime of objects that are returned from within the block? \r\n\r\nI didn't notice any places in model.h that could be wrapped.\r\n\r\nWould it just be things in the Execution class in model.mm that need to be wrapped if that's the class used to bridge to Objective-C (according to the comment anyway)?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1425014287/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1426276067",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1426276067",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1426276067,
        "node_id": "IC_kwDOCVq1mM5VAz7j",
        "user": {
            "login": "carsten-schultz-pix4d",
            "id": 95354687,
            "node_id": "U_kgDOBa7_Pw",
            "avatar_url": "https://avatars.githubusercontent.com/u/95354687?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carsten-schultz-pix4d",
            "html_url": "https://github.com/carsten-schultz-pix4d",
            "followers_url": "https://api.github.com/users/carsten-schultz-pix4d/followers",
            "following_url": "https://api.github.com/users/carsten-schultz-pix4d/following{/other_user}",
            "gists_url": "https://api.github.com/users/carsten-schultz-pix4d/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carsten-schultz-pix4d/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carsten-schultz-pix4d/subscriptions",
            "organizations_url": "https://api.github.com/users/carsten-schultz-pix4d/orgs",
            "repos_url": "https://api.github.com/users/carsten-schultz-pix4d/repos",
            "events_url": "https://api.github.com/users/carsten-schultz-pix4d/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carsten-schultz-pix4d/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-10T20:02:05Z",
        "updated_at": "2023-02-10T20:02:05Z",
        "author_association": "NONE",
        "body": "Thanks for coming back to this.\r\n\r\nAll expertise in Objective C memory handling that I can offer comes from one day of Internet search after locating the memory leak in our program. Doing a bit more reading right now I realise that that is certainly not enough. Also, looking again at `model.mm` I see that I had previously misidentified the border between onnxruntime and CoreML code.\r\n\r\nThe code change from my initial comment is used by us and has been tested to resolve the memory leak with any adverse effect. Of course it would be ideal to have extensive test coverage and run it with both ASAN and a leak checker, but the world is rarely ideal.\r\n\r\nLooking at `model.mm` again I think that you are right that it would suffice to add the autorelease blocks in the `Execution` class. We have actually also added one in the block that contains `[execution_ loadModel]`. The statement in the constructor looks harmless, so that's probably it then. The relevant functions in `Execution` only return enums, so even not fully understanding all aspects of this it seems safe to me.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1426276067/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1433974787",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1433974787",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1433974787,
        "node_id": "IC_kwDOCVq1mM5VeLgD",
        "user": {
            "login": "edgchen1",
            "id": 18449977,
            "node_id": "MDQ6VXNlcjE4NDQ5OTc3",
            "avatar_url": "https://avatars.githubusercontent.com/u/18449977?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/edgchen1",
            "html_url": "https://github.com/edgchen1",
            "followers_url": "https://api.github.com/users/edgchen1/followers",
            "following_url": "https://api.github.com/users/edgchen1/following{/other_user}",
            "gists_url": "https://api.github.com/users/edgchen1/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/edgchen1/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/edgchen1/subscriptions",
            "organizations_url": "https://api.github.com/users/edgchen1/orgs",
            "repos_url": "https://api.github.com/users/edgchen1/repos",
            "events_url": "https://api.github.com/users/edgchen1/events{/privacy}",
            "received_events_url": "https://api.github.com/users/edgchen1/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-17T01:36:58Z",
        "updated_at": "2023-02-17T01:36:58Z",
        "author_association": "MEMBER",
        "body": "This issue about a memory leak from CoreML seems relevant.\r\nhttps://developer.apple.com/forums/thread/692425\r\n\r\nThe suggested fix is to wrap the CoreML prediction call in an `@autoreleasepool` block.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1433974787/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1435441203",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1435441203",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1435441203,
        "node_id": "IC_kwDOCVq1mM5Vjxgz",
        "user": {
            "login": "edgchen1",
            "id": 18449977,
            "node_id": "MDQ6VXNlcjE4NDQ5OTc3",
            "avatar_url": "https://avatars.githubusercontent.com/u/18449977?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/edgchen1",
            "html_url": "https://github.com/edgchen1",
            "followers_url": "https://api.github.com/users/edgchen1/followers",
            "following_url": "https://api.github.com/users/edgchen1/following{/other_user}",
            "gists_url": "https://api.github.com/users/edgchen1/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/edgchen1/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/edgchen1/subscriptions",
            "organizations_url": "https://api.github.com/users/edgchen1/orgs",
            "repos_url": "https://api.github.com/users/edgchen1/repos",
            "events_url": "https://api.github.com/users/edgchen1/events{/privacy}",
            "received_events_url": "https://api.github.com/users/edgchen1/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-18T01:28:33Z",
        "updated_at": "2023-02-18T01:28:33Z",
        "author_association": "MEMBER",
        "body": "@carsten-schultz-pix4d\r\nPlease see #14738. Tested it locally with a program that repeatedly calls Ort::Session::Run(). Not sure if it exactly matches your scenario, please feel free to verify the changes on your end.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1435441203/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1437047877",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14455#issuecomment-1437047877",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14455",
        "id": 1437047877,
        "node_id": "IC_kwDOCVq1mM5Vp5xF",
        "user": {
            "login": "carsten-schultz-pix4d",
            "id": 95354687,
            "node_id": "U_kgDOBa7_Pw",
            "avatar_url": "https://avatars.githubusercontent.com/u/95354687?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/carsten-schultz-pix4d",
            "html_url": "https://github.com/carsten-schultz-pix4d",
            "followers_url": "https://api.github.com/users/carsten-schultz-pix4d/followers",
            "following_url": "https://api.github.com/users/carsten-schultz-pix4d/following{/other_user}",
            "gists_url": "https://api.github.com/users/carsten-schultz-pix4d/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/carsten-schultz-pix4d/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/carsten-schultz-pix4d/subscriptions",
            "organizations_url": "https://api.github.com/users/carsten-schultz-pix4d/orgs",
            "repos_url": "https://api.github.com/users/carsten-schultz-pix4d/repos",
            "events_url": "https://api.github.com/users/carsten-schultz-pix4d/events{/privacy}",
            "received_events_url": "https://api.github.com/users/carsten-schultz-pix4d/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-02-20T13:44:36Z",
        "updated_at": "2023-02-20T13:44:36Z",
        "author_association": "NONE",
        "body": "@edgchen1, thank you. I did not do further tests, but we use very similar changes.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1437047877/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]