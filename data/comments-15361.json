[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496546282",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496546282",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496546282,
        "node_id": "IC_kwDOCVq1mM5ZM3vq",
        "user": {
            "login": "abock",
            "id": 49539,
            "node_id": "MDQ6VXNlcjQ5NTM5",
            "avatar_url": "https://avatars.githubusercontent.com/u/49539?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/abock",
            "html_url": "https://github.com/abock",
            "followers_url": "https://api.github.com/users/abock/followers",
            "following_url": "https://api.github.com/users/abock/following{/other_user}",
            "gists_url": "https://api.github.com/users/abock/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/abock/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/abock/subscriptions",
            "organizations_url": "https://api.github.com/users/abock/orgs",
            "repos_url": "https://api.github.com/users/abock/repos",
            "events_url": "https://api.github.com/users/abock/events{/privacy}",
            "received_events_url": "https://api.github.com/users/abock/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:14:13Z",
        "updated_at": "2023-04-04T20:14:13Z",
        "author_association": "MEMBER",
        "body": "For me, both the \"works\" and \"segfault\" versions of the model crash on both of my machines:\r\n\r\n|OS|ORT|Python|\r\n|-|-|-|\r\n|Ubuntu 22.04|1.14.1|3.10.6|\r\n|macOS 13.2.1|1.14.1|3.10.10|\r\n\r\nThis appears to be coming from the pybind layer of ORT (at least from the non-debug stack trace I see in gdb). [I cannot repro the crash using the C API](https://github.com/microsoft/onnx-script/issues/523#issuecomment-1496523812).\r\n\r\n### Simpler repro case using Python\r\n\r\n```python\r\nimport onnxruntime\r\nimport sys\r\nonnxruntime.InferenceSession(sys.argv[1])\r\n```\r\n\r\n```\r\nThread 1 \"python3.10\" received signal SIGSEGV, Segmentation fault.\r\n__memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:370\r\n370\t../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S: No such file or directory.\r\n(gdb) bt\r\n#0  __memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:370\r\n#1  0x00007ffff713572e in std::basic_streambuf<char, std::char_traits<char> >::xsputn(char const*, long) () from /lib/x86_64-linux-gnu/libstdc++.so.6\r\n#2  0x00007ffff7127b35 in std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) () from /lib/x86_64-linux-gnu/libstdc++.so.6\r\n#3  0x00007fffa46a0149 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#4  0x00007fffa4bf1b49 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#5  0x00007fffa4bfac2c in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#6  0x00007fffa4c01a2a in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#7  0x00007fffa4c05211 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#8  0x00007fffa4c6d482 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#9  0x00007fffa4cd8847 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#10 0x00007fffa4cda322 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#11 0x00007fffa4cdb3ee in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#12 0x00007fffa4cdb88b in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#13 0x00007fffa4ce5c42 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#14 0x00007fffa46fa165 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#15 0x00007fffa46fa200 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#16 0x00007fffa47291e8 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#17 0x00007fffa47396e7 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#18 0x00007fffa46e7437 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#19 0x00007fffa4dad689 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#20 0x00005555556b099e in ?? ()\r\n#21 0x00005555556a74ab in _PyObject_MakeTpCall ()\r\n#22 0x00005555556bf060 in ?? ()\r\n#23 0x00005555556bb4b7 in ?? ()\r\n#24 0x00005555556a785b in ?? ()\r\n#25 0x00007fffa4d9af93 in ?? () from /home/aaron/.local/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_pybind11_state.cpython-310-x86_64-linux-gnu.so\r\n#26 0x00005555556a74ab in _PyObject_MakeTpCall ()\r\n#27 0x000055555569fe66 in _PyEval_EvalFrameDefault ()\r\n#28 0x00005555556b11ec in _PyFunction_Vectorcall ()\r\n#29 0x00005555556998cb in _PyEval_EvalFrameDefault ()\r\n#30 0x00005555556a6634 in _PyObject_FastCallDictTstate ()\r\n#31 0x00005555556bae94 in ?? ()\r\n#32 0x00005555556a744c in _PyObject_MakeTpCall ()\r\n#33 0x000055555569fe66 in _PyEval_EvalFrameDefault ()\r\n#34 0x0000555555695ed6 in ?? ()\r\n#35 0x000055555578c366 in PyEval_EvalCode ()\r\n#36 0x00005555557b9108 in ?? ()\r\n#37 0x00005555557b1f5b in ?? ()\r\n#38 0x00005555557b8e55 in ?? ()\r\n#39 0x00005555557b8338 in _PyRun_SimpleFileObject ()\r\n#40 0x00005555557b8033 in _PyRun_AnyFileObject ()\r\n#41 0x00005555557a92de in Py_RunMain ()\r\n#42 0x000055555577f32d in Py_BytesMain ()\r\n#43 0x00007ffff7c78d90 in __libc_start_call_main (main=main@entry=0x55555577f2f0, argc=argc@entry=3, argv=argv@entry=0x7fffffffe3a8)\r\n    at ../sysdeps/nptl/libc_start_call_main.h:58\r\n#44 0x00007ffff7c78e40 in __libc_start_main_impl (main=0x55555577f2f0, argc=3, argv=0x7fffffffe3a8, init=<optimized out>, fini=<optimized out>,\r\n    rtld_fini=<optimized out>, stack_end=0x7fffffffe398) at ../csu/libc-start.c:392\r\n#45 0x000055555577f225 in _start ()\r\n(gdb)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496546282/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496558459",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496558459",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496558459,
        "node_id": "IC_kwDOCVq1mM5ZM6t7",
        "user": {
            "login": "baijumeswani",
            "id": 12852605,
            "node_id": "MDQ6VXNlcjEyODUyNjA1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12852605?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/baijumeswani",
            "html_url": "https://github.com/baijumeswani",
            "followers_url": "https://api.github.com/users/baijumeswani/followers",
            "following_url": "https://api.github.com/users/baijumeswani/following{/other_user}",
            "gists_url": "https://api.github.com/users/baijumeswani/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/baijumeswani/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/baijumeswani/subscriptions",
            "organizations_url": "https://api.github.com/users/baijumeswani/orgs",
            "repos_url": "https://api.github.com/users/baijumeswani/repos",
            "events_url": "https://api.github.com/users/baijumeswani/events{/privacy}",
            "received_events_url": "https://api.github.com/users/baijumeswani/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:24:52Z",
        "updated_at": "2023-04-04T20:24:52Z",
        "author_association": "MEMBER",
        "body": "I tried on ort main (Ubuntu)\r\n\r\n```py\r\nfrom onnxruntime import InferenceSession\r\nsess = InferenceSession(\"model_segfault.onnx\", providers=[\"CPUExecutionProvider\"])\r\n```\r\n\r\nIt did not crash for me. \r\n\r\nWill try on 1.14.1 as well.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496558459/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496572657",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496572657",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496572657,
        "node_id": "IC_kwDOCVq1mM5ZM-Lx",
        "user": {
            "login": "baijumeswani",
            "id": 12852605,
            "node_id": "MDQ6VXNlcjEyODUyNjA1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12852605?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/baijumeswani",
            "html_url": "https://github.com/baijumeswani",
            "followers_url": "https://api.github.com/users/baijumeswani/followers",
            "following_url": "https://api.github.com/users/baijumeswani/following{/other_user}",
            "gists_url": "https://api.github.com/users/baijumeswani/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/baijumeswani/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/baijumeswani/subscriptions",
            "organizations_url": "https://api.github.com/users/baijumeswani/orgs",
            "repos_url": "https://api.github.com/users/baijumeswani/repos",
            "events_url": "https://api.github.com/users/baijumeswani/events{/privacy}",
            "received_events_url": "https://api.github.com/users/baijumeswani/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:35:47Z",
        "updated_at": "2023-04-04T20:36:22Z",
        "author_association": "MEMBER",
        "body": "Can reproduce the crash on 1.14.1.\r\n\r\nBut am able to load the `InferenceSession` when ort main is built from source. I wonder if there was some fix that went in recently. Will try to dig that out.\r\n\r\nIn the meantime, could ort main be used for your testing @titaiwangms?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496572657/reactions",
            "total_count": 2,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 1,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496577249",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496577249",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496577249,
        "node_id": "IC_kwDOCVq1mM5ZM_Th",
        "user": {
            "login": "titaiwangms",
            "id": 18010845,
            "node_id": "MDQ6VXNlcjE4MDEwODQ1",
            "avatar_url": "https://avatars.githubusercontent.com/u/18010845?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/titaiwangms",
            "html_url": "https://github.com/titaiwangms",
            "followers_url": "https://api.github.com/users/titaiwangms/followers",
            "following_url": "https://api.github.com/users/titaiwangms/following{/other_user}",
            "gists_url": "https://api.github.com/users/titaiwangms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/titaiwangms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/titaiwangms/subscriptions",
            "organizations_url": "https://api.github.com/users/titaiwangms/orgs",
            "repos_url": "https://api.github.com/users/titaiwangms/repos",
            "events_url": "https://api.github.com/users/titaiwangms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/titaiwangms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:39:37Z",
        "updated_at": "2023-04-04T20:39:37Z",
        "author_association": "MEMBER",
        "body": "Thanks for the check! I haven't built ORT from source for a while, but will try it. @abock you can go ahead and test on you devices if you already have main branch!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496577249/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496586894",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496586894",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496586894,
        "node_id": "IC_kwDOCVq1mM5ZNBqO",
        "user": {
            "login": "thiagocrepaldi",
            "id": 5469809,
            "node_id": "MDQ6VXNlcjU0Njk4MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5469809?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thiagocrepaldi",
            "html_url": "https://github.com/thiagocrepaldi",
            "followers_url": "https://api.github.com/users/thiagocrepaldi/followers",
            "following_url": "https://api.github.com/users/thiagocrepaldi/following{/other_user}",
            "gists_url": "https://api.github.com/users/thiagocrepaldi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thiagocrepaldi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thiagocrepaldi/subscriptions",
            "organizations_url": "https://api.github.com/users/thiagocrepaldi/orgs",
            "repos_url": "https://api.github.com/users/thiagocrepaldi/repos",
            "events_url": "https://api.github.com/users/thiagocrepaldi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thiagocrepaldi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:48:22Z",
        "updated_at": "2023-04-04T20:48:22Z",
        "author_association": "MEMBER",
        "body": "Both models worked on cpu execution provider using torch and ort master\r\n\r\n```python\r\n\r\n\r\n​import onnx\r\nimport onnxruntime as ort\r\n\r\n# thiagofc: tried both\r\n#model = onnx.load(\"model_works.onnx\")  # worked\r\nmodel = onnx.load(\"model_segfault.onnx\")  # worked\r\n\r\nmodel_string = model.SerializeToString()\r\nprint(model_string)\r\nsess_options = ort.SessionOptions()\r\nsess_options.graph_optimization_level = ort.GraphOptimizationLevel.ORT_DISABLE_ALL\r\n\r\n# thiagofc: updated InferenceSession signature\r\nsess = ort.InferenceSession(model_string, providers=[\"CPUExecutionProvider\"])\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496586894/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496590742",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496590742",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496590742,
        "node_id": "IC_kwDOCVq1mM5ZNCmW",
        "user": {
            "login": "thiagocrepaldi",
            "id": 5469809,
            "node_id": "MDQ6VXNlcjU0Njk4MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5469809?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/thiagocrepaldi",
            "html_url": "https://github.com/thiagocrepaldi",
            "followers_url": "https://api.github.com/users/thiagocrepaldi/followers",
            "following_url": "https://api.github.com/users/thiagocrepaldi/following{/other_user}",
            "gists_url": "https://api.github.com/users/thiagocrepaldi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/thiagocrepaldi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/thiagocrepaldi/subscriptions",
            "organizations_url": "https://api.github.com/users/thiagocrepaldi/orgs",
            "repos_url": "https://api.github.com/users/thiagocrepaldi/repos",
            "events_url": "https://api.github.com/users/thiagocrepaldi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/thiagocrepaldi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T20:51:45Z",
        "updated_at": "2023-04-04T20:51:45Z",
        "author_association": "MEMBER",
        "body": "Please note the snippet above only instantiates `InferenceSession`. It doesn't execute the model with any data. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496590742/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496659058",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/15361#issuecomment-1496659058",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/15361",
        "id": 1496659058,
        "node_id": "IC_kwDOCVq1mM5ZNTRy",
        "user": {
            "login": "titaiwangms",
            "id": 18010845,
            "node_id": "MDQ6VXNlcjE4MDEwODQ1",
            "avatar_url": "https://avatars.githubusercontent.com/u/18010845?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/titaiwangms",
            "html_url": "https://github.com/titaiwangms",
            "followers_url": "https://api.github.com/users/titaiwangms/followers",
            "following_url": "https://api.github.com/users/titaiwangms/following{/other_user}",
            "gists_url": "https://api.github.com/users/titaiwangms/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/titaiwangms/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/titaiwangms/subscriptions",
            "organizations_url": "https://api.github.com/users/titaiwangms/orgs",
            "repos_url": "https://api.github.com/users/titaiwangms/repos",
            "events_url": "https://api.github.com/users/titaiwangms/events{/privacy}",
            "received_events_url": "https://api.github.com/users/titaiwangms/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-04-04T22:02:23Z",
        "updated_at": "2023-04-04T22:02:49Z",
        "author_association": "MEMBER",
        "body": "Confirmed it's been fixed! Also, test_mnist is unblocked. Thanks!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1496659058/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]