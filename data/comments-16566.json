[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1617133422",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16566#issuecomment-1617133422",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16566",
        "id": 1617133422,
        "node_id": "IC_kwDOCVq1mM5gY39u",
        "user": {
            "login": "cloudhan",
            "id": 1279292,
            "node_id": "MDQ6VXNlcjEyNzkyOTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1279292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cloudhan",
            "html_url": "https://github.com/cloudhan",
            "followers_url": "https://api.github.com/users/cloudhan/followers",
            "following_url": "https://api.github.com/users/cloudhan/following{/other_user}",
            "gists_url": "https://api.github.com/users/cloudhan/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cloudhan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cloudhan/subscriptions",
            "organizations_url": "https://api.github.com/users/cloudhan/orgs",
            "repos_url": "https://api.github.com/users/cloudhan/repos",
            "events_url": "https://api.github.com/users/cloudhan/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cloudhan/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-03T02:38:05Z",
        "updated_at": "2023-07-03T02:38:05Z",
        "author_association": "MEMBER",
        "body": "@borg323 Could you provide the command line you used for building from source? `hipErrorInvalidDeviceFunction` indicate an architecture mismatch.\r\n\r\nFor onnxruntime itself, the hip arch is populated from cmake as follows. By default, it does not contain a gfx1100 corresponds to  7900 XTX.\r\n\r\nhttps://github.com/microsoft/onnxruntime/blob/f46956056d7f8ea214e794e5cbedee36f21f7ea2/cmake/CMakeLists.txt#L274-L276\r\n\r\nThere is another case that we deeply integrate with composable kernel where it hardcoded hip archs in its CMakeLists.txt \r\n\r\nhttps://github.com/ROCmSoftwarePlatform/composable_kernel/blob/7797bd3d2b047ab6ccd7b3618bf40f79bf234723/library/src/tensor_operation_instance/gpu/CMakeLists.txt#L51-L56 You might need to disable ck as a whole for now.\r\n\r\nCould you please try out the follow commands\r\n```bash\r\nbuild.sh \\\r\n        --build_dir build \\\r\n        --config Release \\\r\n        --cmake_generator Ninja \\\r\n        --cmake_extra_defines \\\r\n            CMAKE_HIP_ARCHITECTURES=gfx906,gfx1030,gfx1100 \\\r\n            onnxruntime_USE_COMPOSABLE_KERNEL=OFF \\\r\n        --use_rocm \\\r\n        --build_wheel --rocm_version 5.4.3 \\\r\n        --rocm_home=/opt/rocm-5.4.3 --nccl_home=/opt/rocm \\\r\n        --skip_submodule_sync --skip_tests\r\n```\r\n\r\nA further note is that we primarily built onnxruntime for our internal CDNA2 arch cards and only run tests for gfx90a and gfx908.  We cannot support customer grade cards due to the lacking of CI machines. \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1617133422/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1619073343",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16566#issuecomment-1619073343",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16566",
        "id": 1619073343,
        "node_id": "IC_kwDOCVq1mM5ggRk_",
        "user": {
            "login": "borg323",
            "id": 39573933,
            "node_id": "MDQ6VXNlcjM5NTczOTMz",
            "avatar_url": "https://avatars.githubusercontent.com/u/39573933?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/borg323",
            "html_url": "https://github.com/borg323",
            "followers_url": "https://api.github.com/users/borg323/followers",
            "following_url": "https://api.github.com/users/borg323/following{/other_user}",
            "gists_url": "https://api.github.com/users/borg323/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/borg323/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/borg323/subscriptions",
            "organizations_url": "https://api.github.com/users/borg323/orgs",
            "repos_url": "https://api.github.com/users/borg323/repos",
            "events_url": "https://api.github.com/users/borg323/events{/privacy}",
            "received_events_url": "https://api.github.com/users/borg323/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-03T19:58:52Z",
        "updated_at": "2023-07-03T19:58:52Z",
        "author_association": "NONE",
        "body": "Thanks, this fixed the issue.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1619073343/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1620537528",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/16566#issuecomment-1620537528",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/16566",
        "id": 1620537528,
        "node_id": "IC_kwDOCVq1mM5gl3C4",
        "user": {
            "login": "Displacer",
            "id": 1288799,
            "node_id": "MDQ6VXNlcjEyODg3OTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1288799?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Displacer",
            "html_url": "https://github.com/Displacer",
            "followers_url": "https://api.github.com/users/Displacer/followers",
            "following_url": "https://api.github.com/users/Displacer/following{/other_user}",
            "gists_url": "https://api.github.com/users/Displacer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Displacer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Displacer/subscriptions",
            "organizations_url": "https://api.github.com/users/Displacer/orgs",
            "repos_url": "https://api.github.com/users/Displacer/repos",
            "events_url": "https://api.github.com/users/Displacer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Displacer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-07-04T16:55:39Z",
        "updated_at": "2023-07-04T16:55:39Z",
        "author_association": "NONE",
        "body": "exact build command was:\r\n\r\n./build.sh --allow_running_as_root --cmake_extra_defines ONNXRUNTIME_VERSION=`cat ./VERSION_NUMBER` \\\r\n    \t    CMAKE_HIP_ARCHITECTURES=gfx906,gfx1030,gfx1100 \\\r\n            onnxruntime_USE_COMPOSABLE_KERNEL=OFF \\\r\n\t    --config Release --parallel \\\r\n            --skip_tests --build_wheel --build_shared_lib --use_rocm --rocm_version=${ROCM_VERSION} --rocm_home /opt/rocm --use_migraphx \r\n\r\nwith rocm-5.6",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1620537528/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]