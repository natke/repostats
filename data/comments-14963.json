[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460874751",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14963#issuecomment-1460874751",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14963",
        "id": 1460874751,
        "node_id": "IC_kwDOCVq1mM5XEy3_",
        "user": {
            "login": "wangyems",
            "id": 52801275,
            "node_id": "MDQ6VXNlcjUyODAxMjc1",
            "avatar_url": "https://avatars.githubusercontent.com/u/52801275?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wangyems",
            "html_url": "https://github.com/wangyems",
            "followers_url": "https://api.github.com/users/wangyems/followers",
            "following_url": "https://api.github.com/users/wangyems/following{/other_user}",
            "gists_url": "https://api.github.com/users/wangyems/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wangyems/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wangyems/subscriptions",
            "organizations_url": "https://api.github.com/users/wangyems/orgs",
            "repos_url": "https://api.github.com/users/wangyems/repos",
            "events_url": "https://api.github.com/users/wangyems/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wangyems/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-08T21:05:28Z",
        "updated_at": "2023-03-08T21:05:28Z",
        "author_association": "MEMBER",
        "body": "we'll soon push the optimization and fix to the t5 model",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460874751/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460967311",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14963#issuecomment-1460967311",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14963",
        "id": 1460967311,
        "node_id": "IC_kwDOCVq1mM5XFJeP",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-08T22:29:54Z",
        "updated_at": "2023-03-08T22:29:54Z",
        "author_association": "MEMBER",
        "body": "For this, it need update symbolic shape inference for RelativePositionBias. @wangyems is working on this: https://github.com/microsoft/onnxruntime/pull/14967\r\n\r\n@brevity2021, \r\nBTW, we have some kernel optimization for T5 is in pull request:\r\nhttps://github.com/microsoft/onnxruntime/pull/14928\r\nYou might wait until that PR merged and use nightly package to evaluate all optimizations.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1460967311/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1461031007",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14963#issuecomment-1461031007",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14963",
        "id": 1461031007,
        "node_id": "IC_kwDOCVq1mM5XFZBf",
        "user": {
            "login": "brevity2021",
            "id": 88120581,
            "node_id": "MDQ6VXNlcjg4MTIwNTgx",
            "avatar_url": "https://avatars.githubusercontent.com/u/88120581?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/brevity2021",
            "html_url": "https://github.com/brevity2021",
            "followers_url": "https://api.github.com/users/brevity2021/followers",
            "following_url": "https://api.github.com/users/brevity2021/following{/other_user}",
            "gists_url": "https://api.github.com/users/brevity2021/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/brevity2021/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/brevity2021/subscriptions",
            "organizations_url": "https://api.github.com/users/brevity2021/orgs",
            "repos_url": "https://api.github.com/users/brevity2021/repos",
            "events_url": "https://api.github.com/users/brevity2021/events{/privacy}",
            "received_events_url": "https://api.github.com/users/brevity2021/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-08T23:30:31Z",
        "updated_at": "2023-03-08T23:30:31Z",
        "author_association": "NONE",
        "body": "Thank you @wangyems  and @tianleiwu ! \r\n\r\nActually, I am more interested in porting the mixed precision technique in this T5 example folder to [Pegasus](https://huggingface.co/docs/transformers/model_doc/pegasus) model exported to ONNX. I saw some related discussion in this [issue](https://github.com/microsoft/onnxruntime/issues/11119) but it was about one year ago. \r\n\r\nWonder if there are any new thoughts on the mixed precision conversion for models unable to use fp16. @tianleiwu you mentioned in the above issue that \"using float16 for past state (make sure past_key_values inputs and present outputs are in float16) bring most performance gain, and MatMul (and Attention) computed in fp16 has slight performance gain\". Does it still hold? \r\n\r\nMaybe it's not something you are working on right now, but appreciate it if there are any insights!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1461031007/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1464961493",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/14963#issuecomment-1464961493",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/14963",
        "id": 1464961493,
        "node_id": "IC_kwDOCVq1mM5XUYnV",
        "user": {
            "login": "tianleiwu",
            "id": 30328909,
            "node_id": "MDQ6VXNlcjMwMzI4OTA5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30328909?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tianleiwu",
            "html_url": "https://github.com/tianleiwu",
            "followers_url": "https://api.github.com/users/tianleiwu/followers",
            "following_url": "https://api.github.com/users/tianleiwu/following{/other_user}",
            "gists_url": "https://api.github.com/users/tianleiwu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tianleiwu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tianleiwu/subscriptions",
            "organizations_url": "https://api.github.com/users/tianleiwu/orgs",
            "repos_url": "https://api.github.com/users/tianleiwu/repos",
            "events_url": "https://api.github.com/users/tianleiwu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tianleiwu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-11T17:44:00Z",
        "updated_at": "2023-03-11T17:44:14Z",
        "author_association": "MEMBER",
        "body": "@brevity2021, The [fp16 conversion tool](https://github.com/microsoft/onnxruntime/blob/main/onnxruntime/python/tools/transformers/float16.py) is comprehensive. It could force some nodes or operators to run in float32 by node_block_list or op_block_list. I think it shall be able to apply to Pegasus model. \r\n\r\nYou will need to do some experiments to evaluate precision and latency to find the best trade-off setting.\r\nFor mixed precision conversion, the rule still hold that you can put MatMul and Attention to run in fp16. Depending on tolerance of precision loss, you might need put normalization (like LayerNormalization, SkipLayerNormalization etc) and activation (Like Gelu etc) to run in fp32.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1464961493/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]