[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832465022",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-832465022",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 832465022,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjQ2NTAyMg==",
        "user": {
            "login": "ytaous",
            "id": 4484531,
            "node_id": "MDQ6VXNlcjQ0ODQ1MzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4484531?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ytaous",
            "html_url": "https://github.com/ytaous",
            "followers_url": "https://api.github.com/users/ytaous/followers",
            "following_url": "https://api.github.com/users/ytaous/following{/other_user}",
            "gists_url": "https://api.github.com/users/ytaous/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ytaous/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ytaous/subscriptions",
            "organizations_url": "https://api.github.com/users/ytaous/orgs",
            "repos_url": "https://api.github.com/users/ytaous/repos",
            "events_url": "https://api.github.com/users/ytaous/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ytaous/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-05T07:09:27Z",
        "updated_at": "2021-05-05T07:13:07Z",
        "author_association": "MEMBER",
        "body": "Similar issue: https://github.com/microsoft/onnxruntime/issues/3687 and: https://github.com/microsoft/onnxruntime/issues/1670\r\n\r\n@hariharans29 ,  @BowenBao - I can repro the same error with the steps:\r\n1. clone from master \r\n2. ./build.sh --config RelWithDebInfo --build_shared_lib --parallel --build_wheel --skip_tests\r\n3. install the whl\r\n4. run with sample code like so:\r\n-------------------------------------------------\r\nimport numpy as np\r\nimport onnxruntime\r\nimport timeit\r\n\r\nsession = onnxruntime.InferenceSession('fish-keypoint-rcnn-resnet.onnx')\r\ninput_name = session.get_inputs()[0].name\r\nimage = np.random.rand(3, 544, 960).astype(np.float32)\r\n\r\ndef run():\r\n    session.run([], {input_name: image})\r\n\r\nfor i in range(10):\r\n    run()\r\n\r\n---------------------------------------------------\r\nAny idea?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832465022/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832566424",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-832566424",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 832566424,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjU2NjQyNA==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-05T10:01:03Z",
        "updated_at": "2021-05-05T10:01:03Z",
        "author_association": "MEMBER",
        "body": "I believe this matches numpy behavior though. The reduction fails if you attempt to reduce an axis with a value of 0 and keepdims of false. \r\n\r\n```\r\n>>> a = np.ndarray(shape=(0,4))\r\n>>> np.maximum.reduce(a, axis=0, keepdims=False).shape\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nValueError: zero-size array to reduction operation maximum which has no identity\r\n\r\n>>> np.maximum.reduce(a, axis=1, keepdims=False).shape\r\n(0,)\r\n\r\n>>> np.maximum.reduce(a, keepdims=False).shape\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nValueError: zero-size array to reduction operation maximum which has no identity\r\n```\r\n\r\ne.g. if I had a shape of {3, 0, 4} and specified reduction on axis 1, the output shape would be {3, 4} (dropping the reduced axis instead of reducing it to 1), which would be invalid as there was no data to start with.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832566424/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832896447",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-832896447",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 832896447,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjg5NjQ0Nw==",
        "user": {
            "login": "ytaous",
            "id": 4484531,
            "node_id": "MDQ6VXNlcjQ0ODQ1MzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4484531?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ytaous",
            "html_url": "https://github.com/ytaous",
            "followers_url": "https://api.github.com/users/ytaous/followers",
            "following_url": "https://api.github.com/users/ytaous/following{/other_user}",
            "gists_url": "https://api.github.com/users/ytaous/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ytaous/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ytaous/subscriptions",
            "organizations_url": "https://api.github.com/users/ytaous/orgs",
            "repos_url": "https://api.github.com/users/ytaous/repos",
            "events_url": "https://api.github.com/users/ytaous/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ytaous/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-05T18:03:09Z",
        "updated_at": "2021-05-05T18:03:09Z",
        "author_association": "MEMBER",
        "body": "@jf99 - close it for now - please check/adjust your model and see if you can work around it.\r\nThanks.\r\n\r\n![image](https://user-images.githubusercontent.com/4484531/117187875-3ff7ce00-ad91-11eb-980b-66d9200af48e.png)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/832896447/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833270375",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-833270375",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 833270375,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMzI3MDM3NQ==",
        "user": {
            "login": "jf99",
            "id": 7962377,
            "node_id": "MDQ6VXNlcjc5NjIzNzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7962377?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jf99",
            "html_url": "https://github.com/jf99",
            "followers_url": "https://api.github.com/users/jf99/followers",
            "following_url": "https://api.github.com/users/jf99/following{/other_user}",
            "gists_url": "https://api.github.com/users/jf99/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jf99/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jf99/subscriptions",
            "organizations_url": "https://api.github.com/users/jf99/orgs",
            "repos_url": "https://api.github.com/users/jf99/repos",
            "events_url": "https://api.github.com/users/jf99/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jf99/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-06T06:43:11Z",
        "updated_at": "2021-05-06T06:43:40Z",
        "author_association": "NONE",
        "body": "Thank you guys for your quick replies. Inference on this net worked with pytorch. So if you say the error is in the ONNX file, then probably something went wrong during the ONNX export.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833270375/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833272491",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-833272491",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 833272491,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMzI3MjQ5MQ==",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-06T06:47:18Z",
        "updated_at": "2021-05-06T06:48:13Z",
        "author_association": "MEMBER",
        "body": "The metadata for the ONNX model says pytorch version 1.3 was used. May be worth re-exporting the ONNX file with a newer version of pytorch, and if the problem persists file an issue in the pytorch github (as folks that work on the ONNX exporter would check that). ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833272491/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1210591772",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-1210591772",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 1210591772,
        "node_id": "IC_kwDOCVq1mM5IKCoc",
        "user": {
            "login": "gyenesvi",
            "id": 1384672,
            "node_id": "MDQ6VXNlcjEzODQ2NzI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1384672?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gyenesvi",
            "html_url": "https://github.com/gyenesvi",
            "followers_url": "https://api.github.com/users/gyenesvi/followers",
            "following_url": "https://api.github.com/users/gyenesvi/following{/other_user}",
            "gists_url": "https://api.github.com/users/gyenesvi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/gyenesvi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/gyenesvi/subscriptions",
            "organizations_url": "https://api.github.com/users/gyenesvi/orgs",
            "repos_url": "https://api.github.com/users/gyenesvi/repos",
            "events_url": "https://api.github.com/users/gyenesvi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/gyenesvi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-10T12:16:51Z",
        "updated_at": "2022-08-10T12:16:51Z",
        "author_association": "NONE",
        "body": "I am getting the same error on a model I got from a client, so cannot change it. However, I don't understand why this problem arises the way it does. First, why does the validity differ depending on the `keepdims` flag? If it can be computed with one setting, it can be reshaped to the other one, so that should not be a differentiating factor. Second, reducing on an array of 0 length should be well-defined if the operator has an identity value or the reduction is given an explicit initial value. The max of 0 elements can be defined as -inf, and numpy allows setting of the initial value. Numpy only fails if None is given to the initial value and the length is 0, and its behavior does not depend on the `keepdims` flag.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1210591772/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1211438175",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-1211438175",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 1211438175,
        "node_id": "IC_kwDOCVq1mM5INRRf",
        "user": {
            "login": "skottmckay",
            "id": 979079,
            "node_id": "MDQ6VXNlcjk3OTA3OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/979079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/skottmckay",
            "html_url": "https://github.com/skottmckay",
            "followers_url": "https://api.github.com/users/skottmckay/followers",
            "following_url": "https://api.github.com/users/skottmckay/following{/other_user}",
            "gists_url": "https://api.github.com/users/skottmckay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/skottmckay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/skottmckay/subscriptions",
            "organizations_url": "https://api.github.com/users/skottmckay/orgs",
            "repos_url": "https://api.github.com/users/skottmckay/repos",
            "events_url": "https://api.github.com/users/skottmckay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/skottmckay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-11T00:33:52Z",
        "updated_at": "2022-08-11T00:33:52Z",
        "author_association": "MEMBER",
        "body": "ORT behavior is not matching numpy currently as it's allowing a reduce on an axis with a value of 0 when keepdims=true. I don't know if that's intentional and there's a historical reason for that being the case, but the potential fix would be to also fail when keepdims=true.\r\n\r\ne.g. input shape {3, x, 4} with axis=1 should reduce to {3, 1, 4} with keepdims=true or {3, 4} if keepdims=false. If x == 0 the current implementation will reduce to {3, 0, 4} with keepdims=true or fail with keepdims=false.\r\n\r\nOne mild difference is that when keepdims=true we have the correct rank and can leave the dimensions that weren't reduced alone as we use 0 for the reduced axis instead of 1. When keepdims=false we need a 0 somewhere in the output shape, so the '3' and/or '4' would have to be changed to 0 if we didn't fail. \r\n\r\nIf we disallow a reduced axis from having a value of 0 that would also mean that a reduce operator with default behavior (reduce on all axes) would never support empty input. \r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1211438175/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218018473",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/7563#issuecomment-1218018473",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/7563",
        "id": 1218018473,
        "node_id": "IC_kwDOCVq1mM5ImXyp",
        "user": {
            "login": "gyenesvi",
            "id": 1384672,
            "node_id": "MDQ6VXNlcjEzODQ2NzI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1384672?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gyenesvi",
            "html_url": "https://github.com/gyenesvi",
            "followers_url": "https://api.github.com/users/gyenesvi/followers",
            "following_url": "https://api.github.com/users/gyenesvi/following{/other_user}",
            "gists_url": "https://api.github.com/users/gyenesvi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/gyenesvi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/gyenesvi/subscriptions",
            "organizations_url": "https://api.github.com/users/gyenesvi/orgs",
            "repos_url": "https://api.github.com/users/gyenesvi/repos",
            "events_url": "https://api.github.com/users/gyenesvi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/gyenesvi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-17T13:34:31Z",
        "updated_at": "2022-08-17T13:34:31Z",
        "author_association": "NONE",
        "body": "@skottmckay thanks for the response! I think I am starting to get it; ORT uses two different error mechanisms depending on the value of the attribute `keepdims`; making the output have size 0 essentially means that there is no result, right? I do think however that this is somewhat confusing and failing in both cases, like numpy, would be potentially more consistent. And yes, numpy fails on an empty array with default behavior of reducing all axes, but only if the operator does not have an identity element, such as `np.max`. On the other hand, `np.sum` does not fail on an empty array with default attributes. Does ORT work for summing an empty array, independent of `keepdims`?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1218018473/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]